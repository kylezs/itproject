(window["webpackJsonpartefacts-app"]=window["webpackJsonpartefacts-app"]||[]).push([[0],{112:function(e,t,a){e.exports=a(126)},117:function(e,t,a){},126:function(e,t,a){"use strict";a.r(t);var n=a(13),r=a(0),o=a.n(r),c=a(12),i=a.n(c);a(117),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(44),u=a(104),s=a(101),m=a(103),p=a(19),f=a(15),d=a.n(f),b=a(26),g=a(11),h=a(28),E=a(29),v=a.n(E),O=a(25),j=Object(r.createContext)({authenticated:!1,user:{},authToken:"",initiateLogin:function(){},handleAuthentication:function(){},logout:function(){}}),y=j,w=j.Provider,x=(j.Consumer,"auth-token"),C="duplicate key",k="Please, enter valid credentials";function S(){var e=Object(h.a)(["\nmutation VerifyToken($token: String!) {\n    verifyToken(token: $token) {\n        payload\n    }\n}\n"]);return S=function(){return e},e}var A=v()(S());var T=a(48),$=a(35),N=a(60),P=a(61),W=a(68),I=a(21),D=a(43),L=a(3),F=a(98),R=a(168),B=a(165),q=a(166),U=a(105),M=a(164),Q=a(99),z=a.n(Q),J=a(162),V=a(102),G=a(178),_=a(97),H=a.n(_),K=function(e){var t=o.a.useState(null),a=Object(g.a)(t,2),n=a[0],c=a[1],i=Object(r.useContext)(y),l=Boolean(n);function u(){c(null)}return o.a.createElement("div",null,o.a.createElement(J.a,{component:I.b,to:"/family/create",color:"inherit"},"Create Family"),o.a.createElement(J.a,{color:"inherit"},"Manage Artefacts"),o.a.createElement(M.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){c(e.currentTarget)},color:"inherit"},o.a.createElement(H.a,null)),o.a.createElement(V.a,{id:"menu-appbar",anchorEl:n,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:u},o.a.createElement(G.a,{onClick:u},"Profile"),o.a.createElement(G.a,{onClick:u},"Settings"),o.a.createElement(G.a,{onClick:function(){i.logout()}},"Logout")))},X=o.a.forwardRef(function(e,t){return o.a.createElement(I.b,Object.assign({innerRef:t,to:"/login"},e))}),Y=o.a.forwardRef(function(e,t){return o.a.createElement(I.b,Object.assign({innerRef:t,to:"/signup"},e))}),Z=function(e){return o.a.createElement("div",null,o.a.createElement(J.a,{color:"inherit",underline:"none",component:Y},"Sign up"),o.a.createElement(J.a,{color:"inherit",underline:"none",component:X},"Login"))},ee=a(167),te=Object(F.a)(function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}});function ae(){var e=te(),t=Object(r.useContext)(y).authenticated;return o.a.createElement("div",{className:e.root},o.a.createElement(B.a,{position:"static"},o.a.createElement(q.a,null,o.a.createElement(M.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu"},o.a.createElement(z.a,null)),o.a.createElement(U.a,{variant:"h6",className:e.title},o.a.createElement(ee.a,{component:I.b,to:"/",color:"inherit",variant:"inherit",underline:"none"},"Family AR")),t&&o.a.createElement(K,{username:null}),!t&&o.a.createElement(Z,null))))}var ne=function(e){return o.a.createElement("div",null,o.a.createElement(ae,null),o.a.createElement(R.a,{style:{padding:"20px"}},e.children))},re=a(169);var oe=function(){var e=Object(F.a)(function(e){return{progress:{margin:e.spacing(2)}}})();return o.a.createElement(ne,null,o.a.createElement(re.a,{className:e.progress}))},ce=function(e){function t(){var e,a;Object(T.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(N.a)(this,(e=Object(P.a)(t)).call.apply(e,[this].concat(r)))).state={checkAuthenticated:!1},a}return Object(W.a)(t,e),Object($.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("did I mount?"),this.context.authenticated&&this.setState({checkAuthenticated:!0});var t=localStorage.getItem(x);!this.context.authenticated&&t?this.context.handleAuthentication(t,function(){console.log("Setting state"),e.setState({checkAuthenticated:!0})}):this.setState({checkAuthenticated:!0})}},{key:"render",value:function(){return this.props.children(this.state.checkAuthenticated)}}]),t}(r.Component);ce.contextType=y;var ie=function(e){var t=e.component,a=Object(L.a)(e,["component"]);console.log("Begin private route");var n=Object(r.useContext)(y).authenticated;return o.a.createElement(ce,null,function(e){return!1===e?o.a.createElement(oe,null):o.a.createElement(D.b,Object.assign({},a,{render:function(e){return n?o.a.createElement(t,e):o.a.createElement(D.a,{to:"/login"})}}))})};var le=function(e){var t=Object(r.useContext)(y),a=t.authenticated,n=t.user.username;return o.a.createElement(ne,null,a&&o.a.createElement("p",null,"Hello user: ",n))};function ue(){var e=Object(h.a)(["\nmutation ArtefactCreate($artefactInput:ArtefactInputType!) {\n  artefactCreate(input: $artefactInput) {\n    artefact {\n      name,\n      description\n    }\n  }\n}"]);return ue=function(){return e},e}var se=v()(ue());function me(e){var t,a,n=Object(O.a)(se),r=Object(g.a)(n,2),c=r[0],i=r[1],l=(i.data,i.loading),u=i.errors;return l?o.a.createElement("div",null,"Loading..."):u?o.a.createElement("p",null,"ERROR!"):o.a.createElement("div",null,o.a.createElement("h1",null,"Create an Artefact"),o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),c({variables:{artefactInput:{name:t.value,description:a.value}}}),t.value="",a.value=""}},o.a.createElement("label",null,"Name"),o.a.createElement("input",{ref:function(e){t=e}}),o.a.createElement("br",null),o.a.createElement("label",null,"Description"),o.a.createElement("input",{ref:function(e){a=e}}),o.a.createElement("br",null),o.a.createElement("button",{type:"submit"},"Create")))}function pe(){var e=Object(h.a)(["\n    query DetailView($id: ID!) {\n        artefact(id: $id) {\n            id,\n            name,\n            description,\n            addedAt\n        }\n    }"]);return pe=function(){return e},e}var fe=v()(pe());function de(e){var t=Object(O.b)(fe,{variables:{id:e.match.params.id}}),a=t.data,n=t.loading,r=t.errors;return n?o.a.createElement("p",null,"Loading..."):r?o.a.createElement("p",null,"ERROR!"):o.a.createElement("div",null,o.a.createElement("h1",null,a.artefact.name," - #",a.artefact.id),o.a.createElement("p",null,a.artefact.addedAt),o.a.createElement("p",null,a.artefact.description))}var be=a(170),ge=a(175),he=a(172),Ee=a(171);function ve(){var e=Object(h.a)(["\nmutation TokenAuth($username: String!, $password: String!) {\n    tokenAuth(username: $username, password: $password) {\n        token\n    }\n}\n"]);return ve=function(){return e},e}var Oe=v()(ve()),je=Object(F.a)(function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"50%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}});var ye=function(e){var t=Object(r.useContext)(y),a=je(),n=Object(r.useState)(""),c=Object(g.a)(n,2),i=c[0],l=c[1],u=Object(r.useState)(""),s=Object(g.a)(u,2),m=s[0],p=s[1],f=Object(r.useState)(!1),h=Object(g.a)(f,2),E=h[0],v=h[1],j=function(){var a=Object(b.a)(d.a.mark(function a(n){var r;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r=n.tokenAuth.token,console.log("getting token first in confirm mutation"),t.handleAuthentication(r),localStorage.setItem(x,r),e.history.push("/");case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),w=function(){var e=Object(b.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("_handleError run"),t.graphQLErrors&&(a=t.graphQLErrors[0].message.substring(0,15),k.startsWith(a)?(v(!0),console.log("invalid credentials")):(console.log("unexpect error(s):"),console.log(t)));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),C=Object(O.a)(Oe,{onCompleted:j,onError:w}),S=Object(g.a)(C,2),A=S[0],T=(S[1].data,function(){var e=Object(b.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:A({variables:{username:i,password:m}}),t.preventDefault();case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());return o.a.createElement(ne,null,o.a.createElement(be.a,null),o.a.createElement("div",{className:a.paper},o.a.createElement("form",{className:a.form,onSubmit:T},o.a.createElement(Ee.a,{container:!0,spacing:2},o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(U.a,{component:"h1",variant:"h5"},"Log In")),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(ge.a,{variant:"outlined",required:!0,fullWidth:!0,id:"username",label:"Username",autoFocus:!0,onChange:function(e){return l(e.target.value)},error:E})),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(ge.a,{variant:"outlined",required:!0,fullWidth:!0,label:"Password",type:"password",id:"password",onChange:function(e){return p(e.target.value)},error:E}),E&&o.a.createElement(he.a,{id:"password",error:E},"Please enter valid credentials")),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(J.a,{name:"submit",label:"Submit",type:"submit",fullWidth:!0,variant:"contained",color:"primary"},"Log In")),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(Ee.a,{item:!0},o.a.createElement(ee.a,{component:I.b,to:"/signup"},"Need an account? Sign up")))))))};function we(){var e=Object(h.a)(["\nmutation SignupMutation($email: String!, $password: String!, $username: String!){\n    createUser(email: $email, username: $username, password: $password) {\n        user {\n            id\n            username\n            email\n        }\n    }\n}\n"]);return we=function(){return e},e}var xe=v()(we()),Ce=Object(F.a)(function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"50%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}});var ke=function(e){var t=Object(r.useState)(""),a=Object(g.a)(t,2),n=a[0],c=a[1],i=Object(r.useState)(""),l=Object(g.a)(i,2),u=l[0],s=l[1],m=Object(r.useState)(""),p=Object(g.a)(m,2),f=p[0],h=p[1],E=Object(r.useState)(""),v=Object(g.a)(E,2),j=v[0],y=v[1],w=Object(r.useState)(!1),x=Object(g.a)(w,2),k=x[0],S=x[1],A=Object(r.useState)(!1),T=Object(g.a)(A,2),$=T[0],N=(T[1],Ce()),P=function(){var t=Object(b.a)(d.a.mark(function t(a){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.history.push("/login");case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),W=function(){var e=Object(b.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("_handleError run"),t.graphQLErrors&&(a=t.graphQLErrors[0].message.substring(0,10),C.startsWith(a)?S(!0):console.log(t));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),D=Object(O.a)(xe,{onCompleted:P,onError:W}),L=Object(g.a)(D,2),F=L[0],R=(L[1].data,function(){var e=Object(b.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("form submitted"),F({variables:{username:n,email:u,password:f}}),t.preventDefault();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());return o.a.createElement(ne,null,o.a.createElement(be.a,null),o.a.createElement("div",{className:N.paper},o.a.createElement("form",{className:N.form,onSubmit:R},o.a.createElement(Ee.a,{container:!0,spacing:2},o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(U.a,{component:"h1",variant:"h5"},"Sign up")),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(ge.a,{autoComplete:"username",name:"username",variant:"outlined",required:!0,fullWidth:!0,id:"username",label:"Username",autoFocus:!0,error:k,onChange:function(e){return c(e.target.value)}}),k&&o.a.createElement(he.a,{id:"username",error:k},"Username is taken")),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(ge.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",type:"email",error:$,onChange:function(e){return s(e.target.value)}}),$&&o.a.createElement(he.a,{id:"email",error:$},"Email is taken")),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(ge.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(e){return h(e.target.value)}})),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(ge.a,{variant:"outlined",required:!0,fullWidth:!0,name:"confirmPassword",label:"Confirm Password",type:"password",id:"confirmPassword",autoComplete:"current-password",onChange:function(e){return y(e.target.value)},error:!(j===f)}),!(j===f)&&o.a.createElement(he.a,{id:"confirmPassword",error:!(j===f)},"Passwords must match")),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(J.a,{name:"submit",label:"Submit",type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:!(j===f)},"Sign Up")),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(Ee.a,{item:!0},o.a.createElement(ee.a,{component:I.b,to:"/login"},"Already have an account? Log in")))))))};var Se=function(){return Object(r.useContext)(y).logout(),o.a.createElement(D.a,{to:"/login"})},Ae=a(6),Te=a(177),$e=a(173),Ne=a(174),Pe=a(100),We=a.n(Pe);function Ie(){var e=Object(h.a)(["\nmutation FamilyCreate($familyName: String!, $about: String) {\n  familyCreate(input: {\n    familyName: $familyName\n    about:$about\n  })\n  {\n    family {\n      familyName\n      joinCode\n    }\n  }\n}\n"]);return Ie=function(){return e},e}var De=Object(F.a)(function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"50%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}),Le=v()(Ie()),Fe=Object(Ae.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose;return o.a.createElement($e.a,{disableTypography:!0,className:a.root},o.a.createElement(U.a,{variant:"h6"},t),n?o.a.createElement(M.a,{"aria-label":"close",className:a.closeButton,onClick:n},o.a.createElement(We.a,null)):null)}),Re=Object(Ae.a)(function(e){return{root:{padding:e.spacing(2)}}})(Ne.a);function Be(e){var t=De(),a=Object(r.useContext)(y).user.username,n=Object(r.useState)(""),c=Object(g.a)(n,2),i=c[0],l=c[1],u=Object(r.useState)(""),s=Object(g.a)(u,2),m=s[0],p=s[1],f=Object(r.useState)(""),h=Object(g.a)(f,2),E=h[0],v=h[1],j=Object(r.useState)(!1),w=Object(g.a)(j,2),x=w[0],C=w[1],k=function(){var e=Object(b.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),a=t.familyCreate.family.joinCode,v(a),C(!0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),S=Object(O.a)(Le,{onCompleted:k}),A=Object(g.a)(S,2),T=A[0],$=A[1].data,N=function(){var e=Object(b.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("Family name: "+i),console.log("About: "+m),T({variables:{familyName:i,about:m}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),P=function(e){e.preventDefault(),C(!1)};return o.a.createElement(ne,null,o.a.createElement("h1",null,"Create a Family"),o.a.createElement("p",null,"Families are how you manage your artefacts. We recognise there is often complex overlap between families. That's why you can create and be a part of several families, so you can separate which of the artefacts you manage belong to which family."),o.a.createElement(be.a,null),o.a.createElement("div",{className:t.paper},o.a.createElement("form",{className:t.form,onSubmit:N},o.a.createElement(Ee.a,{container:!0,spacing:2},o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(U.a,{component:"h1",variant:"h5"},"Create Family")),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(ge.a,{variant:"outlined",required:!0,fullWidth:!0,id:"family-name",label:"Family name",autoFocus:!0,onChange:function(e){return l(e.target.value)}})),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(ge.a,{variant:"outlined",multiline:!0,rows:6,fullWidth:!0,id:"about",label:"Tell people about your family",onChange:function(e){return p(e.target.value)}})),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(ge.a,{variant:"outlined",disabled:!0,defaultValue:a,fullWidth:!0,id:"family-admin",label:"Family Admin",onChange:function(e){return console.log("hello")}})),o.a.createElement(Ee.a,{item:!0,xs:12},o.a.createElement(J.a,{name:"create",label:"Create",type:"submit",fullWidth:!0,variant:"contained",color:"primary"},"Create")))),$&&o.a.createElement(Te.a,{open:x,onClose:P},o.a.createElement(Fe,{onClose:P},"Begin adding members to '",i,"'!"),o.a.createElement(Re,null,o.a.createElement(U.a,{align:"center"},"Begin getting members to join your family! Simply share the code below to your family members, get them to sign up and then they can join!",o.a.createElement("br",null),E)))))}var qe=function(e){function t(){return Object(T.a)(this,t),Object(N.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(W.a)(t,e),Object($.a)(t,[{key:"render",value:function(){return o.a.createElement(I.a,null,o.a.createElement("div",null,o.a.createElement(D.d,null,o.a.createElement(ie,{exact:!0,path:"/",component:le}),o.a.createElement(D.b,{exact:!0,path:"/login/",component:ye}),o.a.createElement(D.b,{exact:!0,path:"/signup/",component:ke}),o.a.createElement(D.b,{exact:!0,path:"/logout/",component:Se}),o.a.createElement(ie,{exact:!0,path:"/artefacts/create/",component:me}),o.a.createElement(ie,{exact:!0,path:"/artefacts/:id/",component:de}),o.a.createElement(ie,{exact:!0,path:"/family/create",component:Be}))))}}]),t}(r.Component);function Ue(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Me(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ue(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ue(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Qe=Object(u.a)({uri:"http://127.0.0.1:8000/graphql/"}),ze=Object(s.a)(function(e,t){var a=t.headers,n=localStorage.getItem(x);return{headers:Me({},a,{authorization:n?"JWT ".concat(n):""})}}),Je=new l.a({link:ze.concat(Qe),cache:new m.a});i.a.render(o.a.createElement(p.a,{client:Je},o.a.createElement(function(e){var t=this,a=Object(r.useState)(!1),n=Object(g.a)(a,2),c=n[0],i=n[1],l=Object(r.useState)({}),u=Object(g.a)(l,2),s=u[0],m=u[1],p=Object(r.useState)(""),f=Object(g.a)(p,2),h=f[0],E=f[1],v=Object(O.a)(A),j=Object(g.a)(v,2),y=j[0],C=j[1],k=C.error,S=C.loading,T=function(){var e=Object(b.a)(d.a.mark(function e(t,a){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(t=localStorage.getItem(x)),e.next=3,y({variables:{token:t}}).then(function(e){$(e),a&&a()}).catch(function(e){localStorage[x]="",a&&a()});case 3:if(!k){e.next=6;break}return console.log("[Error] handleAuthentication()"),e.abrupt("return");case 6:S&&console.log("Thing is loading");case 7:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),$=function(e){if(k)console.log("Invalid data, please sign in again");else{var t={username:e.data.verifyToken.payload.username};i(!0),E(e.verifyToken),m(t)}},N={authenticated:c,authToken:h,user:s,initiateLogin:function(){t.history.pushState(null,"login")},handleAuthentication:T,logout:function(){console.log("Logout called"),i(!1),m({}),E(""),localStorage[x]=""}};return o.a.createElement(w,{value:N},e.children)},null,o.a.createElement(qe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[112,1,2]]]);
//# sourceMappingURL=main.98fa18b6.chunk.js.map