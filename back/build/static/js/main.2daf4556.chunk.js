(window["webpackJsonpartefact-management-system"]=window["webpackJsonpartefact-management-system"]||[]).push([[0],{188:function(e,t,a){e.exports=a(292)},193:function(e,t,a){},210:function(e,t){},215:function(e,t){},216:function(e,t){},225:function(e,t,a){},292:function(e,t,a){"use strict";a.r(t);var n=a(10),r=a(0),o=a.n(r),i=a(14),c=a.n(i);a(193),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(58),s=a(167),u=a(163),m=a(166),p=a(32),d=a(12),f=a.n(d),g=a(18),b=a(8),h=a(23),y=a(24),E=a.n(y),v=a(17),O=Object(r.createContext)({authenticated:!1,user:{},initiateLogin:function(){},handleAuthentication:function(){},logout:function(){}}),j=O,w=O.Provider,k=(O.Consumer,"auth-token"),S="duplicate key",x="Please, enter valid credentials",C="pk.eyJ1IjoiemR1ZmZpZWxkIiwiYSI6ImNrMWdkODhpOTBiM28zZG03eDdjZ2dmN24ifQ.vAzlFYY5S9O82SKnwX69kQ",P={uri:"/graphql/",mediaRoot:"https://artefact-picture.s3.amazonaws.com/media/"};function F(){var e=Object(h.a)(["\nmutation VerifyToken($token: String!) {\n    verifyToken(token: $token) {\n        payload\n    }\n}\n"]);return F=function(){return e},e}var T=E()(F());var N=a(16),D=a(57),A=a(3),I=a(89),W=a(55),$=a(145),B=a(146),R=a(168),z=a(353),L=a(147),q=a(345),M=a(346),H=a(296),_=a(51),Q=a(347),U=a(333),J=a(348),V=a(349),Y=a(376),G=a(332),Z=a(295),K=a(338),X=a(339),ee=a(169),te=a(343),ae=a(334),ne=a(335),re=a(336),oe=a(337),ie=a(340),ce=a(341),le=Object(L.a)(function(e){return{drawer:{width:"auto",marginTop:e.spacing(5)}}}),se=function(){return o.a.createElement("span",{style:{position:"absolute",marginTop:"15px",marginLeft:"2px",padding:"1px",fontSize:"10px",color:"white",backgroundColor:"#00BCD4",borderRadius:"4px",zIndex:2}},"Coming Soon")},ue=function(e){var t=e.drawerOpen,a=e.setDrawerOpen,n=e.setHelpOpen,i=le(),c=o.a.useState(null),l=Object(b.a)(c,2),s=l[0],u=l[1],m=Object(r.useContext)(j),p=Boolean(s);function d(){u(null)}return o.a.createElement("div",null,o.a.createElement(Y.a,{anchor:"left",open:t,onClose:function(e){return a(!1)}},o.a.createElement("div",{className:i.drawer,role:"presentation",onClick:function(e){return a(!1)},onKeyDown:function(e){return a(!1)}},o.a.createElement(G.a,null,[{name:"Home",path:"/",icon:U.a},{name:"Create Family",path:"/family/create/",icon:ae.a},{name:"Manage Artefacts",path:"/artefacts/manage/",icon:ne.a},{name:"Create Artefact",path:"/artefacts/create/",icon:re.a},{name:"Artefact Map",path:"/map/",icon:oe.a}].map(function(e){var t=e.name,a=e.path,n=e.icon;return o.a.createElement(Z.a,{button:!0,key:a,component:N.b,to:a,style:{borderRadius:10}},o.a.createElement(K.a,null,o.a.createElement(n,null)),o.a.createElement(X.a,{primary:t}))})))),o.a.createElement(H.a,{edge:"start",color:"inherit","aria-label":"menu",onClick:function(){return n(!0)}},o.a.createElement(ie.a,null)),o.a.createElement(H.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){u(e.currentTarget)},color:"inherit"},o.a.createElement(ce.a,null)),o.a.createElement(ee.a,{id:"menu-appbar",anchorEl:s,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:p,onClose:d},o.a.createElement(te.a,{onClick:d,disabled:!0},"Profile",o.a.createElement(se,null)),o.a.createElement(te.a,{onClick:d,disabled:!0},"Settings",o.a.createElement(se,null)),o.a.createElement(te.a,{onClick:function(){m.logout()}},"Logout")))},me=a(344),pe=o.a.forwardRef(function(e,t){return o.a.createElement(N.b,Object.assign({innerRef:t,to:"/login"},e))}),de=o.a.forwardRef(function(e,t){return o.a.createElement(N.b,Object.assign({innerRef:t,to:"/signup"},e))}),fe=function(e){return o.a.createElement("div",null,o.a.createElement(me.a,{color:"inherit",underline:"none",component:de},"Sign up"),o.a.createElement(me.a,{color:"inherit",underline:"none",component:pe},"Login"))},ge=a(171),be=Object(L.a)(function(e){return{root:{flexGrow:1},iconButton:{marginRight:e.spacing(1)},title:{flexGrow:1,alignText:"left"}}});function he(e){var t=be(),a=Object(r.useContext)(j).authenticated,n=Object(ge.a)(),i=n&&"dark"===n.palette.type,c=Object(r.useState)(!1),l=Object(b.a)(c,2),s=l[0],u=l[1];return o.a.createElement("div",{className:t.root},o.a.createElement(q.a,{position:"static",color:"primary",elevation:6},o.a.createElement(M.a,null,o.a.createElement(H.a,{className:t.iconButton,edge:"start",color:"inherit","aria-label":"menu",onClick:function(e){return u(!0)}},o.a.createElement(Q.a,null)),o.a.createElement(H.a,{className:t.iconButton,color:"inherit","aria-label":"home",component:N.b,to:"/"},o.a.createElement(U.a,null)),o.a.createElement(_.a,{variant:"h6",className:t.title,noWrap:!0},"AMS"),o.a.createElement(H.a,{className:t.iconButton,color:"inherit","aria-label":"theme-toggle",onClick:e.onToggleDarkTheme},i?o.a.createElement(V.a,null):o.a.createElement(J.a,null)),a?o.a.createElement(ue,{username:null,drawerOpen:s,setDrawerOpen:u,setHelpOpen:e.setHelpOpen}):o.a.createElement(fe,null))))}var ye=a(165),Ee=a(375),ve=a(352),Oe=a(98),je=a(350),we=a(351),ke={fontFamily:"Dosis, Roboto, sans-serif",h1:{fontFamily:"Roboto, sans-serif",fontWeight:100},h2:{fontFamily:"Roboto, sans-serif",fontWeight:100},h3:{fontFamily:"Roboto, sans-serif"},h4:{fontFamily:"Roboto, sans-serif"},h5:{fontFamily:"Roboto, sans-serif"},h6:{fontFamily:"Roboto, sans-serif"}},Se={primary:Oe.a,secondary:{main:je.a[400]},type:"light"},xe={primary:{main:we.a.A100},secondary:je.a,error:{main:"#CF6679"},background:{paper:"#303030",default:"#121212"},type:"dark"},Ce=Object(ye.a)({palette:Se,type:"light",typography:ke});Ce=Object(Ee.a)(Ce);var Pe=Object(ye.a)({palette:xe,type:"dark",typography:ke});Pe=Object(Ee.a)(Pe);var Fe=function(e){localStorage.getItem("theme-type")||localStorage.setItem("theme-type","light");var t=Object(r.useState)("light"===localStorage.getItem("theme-type")?Ce:Pe),a=Object(b.a)(t,2),n=a[0],i=a[1],c=Object(r.useState)(!1),l=Object(b.a)(c,2),s=l[0],u=l[1],m=o.a.Children.map(e.children,function(e){return o.a.cloneElement(e,{helpOpen:s,setHelpOpen:u})});return o.a.createElement(ve.a,{theme:n},o.a.createElement(z.a,null),o.a.createElement(he,{onToggleDarkTheme:function(){var e="light"===n.palette.type?"dark":"light";localStorage.setItem("theme-type",e),i("light"===e?Ce:Pe)},setHelpOpen:u}),m)},Te=a(354),Ne=a(120),De=function(){return o.a.createElement(Te.a,{container:!0,alignItems:"center",justify:"center",style:{height:"90vh"}},o.a.createElement(Ne.a,null))},Ae=a(355),Ie=a(358),We=a(357),$e=a(356),Be=a(200),Re=Object(L.a)(function(e){return{textField:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center",marginTop:e.spacing(1)},paper:{marginTop:e.spacing(1),padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center"},button:{margin:e.spacing(1)},card:{backgroundColor:e.palette.background.paper,borderRadius:10},media:{backgroundColor:e.palette.background.paper,height:170}}});var ze=function(e){var t=e.artefact,a=Re(),n=Object(ge.a)(),i=t.upload,c=t.name,l=t.description,s=t.id,u=t.admin,m=Object(r.useState)(""),p=Object(b.a)(m,2),d=p[0],f=p[1],g=P.mediaRoot+i;return"False"!==i||d||f(Be({width:500,height:500,x_colors:[n.palette.primary.dark,n.palette.secondary.light],y_colors:"random"}).png()),o.a.createElement(Ae.a,{className:a.card,elevation:3},o.a.createElement($e.a,{className:a.media,image:d||g,title:c}),o.a.createElement(We.a,null,o.a.createElement(Te.a,{container:!0},o.a.createElement(Te.a,{item:!0,xs:9},o.a.createElement(_.a,{gutterBottom:!0,variant:"h5",component:"h2",noWrap:!0},c)),o.a.createElement(Te.a,{item:!0,xs:3},o.a.createElement(_.a,{gutterBottom:!0,variant:"overline",component:"h2",noWrap:!0,align:"right"},u.username)),o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(_.a,{variant:"body2",color:"textSecondary",component:"p",noWrap:!0},l)))),o.a.createElement(Ie.a,null,o.a.createElement(me.a,{size:"small",fullWidth:!0,color:"primary",component:N.b,to:"/artefacts/".concat(s)},"View")))},Le=a(81);a(225);function qe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Me(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?qe(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qe(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var He=Object(L.a)(function(e){return{popup:{zIndex:"50 !important",minWidth:"300px"}}}),_e={accessToken:C,attributionControl:!1,maxZoom:18,minZoom:2},Qe=Object(Le.c)(Me({},_e,{interactive:!1})),Ue=Object(Le.c)(Me({},_e,{interactive:!0}));function Je(e){var t=He(),a=e.interactive?Ue:Qe,n=e.artefacts;n||(n=[]);var i=Object(r.useState)(""),c=Object(b.a)(i,2),l=c[0],s=c[1],u=function(e){s(l===e?"":e)};return o.a.createElement(a,Object.assign({style:e.mapStyle?e.mapStyle:"mapbox://styles/mapbox/streets-v9?optimize=true",containerStyle:e.containerStyle},e.mapState,{onClick:function(){u(""),e.onClick&&e.onClick()}}),n.map(function(e){var a=e.center,n=e.popup,i=e.initPopupOpen,c=e.id;return i&&(e.initPopupOpen=!1,s(c)),a&&a.length?o.a.createElement(r.Fragment,{key:c},o.a.createElement(Le.a,{coordinates:a,onClick:function(e){return u(c)}},o.a.createElement("img",{src:"http://maps.google.com/mapfiles/ms/icons/red.png",alt:"marker-img"})),n&&l===c&&o.a.createElement(Le.b,{coordinates:a,offset:{"bottom-left":[12,-38],bottom:[0,-38],"bottom-right":[-12,-38]},className:t.popup},o.a.createElement(ze,{artefact:e}))):null}))}var Ve=a(226)({accessToken:C}),Ye=function(e){var t={},a=e.body.features;if(!a)return t.noResults=!0,t;for(var n=[],r=0;r<a.length;r++){var o=a[r],i={};if(i.mapState={center:o.center},"place"===o.place_type[0]){var c=o.bbox;if(c){var l=[[c[0],c[1]],[c[2],c[3]]];i.mapState.fitBounds=l}}else"address"===o.place_type[0]&&(i.mapState.zoom=[15]);i.placeName=o.place_name,i.locationType=o.place_type[0],n.push(i)}return t.results=n,t},Ge=function(e){var t={};return console.log("query error occurred"),t.error=e,t};function Ze(e,t){if(!e)return new Promise(function(e,t){e()});var a={query:e,limit:5};return t&&(a.types=t),"object"===typeof e?Ve.reverseGeocode(a).send().then(function(e){return Ye(e)},function(e){return Ge(e)}):"string"===typeof e?Ve.forwardGeocode(a).send().then(function(e){return Ye(e)},function(e){return Ge(e)}):void 0}function Ke(e){return Ze(e.address).then(function(t){return{artefact:e,response:t}})}function Xe(){var e=Object(h.a)(["\n    mutation ArtefactDelete($id: ID!) {\n        artefactDelete(id: $id) {\n            ok\n        }\n    }\n"]);return Xe=function(){return e},e}function et(){var e=Object(h.a)(["\n    mutation FamilyCreate($familyName: String!, $about: String) {\n        familyCreate(input: { familyName: $familyName, about: $about }) {\n            family {\n                familyName\n                joinCode\n            }\n        }\n    }\n"]);return et=function(){return e},e}function tt(){var e=Object(h.a)(["\n    mutation SignupMutation(\n        $email: String!\n        $password: String!\n        $username: String!\n    ) {\n        createUser(email: $email, username: $username, password: $password) {\n            user {\n                id\n                username\n                email\n            }\n        }\n    }\n"]);return tt=function(){return e},e}function at(){var e=Object(h.a)(["\n    query getFamilyArtefacts($id: ID!) {\n        family(id: $id) {\n            hasArtefacts {\n                edges {\n                    node {\n                        id\n                        name\n                        description\n                        address\n                        upload\n                        admin {\n                            username\n                        }\n                    }\n                }\n            }\n        }\n    }\n"]);return at=function(){return e},e}function nt(){var e=Object(h.a)(["\n    mutation TokenAuth($username: String!, $password: String!) {\n        tokenAuth(username: $username, password: $password) {\n            token\n        }\n    }\n"]);return nt=function(){return e},e}function rt(){var e=Object(h.a)(["\n    mutation UpdateArtefactMutation(\n        $id: ID!\n        $artefactInput: ArtefactInputType!\n    ) {\n        artefactUpdate(id: $id, input: $artefactInput) {\n            artefact {\n                id\n            }\n        }\n    }\n"]);return rt=function(){return e},e}function ot(){var e=Object(h.a)(["\n    query DetailView($id: ID!) {\n        artefact(id: $id) {\n            id\n            name\n            description\n            admin {\n                id\n                username\n            }\n            state\n            isPublic\n            upload\n            belongsToFamilies {\n                id\n            }\n            addedAt\n            address\n            date\n        }\n    }\n"]);return ot=function(){return e},e}function it(){var e=Object(h.a)(["\n    query artefactsQuery {\n        me {\n            id\n        }\n    }\n"]);return it=function(){return e},e}function ct(){var e=Object(h.a)(["\n    query artefactsQuery {\n        me {\n            isMemberOf {\n                familyName\n                id\n            }\n        }\n    }\n"]);return ct=function(){return e},e}function lt(){var e=Object(h.a)(["\n    query ArtefactStatesQuery($name: String!) {\n        __type(name: $name) {\n            enumValues {\n                name\n                description\n            }\n        }\n    }\n"]);return lt=function(){return e},e}function st(){var e=Object(h.a)(["\n    mutation CreateArtefactMutation(\n        $name: String!\n        $state: String!\n        $isPublic: Boolean\n        $description: String!\n        $belongsToFamilies: [ID]\n        $address: String\n        $date: String\n    ) {\n        artefactCreate(\n            input: {\n                name: $name\n                state: $state\n                description: $description\n                isPublic: $isPublic\n                belongsToFamilies: $belongsToFamilies\n                address: $address\n                date: $date\n            }\n        ) {\n            artefact {\n                id\n            }\n        }\n    }\n"]);return st=function(){return e},e}E()(st());var ut="\nmutation CreateArtefactMutation(\n        $name: String!\n        $state: String!\n        $isPublic: Boolean\n        $description: String!\n        $belongsToFamilies: [ID]\n        $address: String\n        $date: String\n    ) {\n        artefactCreate(\n            input: {\n                name: $name\n                state: $state\n                description: $description\n                isPublic: $isPublic\n                belongsToFamilies: $belongsToFamilies\n                address: $address\n                date: $date\n            }\n        ) {\n            artefact {\n                id\n            }\n        }\n    }\n",mt=E()(lt()),pt=E()(ct()),dt=(E()(it()),E()(ot())),ft=E()(rt()),gt=E()(nt()),bt=E()(at()),ht=E()(tt()),yt=E()(et()),Et=E()(Xe());function vt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Ot(e){var t=e.child,a=e.childProps,i=Object(A.a)(e,["child","childProps"]),c=Object(r.useState)([]),l=Object(b.a)(c,2),s=l[0],u=l[1],m=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?vt(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):vt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a,{families:s,familiesLoading:Object(v.b)(pt,{onCompleted:function(e){return u(e.me.isMemberOf)},onError:function(e){return console.log(e)}}).loading});return o.a.createElement(t,Object.assign({},i,m))}function jt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function wt(e){var t=e.child,a=e.childProps,i=Object(A.a)(e,["child","childProps"]),c=Object(r.useState)({}),l=Object(b.a)(c,2),s=l[0],u=l[1],m=function(){var e=Object(g.a)(f.a.mark(function e(t){var a,n,r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in a={},t.__type.enumValues)r=t.__type.enumValues[o],n=r.description,a[n]=r.name;u(a);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),p=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?jt(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a,{artefactStates:s,statesLoading:Object(v.b)(mt,{variables:{name:"ArtefactState"},onCompleted:m,onError:function(e){return console.log(e)}}).loading});return o.a.createElement(t,Object.assign({},i,p))}function kt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function St(e){var t=e.child,a=e.childProps,r=Object(A.a)(e,["child","childProps"]),i=Object(v.b)(dt,{onError:function(e){return console.error("Error fetching artefact: ",e)},variables:{id:r.match.params.id}}),c=i.loading,l=i.error,s=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?kt(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):kt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a,{artefactData:i.data,artefactLoading:c,fetchError:l});return o.a.createElement(t,Object.assign({},r,s))}var xt=Object(L.a)(function(e){return{root:{width:"100%",height:"100%",backgroundColor:e.palette.background.paper,justifyContent:"center"},formControl:{height:"100%",justifyContent:"flex-start",textAlign:"left"},fieldTitle:{textAlign:"left",marginLeft:e.spacing(1)},paper:{padding:e.spacing(1),backgroundColor:e.palette.background.paper},paperWrapper:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,width:"100%",borderRadius:10},button:{height:"100%"},editLinkButton:{width:"60px",height:"30px",margin:e.spacing(1)},deleteButton:{width:"60px",height:"30px",margin:e.spacing(1),backgroundColor:e.palette.error.main},map:{height:"200px",type:e.palette.type},form:{marginBottom:e.spacing(10),marginTop:e.spacing(2),display:"flex",flexWrap:"wrap",textAlign:"center"},iconButton:{padding:10},dropzone:{backgroundColor:e.palette.background.paper+"!important",height:"100%",borderRadius:10,alignItems:"flex-start !important"},dropzoneText:{fontSize:"medium !important"},outerContainer:{spacing:e.spacing(1),alignItems:"stretch",alignContent:"stretch",justifyContent:"center"},switch:{justifyContent:"center",textAlign:"center"}}}),Ct=a(359),Pt=a(360),Ft=function(e){var t=e.open,a=e.setOpen,n=e.content,r=Object(A.a)(e,["open","setOpen","content"]);return o.a.createElement(Ct.a,{fullWidth:!0,maxWidth:"sm",open:t,onClose:function(){return a(!1)},"aria-labelledby":"help-title"},o.a.createElement(n,r),o.a.createElement(Pt.a,null,o.a.createElement(me.a,{onClick:function(){return a(!1)},color:"primary"},"Close")))},Tt=a(151),Nt=a.n(Tt),Dt=a(80),At=a.n(Dt);function It(e){var t=e.linkTo;return o.a.createElement(me.a,{style:{color:"#f0f0f0",padding:"12px",margin:"4px",marginTop:"8px"},component:N.b,to:t},e.children)}var Wt=function(e){var t=Object(ye.a)();t=Object(Ee.a)(t);var a=Object(r.useState)(!0),n=Object(b.a)(a,2),i=n[0],c=n[1];return Object(r.useEffect)(function(){c(!0)},[i]),o.a.createElement("div",null,o.a.createElement(ve.a,{theme:t},o.a.createElement("link",{href:"https://fonts.googleapis.com/css?family=Dosis&display=swap",rel:"stylesheet"}),o.a.createElement("div",{style:{position:"absolute",top:0,right:"20px",zIndex:4}},o.a.createElement(It,{linkTo:"/signup"},"Sign up"),o.a.createElement(It,{linkTo:"/login"},"Login")),o.a.createElement(_.a,{theme:t,variant:"h1",style:{marginLeft:"8%",marginRight:"8%",marginTop:"10%",zIndex:3,position:"relative",fontWeight:"lighter",fontFamily:"Dosis",color:"#f0f0f0"}},"Artefact Management System"),o.a.createElement(_.a,{variant:"h2",theme:t,style:{marginLeft:"8%",marginRight:"8%",marginTop:"1%",zIndex:3,position:"relative",top:"8rem",fontWeight:"lighter",fontFamily:"Dosis",color:"#f0f0f0"}},i?o.a.createElement(At.a,{cursor:{show:!1},onTypingDone:function(){c(!1)}},o.a.createElement(At.a.Delay,{ms:400}),o.a.createElement("span",null,"Connecting you to your family"),o.a.createElement("span",null," and your familys history."),o.a.createElement(At.a.Backspace,{count:10,delay:200}),o.a.createElement("span",null,"'s history."),o.a.createElement(At.a.Backspace,{count:56,delay:5e3})):""),o.a.createElement(Nt.a,{style:{position:"fixed",left:0,top:0,background:"linear-gradient(90deg, rgba(103, 58, 183, 1) 25%, rgba(63, 81, 181, 1) 100%, rgba(255, 255, 255, 1) 100%)"},params:{particles:{number:{value:120,density:{enable:!0,value_area:800}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#FFFFFF"},polygon:{nb_sides:5},image:{src:"img/github.svg",width:100,height:100}},opacity:{value:.44093831673801875,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:4.008530152163807,random:!0,anim:{enable:!1,speed:40,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.4,width:1},move:{enable:!0,speed:6,direction:"none",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!0,mode:"grab"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{grab:{distance:400,line_linked:{opacity:1}},bubble:{distance:400,size:40,duration:2,opacity:8,speed:3},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!0}})))},$t=function(e){function t(){var e,a;Object(I.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object($.a)(this,(e=Object(B.a)(t)).call.apply(e,[this].concat(r)))).state={checkAuthenticated:!1},a}return Object(R.a)(t,e),Object(W.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.context.authenticated&&this.setState({checkAuthenticated:!0});var t=localStorage.getItem(k);!this.context.authenticated&&t?this.context.handleAuthentication(t,function(){e.setState({checkAuthenticated:!0})}):this.setState({checkAuthenticated:!0})}},{key:"render",value:function(){return this.props.children(this.state.checkAuthenticated)}}]),t}(r.Component);$t.contextType=j;var Bt=function(e){var t=e.loggedIn,a=e.loggedOut,n=(e.path,e.landingPage),i=Object(A.a)(e,["loggedIn","loggedOut","path","landingPage"]),c=Object(r.useContext)(j).authenticated;return a||(a="/login"),console.log("Authenticated: ",c),o.a.createElement($t,null,function(e){return!1===e?o.a.createElement(De,null):o.a.createElement(D.b,Object.assign({},i,{render:function(e){return c?o.a.createElement(t,Object.assign({},e,i)):!c&&n?o.a.createElement(Wt,null):o.a.createElement(D.a,{to:a})}}))})},Rt=function(e){return o.a.createElement(Fe,null,o.a.createElement(Bt,e))},zt=a(82),Lt=a(373),qt=a(362),Mt=a(363),Ht=Object(L.a)(function(e){return{root:{marginLeft:e.spacing(1),marginRight:e.spacing(1),margin:e.spacing(1),borderRadius:10},paper:{padding:e.spacing(2),backgroundColor:e.palette.background.paper,alignItems:"center",alignContent:"stretch",justify:"center",borderRadius:10},form:{display:"flex",flexWrap:"wrap"},submit:{margin:e.spacing(3,0,2)}}});function _t(e){var t=e.history,a=Object(r.useContext)(j),n=Ht(),i=Object(r.useState)(""),c=Object(b.a)(i,2),l=c[0],s=c[1],u=Object(r.useState)(""),m=Object(b.a)(u,2),p=m[0],d=m[1],h=Object(r.useState)(!1),y=Object(b.a)(h,2),E=y[0],O=y[1],w=Object(r.useState)(!1),S=Object(b.a)(w,2),C=S[0],P=S[1],F=function(){var e=Object(g.a)(f.a.mark(function e(n){var r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.tokenAuth.token,a.handleAuthentication(r),localStorage.setItem(k,r),t.push("/");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("_handleError run"),t.graphQLErrors&&(a=t.graphQLErrors[0].message.substring(0,15),x.startsWith(a)?(O(!0),console.log("invalid credentials")):(console.log("unexpect error(s):"),console.log(t),P(!0)));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),D=Object(v.a)(gt,{onCompleted:F,onError:T}),A=Object(b.a)(D,1)[0],I=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:A({variables:{username:l,password:p}}),t.preventDefault();case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return o.a.createElement(zt.a,{className:n.paper,elevation:6},o.a.createElement("form",{onSubmit:I,className:n.form},o.a.createElement(_.a,{component:"h1",variant:"h5",className:n.root},"Log In"),o.a.createElement(Lt.a,{className:n.root,variant:"outlined",required:!0,fullWidth:!0,id:"username",label:"Username",autoFocus:!0,onChange:function(e){return s(e.target.value)},error:E}),o.a.createElement(Lt.a,{className:n.root,variant:"outlined",required:!0,fullWidth:!0,label:"Password",type:"password",id:"password",onChange:function(e){return d(e.target.value)},error:E,helperText:E?"Please enter valid credentials":""}),o.a.createElement(Te.a,{container:!0,justify:"center",alignItems:"center",spacing:3},o.a.createElement(Te.a,{item:!0,xs:6},o.a.createElement(me.a,{className:n.root,name:"submit",label:"Submit",type:"submit",variant:"contained",color:"primary",fullWidth:!0},"Log In"),C&&o.a.createElement(qt.a,{error:C,className:n.root},"Unknown Error Occurred")),o.a.createElement(Te.a,{item:!0,xs:6},o.a.createElement(Mt.a,{component:N.b,to:"/signup",className:n.root,color:"secondary"},"Need an account? Sign up")))))}var Qt=function(e){return o.a.createElement(Te.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(Te.a,{item:!0,xs:10,sm:8,md:6,lg:4},o.a.createElement(_t,e)))},Ut=function(e){return o.a.createElement(Fe,null,o.a.createElement(Qt,e))},Jt=new(a(244));Jt.is().min(6).is().max(100).has().uppercase().has().digits().is().not().oneOf(["password","Password123"]);var Vt=function(e){for(var t="",a=0;a<e.length;a++){a>=1&&(t+=" | ");var n=e[a];"min"===n&&(t+="Password must be at least ".concat(6," characters long")),"max"===n&&(t+="Password must be at most ".concat(100," characters long")),"uppercase"===n&&(t+="Password must have an uppercase letter"),"digits"===n&&(t+="Password must have a digit"),"oneOf"===n&&(t+="Password is too common")}return t},Yt=Object(L.a)(function(e){return{root:{marginLeft:e.spacing(1),marginRight:e.spacing(1),margin:e.spacing(1),borderRadius:10},paper:{padding:e.spacing(2),backgroundColor:e.palette.background.paper,alignItems:"center",alignContent:"stretch",justify:"center",borderRadius:10},form:{display:"flex",flexWrap:"wrap"},submit:{margin:e.spacing(3,0,2)}}});function Gt(e){var t=Object(r.useState)(""),n=Object(b.a)(t,2),i=n[0],c=n[1],l=Object(r.useState)(""),s=Object(b.a)(l,2),u=s[0],m=s[1],p=Object(r.useState)(""),d=Object(b.a)(p,2),h=d[0],y=d[1],E=Object(r.useState)(""),O=Object(b.a)(E,2),j=O[0],w=O[1],k=Object(r.useState)(!1),x=Object(b.a)(k,2),C=x[0],P=x[1],F=Object(r.useState)(!1),T=Object(b.a)(F,2),D=T[0],A=(T[1],Object(r.useState)(!1)),I=Object(b.a)(A,2),W=I[0],$=I[1],B=Object(r.useState)([]),R=Object(b.a)(B,2),z=R[0],L=R[1],q=Object(r.useState)(!1),M=Object(b.a)(q,2),H=M[0],Q=M[1],U=a(248),J=Yt(),V=function(){var t=Object(g.a)(f.a.mark(function t(a){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.history.push("/login");case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),Y=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("_handleError run"),t.graphQLErrors&&(a=t.graphQLErrors[0].message.substring(0,10),S.startsWith(a)?P(!0):(console.log("unexpect error(s):"),console.log(t),Q(!0)));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),G=Object(v.a)(ht,{onCompleted:V,onError:Y}),Z=Object(b.a)(G,1)[0],K=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("form submitted"),Z({variables:{username:i,email:u,password:h}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:y(t),a=Jt.validate(t,{list:!0}),L(a),0!==a.length?$(!1):$(!0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ee=!!h&&!W,te=!!j&&!(j===h),ae=!!h&&(!(j===h)||!W)||!!u&&!U.validate(u),ne=!!u&&!U.validate(u),re=D||ne,oe="";return ne?oe="Email is invalid":D&&(oe="Email is taken"),o.a.createElement(zt.a,{className:J.paper,elevation:6},o.a.createElement("form",{className:J.form,onSubmit:K},o.a.createElement(_.a,{component:"h1",variant:"h5",className:J.root},"Sign up"),o.a.createElement(Lt.a,{className:J.root,onChange:function(e){return c(e.target.value)},variant:"outlined",required:!0,fullWidth:!0,autoComplete:"username",label:"Username",type:"username",autoFocus:!0,error:C,helperText:C?"Username is taken":""}),o.a.createElement(Lt.a,{className:J.root,variant:"outlined",required:!0,fullWidth:!0,autoComplete:"email",label:"Email",type:"email",onChange:function(e){return m(e.target.value)},error:re,helperText:oe}),o.a.createElement(Lt.a,{className:J.root,variant:"outlined",required:!0,fullWidth:!0,autoComplete:"password",label:"Password",type:"password",onChange:function(e){return X(e.target.value)},error:ee,helperText:ee?Vt(z):""}),o.a.createElement(Lt.a,{className:J.root,variant:"outlined",required:!0,fullWidth:!0,label:"Confirm Password",type:"password",onChange:function(e){return w(e.target.value)},error:te,helperText:te?"Passwords must match":""}),o.a.createElement(Te.a,{container:!0,justify:"center",alignItems:"center",spacing:3},o.a.createElement(Te.a,{item:!0,xs:6},o.a.createElement(me.a,{className:J.root,fullWidth:!0,label:"Submit",type:"submit",variant:"contained",color:"primary",disabled:ae},"Sign Up"),H&&o.a.createElement(qt.a,{error:H})),o.a.createElement(Te.a,{item:!0,xs:6},o.a.createElement(Mt.a,{className:J.root,component:N.b,to:"/login",color:"secondary"},"Already have an account? Log in")))))}var Zt=function(e){return o.a.createElement(Te.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(Te.a,{item:!0,xs:10,sm:8,md:6,lg:4},o.a.createElement(Gt,e)))},Kt=function(e){return o.a.createElement(Fe,null,o.a.createElement(Zt,e))};var Xt=function(){return Object(r.useContext)(j).logout(),o.a.createElement(D.a,{to:"/login"})},ea=a(364),ta=a(365),aa=a(366),na=a(361),ra=a(367),oa=a(69),ia=function(){return o.a.createElement(r.Fragment,null,o.a.createElement(ea.a,{id:"help-title"},"Help"),o.a.createElement(ta.a,null,o.a.createElement(aa.a,null,'Create a family by filling out the form and clicking "create"'),o.a.createElement(aa.a,null,"On creation you will receive a join code which will allow others to join your new family")))};function ca(e){var t=xt(),a=Object(r.useContext)(j).user.username,n=Object(r.useState)(""),i=Object(b.a)(n,2),c=i[0],l=i[1],s=Object(r.useState)(""),u=Object(b.a)(s,2),m=u[0],p=u[1],d=Object(r.useState)(""),h=Object(b.a)(d,2),y=h[0],E=h[1],O=Object(r.useState)(!1),w=Object(b.a)(O,2),k=w[0],S=w[1],x=Object(r.useState)(!1),C=Object(b.a)(x,2),P=C[0],F=C[1],T=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.familyCreate.family.joinCode,E(a),S(!0);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),N=Object(v.a)(yt,{onCompleted:T}),D=Object(b.a)(N,2),A=D[0],I=(D[1].data,function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),A({variables:{familyName:c,about:m}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),W=function(t){t.preventDefault(),S(!1),e.history.push("/")};return o.a.createElement("form",{className:t.form,onSubmit:I},o.a.createElement(Te.a,{container:!0,spacing:1,className:t.outerContainer},o.a.createElement(Te.a,{item:!0,xs:12,container:!0,justify:"center"},o.a.createElement(_.a,{variant:"h4"},"Create Family"),o.a.createElement(_.a,{variant:"subtitle1"},"Families are how you manage your artefacts. We recognise there is often complex overlap between families. That's why you can create and be a part of several families, so you can separate which of the artefacts you manage belong to which family.")),o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(zt.a,{className:t.paperWrapper,elevation:3},o.a.createElement(na.a,{className:t.formControl,fullWidth:!0},o.a.createElement(Lt.a,{variant:"outlined",required:!0,fullWidth:!0,id:"family-name",label:"Family name",autoFocus:!0,onChange:function(e){return l(e.target.value)}})))),o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(zt.a,{className:t.paperWrapper,elevation:3},o.a.createElement(na.a,{className:t.formControl,fullWidth:!0},o.a.createElement(Lt.a,{variant:"outlined",multiline:!0,rows:6,fullWidth:!0,id:"about",label:"Tell people about your family",onChange:function(e){return p(e.target.value)}})))),o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(zt.a,{className:t.paperWrapper,elevation:3},o.a.createElement(na.a,{className:t.formControl,fullWidth:!0},o.a.createElement(Lt.a,{variant:"outlined",disabled:!0,defaultValue:a,fullWidth:!0,id:"family-admin",label:"Family Admin",onChange:function(e){return console.error("The admin value was changed, how is this even possible?")}})))),o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(me.a,{name:"create",label:"Create",type:"submit",fullWidth:!0,variant:"contained",color:"secondary"},"Create"))),o.a.createElement(Ft,{open:e.helpOpen,setOpen:e.setHelpOpen,content:ia}),o.a.createElement(Ct.a,{open:k,onClose:W},o.a.createElement(ea.a,{onClose:W},"Begin adding members to '",c,"'!"),o.a.createElement(ta.a,null,o.a.createElement(_.a,{align:"left"},"You can now add artefacts to this family. To view them simply select '",c,"' from the Select Family dropdown on your home dashboard.",o.a.createElement("br",null),"Begin getting members to join your family! Simply share the code below to your family members, get them to sign up and then they can join!",o.a.createElement("br",null),o.a.createElement("br",null),y," \xa0",o.a.createElement(oa.CopyToClipboard,{text:y,onCopy:function(){return F(!0)}},o.a.createElement(me.a,{variant:"outlined"},"Copy")),o.a.createElement("br",null),o.a.createElement("br",null),"(This code will also be available on the home page)")),o.a.createElement(Pt.a,null,o.a.createElement(me.a,{onClick:W,color:"primary",autoFocus:!0},"Continue"))),o.a.createElement(ra.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:P,autoHideDuration:2e3,onClose:function(){return F(!1)},message:o.a.createElement("span",{id:"message-id"},"Join code copied to clipboard",o.a.createElement("br",null),y)}))}var la=function(e){return o.a.createElement(r.Fragment,null,o.a.createElement(z.a,null),o.a.createElement(Te.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(Te.a,{item:!0,xs:11,md:6},o.a.createElement(ca,e))))},sa=a(33),ua=a(164),ma=function(e){var t=e.noErrors,a=Object(A.a)(e,["noErrors"]);return o.a.createElement(r.Fragment,null,o.a.createElement(me.a,Object.assign({},a,{color:"secondary",variant:"contained",type:"submit"}),"Save"),!t&&o.a.createElement(qt.a,{error:!t},"Unknown Error Occurred"))},pa=a(152),da=Object(pa.withGetScreen)(function(e){var t=e.states,a=e.setters,n=e.classes,i=e.isAdmin,c=e.openDelete,l=e.noErrors,s=e.isMobile,u=t.mode,m=u.create,p=u.edit,d=u.view,f=d&&i,g=p&&i,b=f||g||m,h=s()?18:"auto";return o.a.createElement(r.Fragment,null,(b&&!s()||!b)&&o.a.createElement(Te.a,{item:!0},o.a.createElement("div",{className:n.editLinkButton,style:{marginRight:"auto",height:"20px",visibility:"hidden"}})),o.a.createElement(Te.a,{item:!0},o.a.createElement(_.a,{variant:"h4",align:"center"},m&&"Create"," ",p&&"Edit"," ",d&&"View"," ","Artefact")),!b&&o.a.createElement(Te.a,{item:!0},o.a.createElement("div",{className:n.editLinkButton,style:{marginLeft:"auto",height:"20px",visibility:"hidden"}})),b&&o.a.createElement(Te.a,{item:!0},f&&o.a.createElement(me.a,{color:"secondary",variant:"contained",onClick:function(e){return a.setMode({edit:!0})},className:n.editLinkButton,style:{marginLeft:h}},"Edit"),g&&o.a.createElement(me.a,{color:"default",variant:"contained",onClick:c,className:n.editLinkButton,style:{marginLeft:h}},"Delete"),m&&o.a.createElement(ma,{noErrors:l,className:n.editLinkButton,style:{marginLeft:h}})),m&&o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(_.a,{variant:"subtitle1",align:s()?"left":"center"},"Artefacts are belongings of the family, enter as much or as little detail as you like")))}),fa=function(e){var t=e.states,a=e.setters,n=e.disabled,r=e.name,i=t.mode.view,c=t.state,l=a.handleSetField;return o.a.createElement(Lt.a,{id:"artefact-name",label:"Artefact name",variant:"outlined",autoFocus:!i,required:!0,fullWidth:!0,value:c.name||"",inputProps:{readOnly:i},onChange:function(e){return l(r,e.target.value)},disabled:n})},ga=function(e){var t=e.states,a=e.setters,n=e.artefactStates,r=e.disabled,i=e.name,c=t.mode.view,l=t.state,s=a.handleSetField;return o.a.createElement(Lt.a,{id:"state",label:"Artefact Condition",variant:"outlined",required:!0,fullWidth:!0,value:l.state||"",inputProps:{readOnly:c},onChange:function(e){return s(i,e.target.value)},select:!0,disabled:r},Object.keys(n).map(function(e){return o.a.createElement(te.a,{value:n[e],key:e},e)}))},ba=function(e){var t=e.states,a=e.setters,n=e.disabled,r=e.name,i=(e.numFams,t.mode.view),c=t.state,l=a.handleSetField;return o.a.createElement(Lt.a,{id:"description",label:"Description",variant:"outlined",required:!0,fullWidth:!0,multiline:!0,value:c.description||"",inputProps:{readOnly:i},onChange:function(e){return l(r,e.target.value)},disabled:n})},ha=function(e){var t=e.states,a=e.username,n=t.state;return o.a.createElement(Lt.a,{id:"artefact-admin",label:"Artefact Admin",variant:"outlined",required:!0,fullWidth:!0,value:n.admin&&0!==Object.keys(n.admin).length?n.admin.username:a,inputProps:{readOnly:!0},onChange:function(e){return console.log("admin field was changed")}})},ya=a(372),Ea=function(e){var t=e.states,a=e.setters,n=e.disabled,r=e.name,i=t.mode.view,c=t.state,l=a.handleSetField;return o.a.createElement(ya.a,{disabled:i||n,clearable:!0,minDate:"1500-01-01",inputVariant:"outlined",format:"dd/MM/yyyy",openTo:"year",label:"Date (dd/mm/yyyy)",value:c.date,onChange:function(e){return l(r,e)},KeyboardButtonProps:{"aria-label":"change date"}})},va=a(368),Oa=a(369),ja=function(e){var t=e.states,a=e.setters,n=e.disabled,i=e.name,c=e.classes,l=t.mode,s=l.create,u=l.edit,m=l.view,p=t.state,d=a.handleSetField;return s||u?o.a.createElement(r.Fragment,null,o.a.createElement(_.a,{variant:"h6",className:c.fieldTitle},"Privacy"),o.a.createElement(va.a,{control:o.a.createElement(Oa.a,{checked:p.isPublic||!1,onChange:function(e){return d(i,e.target.checked)},disabled:n}),style:{marginLeft:3},label:"Public"}),o.a.createElement(qt.a,{className:c.fieldTitle},p.isPublic?"Viewable by anyone":"Viewable by family members only")):m&&p.isPublic?o.a.createElement(r.Fragment,null,o.a.createElement(_.a,{variant:"h6",className:c.fieldTitle},"This artefact is public, accessible by link"),o.a.createElement(oa.CopyToClipboard,{text:window.location.href},o.a.createElement(me.a,{variant:"outlined"},"Copy Link"))):null},wa=a(374);function ka(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var Sa=function(e){var t=e.states,a=e.setters,i=e.families,c=e.disabled,l=e.name,s=e.classes,u=t.mode.view,m=t.state,p=a.handleSetField;return u&&m.belongsToFamiliesBools&&0===Object.values(m.belongsToFamiliesBools).filter(function(e){return e}).length?o.a.createElement(_.a,{variant:"h6",className:s.fieldTitle},"This artefact doesn't belong to any of your families"):o.a.createElement(r.Fragment,null,o.a.createElement(_.a,{variant:"h6",className:s.fieldTitle},u?"Belongs to your families":"Families the artefact belongs to"),o.a.createElement(G.a,{disablePadding:!0},i.map(function(e){return!m.belongsToFamiliesBools||u&&!m.belongsToFamiliesBools[e.id]?null:o.a.createElement(Z.a,{key:e.id,dense:!0,disabled:c},!u&&o.a.createElement(K.a,null,o.a.createElement(wa.a,{edge:"start",checked:m.belongsToFamiliesBools[e.id]||!1,onClick:function(t){return p(l,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ka(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ka(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},m.belongsToFamiliesBools,Object(n.a)({},e.id,t.target.checked)))},tabIndex:-1})),o.a.createElement(X.a,{primary:e.familyName}))})))},xa=a(170),Ca=a(157),Pa=a.n(Ca),Fa=function(e){var t=e.classes,a=e.states,n=e.setters,i=e.name,c=Object(ge.a)(),l=a.mode,s=l.edit,u=l.create,m=l.view,p=a.state,d=n.handleSetField;return o.a.createElement(r.Fragment,null,o.a.createElement(_.a,{variant:"h6",className:t.fieldTitle},"Images"),s&&o.a.createElement(_.a,{variant:"caption",className:t.fieldTitle},"Editing coming soon..."),u&&o.a.createElement(xa.a,{initialFiles:p.files||[],acceptedFiles:["image/*"],dropzoneText:"",filesLimit:1,onChange:function(e){return d(i,e)},dropzoneClass:t.dropzone,classes:{dropzoneTextStyle:t.fieldTitle,dropzoneParagraph:t.fieldTitle}}),(m||s)&&"False"!==p.upload&&o.a.createElement(Pa.a,{src:P.mediaRoot+p.upload,loading:o.a.createElement(Ne.a,null),color:c.palette.background.paper,imageStyle:{borderRadius:10}}))},Ta=a(342),Na=a(158),Da=a.n(Na);function Aa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var Ia=function(e){var t,a=e.states,i=e.setters,c=e.classes,l=e.name,s=e.handleGeocodeQuery,u=e.disabled,m=a.mode.view,p=i.handleSetField,d=i.setAddressIsSearchResult,f=i.setLocationState,g=i.handleSetLocationResult,b=a.locationState,h=a.state,y=Object(ge.a)();return t=y&&"dark"===y.palette.type?"mapbox://styles/mapbox/dark-v10?optimize=true":"mapbox://styles/mapbox/streets-v9?optimize=true",o.a.createElement(r.Fragment,null,o.a.createElement(Lt.a,{id:"address",label:"Address",variant:"outlined",fullWidth:!0,disabled:u,value:h.address||"",inputProps:{readOnly:m},onChange:function(e){p(l,e.target.value),e.target.value?d(!1):d(!0)},error:!!b.error,InputProps:{endAdornment:!m&&o.a.createElement(H.a,{className:c.iconButton,"aria-label":"search",id:"search",onClick:function(e){return s({query:h.address,initial:!1})}},o.a.createElement(Da.a,null)),style:{marginBottom:3}},onKeyDown:function(e){13!==e.keyCode||m||(e.preventDefault(),document.getElementById("search").click())},helperText:b.error}),o.a.createElement(Ta.a,{id:b.queryResults.length?"results":void 0,open:!!b.queryResults.length,anchorEl:document.getElementById("address"),onClose:function(e){return f(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Aa(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Aa(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},b,{queryResults:[]}))},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},o.a.createElement(G.a,{component:"div",disablePadding:!0},b.queryResults.map(function(e){return o.a.createElement(Z.a,{key:e.placeName,button:!0,className:c.nested,onClick:function(t){return g(e)}},o.a.createElement(X.a,{primary:e.placeName}))}))),o.a.createElement(Te.a,{container:!0,style:{marginTop:1}},o.a.createElement(Je,{interactive:!1,className:c.map,mapState:b.mapState,mapStyle:t,containerStyle:{height:"60vh",width:"100vw",borderRadius:20,marginTop:5},artefacts:[{center:b.mapState.center,id:-1}]})))},Wa=function(e){var t=e.save,a=e.cancel,n=e.updateErrors,r=e.classes;function i(e){return o.a.createElement(me.a,{variant:"contained",color:e.color,className:r.button,onClick:e.onClick,fullWidth:!0,padding:1},e.name)}return o.a.createElement(Te.a,{container:!0,justify:"space-evenly",alignItems:"center",spacing:1,style:{marginTop:1}},o.a.createElement(Te.a,{item:!0,xs:6},o.a.createElement(i,{onClick:t,name:"Save",color:"primary"})),o.a.createElement(Te.a,{item:!0,xs:6},o.a.createElement(i,{onClick:a,name:"Cancel",color:"secondary"})),n&&o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(qt.a,{error:!0},"Error Updating Artefact")))},$a=function(e){var t=e.child,a=e.childProps,n=e.name,r=e.classes,i=e.editButtonProps,c=Object(A.a)(e,["child","childProps","name","classes","editButtonProps"]),l=a.beingEdited,s=l===n,u=a.states.mode.edit&&!!l;return o.a.createElement(zt.a,{className:r.paperWrapper,elevation:3},o.a.createElement(na.a,{className:r.formControl,fullWidth:!0},o.a.createElement(t,Object.assign({},a,{disabled:u&&!s,name:n,classes:r},c)),s&&o.a.createElement(Wa,i)))},Ba=a(297),Ra=a(159),za=a.n(Ra),La=function(e){var t=e.open,a=e.setOpen,n=e.viewArtefact,r=e.classes,i=e.id;return o.a.createElement(Ba.a,{onClickAway:function(){return a(!1)}},o.a.createElement(ra.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:t,autoHideDuration:2e3,onClose:function(){return a(!1)},ContentProps:{"aria-describedby":"message-id"},message:o.a.createElement("span",{id:"message-id"},"Edit successful"),action:[o.a.createElement(me.a,{key:"view",color:"secondary",size:"small",onClick:function(e){return n(i)}},"VIEW"),o.a.createElement(H.a,{key:"close","aria-label":"close",color:"inherit",onClick:function(){return a(!1)},className:r.close},o.a.createElement(za.a,null))]}))},qa=function(e){var t=e.open,a=e.setOpen,n=e.deleteArtefact,r=e.artefact;return o.a.createElement(Ct.a,{fullWidth:!0,maxWidth:"sm",open:t,onClose:function(){return a(!1)},"aria-labelledby":"help-title"},o.a.createElement(ea.a,null,"Delete Artefact"),o.a.createElement(ta.a,null,o.a.createElement(aa.a,null,"This cannot be undone")),o.a.createElement(Pt.a,null,o.a.createElement(me.a,{onClick:function(){return a(!1)},color:"secondary"},"Cancel"),o.a.createElement(me.a,{onClick:function(){return n({variables:{id:r.id}})},color:"primary"},"Delete")))},Ma=function(e){var t=e.mode,a=t.edit,n=t.create,i=t.view;return o.a.createElement(r.Fragment,null,o.a.createElement(ea.a,{id:"help-title"},"Help"),n&&o.a.createElement(ta.a,null,o.a.createElement(aa.a,null,'Create an artefact by filling out the form and clicking "save".'),o.a.createElement(aa.a,null,"You can assign the artefact to any number of your families."),o.a.createElement(aa.a,null,'The artefact will only be viewable by members of the selected families, unless the artefact is set to "public".'),o.a.createElement(aa.a,null,"Only you will be able to edit the artefact after creation.")),a&&o.a.createElement(ta.a,null,o.a.createElement(aa.a,null,"Edit a field by clicking on it, save and cancel buttons will appear.")),i&&o.a.createElement(ta.a,null,o.a.createElement(aa.a,null,"Here you can view the details of an artefact."),o.a.createElement(aa.a,null,'If you are the admin of the artefact, a button labelled "edit" in the top right corner will enable editing mode.')))},Ha=a(160),_a=a.n(Ha);function Qa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Ua(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Qa(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qa(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Ja=function(){return o.a.createElement(Te.a,{container:!0,justify:"center",spacing:1,style:{marginTop:"2vh"}},o.a.createElement("img",{style:{width:"200%"},src:"https://media.tenor.com/images/b10411f7f3a9c5df3ce39a9678eac1dd/tenor.gif",alt:"artefact-pic"}),o.a.createElement(_.a,{variant:"h5",style:{textAlign:"center",padding:"2rem"}},"This artefact is not public.",o.a.createElement("br",null),"You do not have access to view this artefact. Join a family that this artefact is assigned to in order to view it. ",o.a.createElement("br",null),o.a.createElement(Mt.a,null,o.a.createElement(N.b,{to:"/"},"Return home"))))};function Va(e){var t,a=Object(r.useState)({create:e.create,edit:e.edit,view:e.view}),i=Object(b.a)(a,2),c=i[0],l=i[1],s=e.artefactLoading,u=e.artefactStates,m=e.families,p=e.fetchError,d=Object(r.useContext)(j),h=d.user.username;if(!c.create){var y=s?{}:e.artefactData.artefact;t=!(s||!y)&&y.admin.username===h}!t&&c.edit&&l({view:!0});var E=xt(),O=Object(r.useState)(""),w=Object(b.a)(O,2),S=w[0],x=w[1],C=Object(r.useState)({}),F=Object(b.a)(C,2),T=F[0],N=F[1],D=Object(r.useState)(!1),A=Object(b.a)(D,2),I=A[0],W=A[1],$=Object(r.useState)(!1),B=Object(b.a)($,2),R=B[0],z=B[1],L=Object(r.useState)({mapState:{},prevMapState:{},error:"",queryResults:[]}),q=Object(b.a)(L,2),M=q[0],H=q[1],_=Object(r.useState)(!0),Q=Object(b.a)(_,2),U=Q[0],J=Q[1],V=function(e){var t=e.query,a=e.initial;if(t)return Ze(t).then(function(e){var t={};e.noErrors?t.error="No results":e.error&&(t.error="Unknown error occurred, check console for details",console.error(e.error)),a?(t.mapState=e.results[0].mapState,J(!0)):t.queryResults=e.results,H(Ua({},M,{},t))})},Y=Object(r.useState)({}),G=Object(b.a)(Y,2),Z=G[0],K=G[1];if((c.edit||c.view)&&!s&&0===Object.keys(Z).length&&m&&y){var X={};m.map(function(e){return X[e.id]=!1}),y.belongsToFamilies.map(function(e){return X[e.id]=!0}),K(Ua({},y,{belongsToFamiliesBools:X})),V({query:y.address,initial:!0})}if(c.create&&m&&!Z.belongsToFamiliesBools){var ee={};m.map(function(e){return ee[e.id]=!1}),K({belongsToFamiliesBools:ee,date:null,state:"OKY"})}var te=function(e,t){c.edit&&S!==e&&(x(e),N(Z[e])),K(Ua({},Z,Object(n.a)({},e,t)))},ae=function(){H(Ua({},M,{error:"Select a search result or clear search field before saving"}))},ne=function(t){var a=e.history;a&&a.push("/artefacts/".concat(t)),l({view:!0})},re=function(){var t=e.history;t&&t.push("/artefacts/manage")},oe=function(e){var t=e.data.artefactCreate.artefact.id;ne(t)},ie=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:x(""),W(!0);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:re();case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Creation errors occurred:",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Update errors occured: ",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Deletion errors occured: ",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(g.a)(f.a.mark(function e(t,a,n){var r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=new FormData,Z.files&&Z.files.length&&r.append("itemImage",Z.files[0]),r.append("query",ut),r.append("variables",JSON.stringify(t)),o=P.uri,_a.a.post(o,r,{headers:{Authorization:"JWT "+localStorage.getItem(k),"Content-Type":"application/x-www-form-urlencoded","Content-Transfer-Encoding":"multipart/form-data"}}).then(function(e){a(e.data)}).catch(function(e){n(e)});case 6:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),pe=Object(v.a)(ft,{onCompleted:ie,onError:se}),de=Object(b.a)(pe,2),fe=de[0],ge=de[1].error,be=Object(v.a)(Et,{onCompleted:ce,onError:ue}),he=Object(b.a)(be,1)[0],ye=function(e){return e?e.toISOString().slice(0,-1):null},Ee=function(){var e=Object(g.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(U){e.next=3;break}return ae(),e.abrupt("return");case 3:a=[],Z.belongsToFamiliesBools&&(a=Object.keys(Z.belongsToFamiliesBools).filter(function(e){return Z.belongsToFamiliesBools[e]})),n={name:Z.name,description:Z.description,state:Z.state,isPublic:!!Z.isPublic&&Z.isPublic,belongsToFamilies:a,address:Z.address?Z.address:""},Z.date&&(n.date=ye(Z.date)),me(n,oe,le);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.edit){e.next=10;break}if(a={},U){e.next=7;break}return ae(),e.abrupt("return");case 7:"belongsToFamiliesBools"===S?a.belongsToFamilies=Object.keys(Z.belongsToFamiliesBools).filter(function(e){return Z.belongsToFamiliesBools[e]}):a[S]="date"===S?ye(Z[S]):Z[S];case 8:console.log("Input to GQL update mutation: input",a),fe({variables:{id:y.id,artefactInput:a}});case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Oe={save:ve,cancel:function(){te(S,T),x(""),"address"===S&&H(Ua({},M,{mapState:M.prevMapState,queryResults:[],prevMapState:{}}))},updateErrors:ge,classes:E},je={classes:E,beingEdited:S,artefactStates:u,username:d.user.username,families:m,states:{state:Z,locationState:M,mode:c},setters:{handleSetField:te,setMode:l}},we=Ua({},je,{handleGeocodeQuery:V,setters:Ua({},je.setters,{setLocationState:H,setAddressIsSearchResult:J,handleSetLocationResult:function(e){var t={mapState:e.mapState,error:"",queryResults:[]};"address"!==S||M.prevMapState||(t.prevMapState=M.mapState),te("address",e.placeName),H(Ua({},M,{},t)),J(!0)}})}),ke=!c.view||0!==Object.keys(Z).length&&Z.isPublic,Se=[{comp:fa,name:"name"},{comp:ga,name:"state"},{comp:ha,name:"admin"},{comp:Ea,name:"date"},{comp:ba,name:"description"},{comp:ke?ja:null,name:"isPublic"},{comp:Sa,name:"belongsToFamiliesBools"},{comp:c.view&&"False"===Z.upload||"undefined"===Z.upload?null:Fa,name:"files"}],xe=[{comp:fa,name:"name"},{comp:ga,name:"state"},{comp:ha,name:"admin"},{comp:Ea,name:"date"},{comp:ba,name:"description"},{comp:Sa,name:"belongsToFamiliesBools"},{comp:ke?ja:null,name:"isPublic"}],Ce=!c.view||"False"===Z.upload;return p?o.a.createElement(Ja,null):(c.view||c.edit)&&s?o.a.createElement(De,null):o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),c.create?Ee(e):ve(e)},className:E.form},o.a.createElement(Te.a,{container:!0,className:E.outerContainer,spacing:1},o.a.createElement(Te.a,{item:!0,xs:12,container:!0,justify:"space-between",alignItems:"center",spacing:1},o.a.createElement(da,Object.assign({isAdmin:t,openDelete:function(){return z(!0)},noErrors:!0},je))),Ce&&Se.map(function(e){var t=e.comp,a=e.name,n=e.widthProps;return null===t?null:(n||(n={xs:12,sm:6}),o.a.createElement(Te.a,Object.assign({container:!0,item:!0},n,{key:a,alignContent:"stretch"}),o.a.createElement($a,{key:t,child:t,name:a,childProps:je,editButtonProps:Oe,classes:E})))}),!Ce&&o.a.createElement(r.Fragment,null,o.a.createElement(Te.a,{container:!0,item:!0,xs:12,sm:6,alignContent:"stretch"},o.a.createElement($a,{child:Fa,name:"files",childProps:je,editButtonProps:Oe,classes:E})),o.a.createElement(Te.a,{container:!0,item:!0,xs:12,sm:6,alignContent:"stretch",spacing:1},xe.map(function(e){var t=e.comp,a=e.name,n=e.widthProps;return null===t?null:(n||(n={xs:12}),o.a.createElement(Te.a,Object.assign({container:!0,item:!0},n,{key:a,alignContent:"stretch",padding:1}),o.a.createElement($a,{key:t,child:t,name:a,childProps:je,editButtonProps:Oe,classes:E})))}))),(!c.view||Z.address)&&o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement($a,{child:Ia,name:"address",childProps:we,editButtonProps:Oe,classes:E})),c.create&&o.a.createElement(Te.a,{item:!0,xs:12,md:12},o.a.createElement(ma,{noErrors:!0,fullWidth:!0})),o.a.createElement(La,{open:I,setOpen:W,viewArtefact:ne,classes:E,id:y?y.id:"-1"}),o.a.createElement(qa,{open:R,setOpen:z,deleteArtefact:he,artefact:y}),o.a.createElement(Ft,{open:e.helpOpen,setOpen:e.setHelpOpen,content:Ma,mode:c})))}var Ya=Object(D.g)(function(e){return o.a.createElement(sa.a,{utils:ua.a},o.a.createElement(Te.a,{container:!0,spacing:0,alignItems:"flex-start",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(Te.a,{item:!0,xs:11,md:9},o.a.createElement(z.a,null),o.a.createElement(Va,e))))});function Ga(e){var t={child:St,childProps:{child:Ya},create:!0};return o.a.createElement(wt,Object.assign({},e,t,{child:Ot}))}function Za(e){var t={child:St,childProps:{child:Ya},view:!0};return o.a.createElement(wt,Object.assign({},e,{child:Ot,childProps:t}))}var Ka=a(370);function Xa(){var e=Object(h.a)(["\n    query artefactsQuery {\n        me {\n            artefactAdministratorOf {\n                edges {\n                    node {\n                        id\n                        name\n                        description\n                        upload\n                        admin {\n                            username\n                        }\n                    }\n                }\n            }\n        }\n    }\n"]);return Xa=function(){return e},e}var en=Object(L.a)(function(e){return{container:{padding:e.spacing(3)}}}),tn=E()(Xa()),an=function(){return o.a.createElement(r.Fragment,null,o.a.createElement(ea.a,{id:"help-title"},"Help"),o.a.createElement(ta.a,null,o.a.createElement(aa.a,null,"Here you can view all of the artefacts which you are an admin of."),o.a.createElement(aa.a,null,"Click view to see more about the artefact or to edit it.")))};function nn(e){var t=en(),a=Object(r.useState)({loading:!0}),n=Object(b.a)(a,2),i=n[0],c=n[1];return Object(v.b)(tn,{variables:{},onCompleted:function(e){return c({artefactEdges:e.me.artefactAdministratorOf.edges,loading:!1})},onError:function(e){return console.log(e)},fetchPolicy:"cache-and-network"}),o.a.createElement(Ka.a,null,o.a.createElement(z.a,null),o.a.createElement(Te.a,{container:!0,spacing:2,justify:"center",className:t.container},o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(_.a,{variant:"h4",align:"center"},"Manage Artefacts"),o.a.createElement(_.a,{variant:"subtitle1",align:"center"},"Here you can view all the artefacts you are an admin of")),i.loading?o.a.createElement(De,null):0!==i.artefactEdges.length?i.artefactEdges.map(function(e){return o.a.createElement(Te.a,{item:!0,xs:12,sm:6,md:4,lg:3,key:e.node.id},o.a.createElement(ze,{artefact:e.node}))}):o.a.createElement(zt.a,{className:t.paper,style:{marginTop:15,padding:"6px"}},"You are not managing any artefacts, click",o.a.createElement(Mt.a,{component:N.b,to:"/artefacts/create",color:"secondary"}," here "),"to create one.")),o.a.createElement(Ft,{open:e.helpOpen,setOpen:e.setHelpOpen,content:an}))}function rn(e){var t={child:St,childProps:{child:Ya},edit:!0};return o.a.createElement(wt,Object.assign({},e,{child:Ot,childProps:t}))}function on(e){return o.a.createElement("div",{style:{padding:"50px"}},o.a.createElement("h1",{style:{color:"red"}},"404 Page Not Found"),o.a.createElement("h3",null,"If you're seeing this page..."),o.a.createElement("img",{src:"https://media0.giphy.com/media/KVZXay4Uduy8XHpZRc/giphy.gif",alt:"You are lost - Obi Wan"}),o.a.createElement("p",null,o.a.createElement("a",{href:"/"},"Return home")))}function cn(){var e=Object(h.a)(["\n    mutation SelectFamilyMutation($profileId: Int!, $toFamily: String!) {\n        updateProfile(input: { id: $profileId, selectedFamily: $toFamily }) {\n            id\n            selectedFamily\n        }\n    }\n"]);return cn=function(){return e},e}function ln(){var e=Object(h.a)(["\n    mutation JoinFamily($joinCode: String!) {\n        familyJoin(joinCode: $joinCode) {\n            family {\n                familyName\n                familyAdmin {\n                    username\n                }\n            }\n        }\n    }\n"]);return ln=function(){return e},e}function sn(){var e=Object(h.a)(["\n    query {\n        me {\n            isMemberOf {\n                id\n                familyName\n                joinCode\n                hasArtefacts {\n                    edges {\n                        node {\n                            id\n                            name\n                            admin {\n                                username\n                            }\n                        }\n                    }\n                }\n            }\n            profile {\n                id\n                selectedFamily {\n                    id\n                    familyName\n                    joinCode\n                    about\n                    hasArtefacts {\n                        edges {\n                            node {\n                                id\n                                name\n                                description\n                                upload\n                                admin {\n                                    username\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n"]);return sn=function(){return e},e}var un=Object(L.a)(function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},icon:{color:"rgba(255, 255, 255, 0.54)"},outerContainer:{padding:e.spacing(2)},card:{alignContent:"stretch"},paper:{padding:e.spacing(1),borderRadius:10}}}),mn=E()(sn()),pn=E()(ln()),dn=E()(cn()),fn=function(){return o.a.createElement(r.Fragment,null,o.a.createElement(ea.a,{id:"help-title"},"Help"),o.a.createElement(ta.a,null,o.a.createElement(aa.a,null,"Select from your families in the corner to view their artefacts."),o.a.createElement(aa.a,null,"Enter a family's join code in the box underneath to join a family."),o.a.createElement(aa.a,null,"The join code can be copied by clicking the button underneath the family name.")))};function gn(e){var t,a,n,i=un(),c=Object(r.useState)(""),l=Object(b.a)(c,2),s=l[0],u=l[1],m=Object(r.useState)(!1),p=Object(b.a)(m,2),d=p[0],f=p[1],g=Object(r.useState)(""),h=Object(b.a)(g,2),y=h[0],E=h[1],O=Object(v.a)(pn,{refetchQueries:function(e){return[{query:mn}]},onError:function(e){return E("Enter a valid join code")},onCompleted:function(e){return E("")}}),j=Object(b.a)(O,1)[0],w=Object(v.b)(mn,{fetchPolicy:"cache-and-network"}),k=w.data,S=w.loading,x=Object(v.a)(dn,{refetchQueries:function(e){return[{query:mn}]}}),C=Object(b.a)(x,1)[0];if(S)return console.log("home data is loading on refetch"),o.a.createElement(De,null);if(!k)return console.error("User data was not defined, but fetched, logging out"),o.a.createElement(D.a,{to:"/logout"});t=k.me.profile.selectedFamily,a=k.me.isMemberOf,n=k.me.profile.id;var P=[];return t&&(P=k.me.profile.selectedFamily.hasArtefacts.edges),o.a.createElement(r.Fragment,null,o.a.createElement(z.a,null),o.a.createElement(Te.a,{container:!0,justify:"center"},o.a.createElement(Te.a,{item:!0,xs:12,lg:10,container:!0,spacing:3,justify:"space-between",className:i.outerContainer},o.a.createElement(Te.a,{item:!0,xs:12,sm:7,container:!0,justify:"center",alignItems:"stretch",spacing:1,className:i.paper},t&&o.a.createElement(r.Fragment,null,o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(_.a,{variant:"h1"},t.familyName)),o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(_.a,{variant:"subtitle1"},t.about)),o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(oa.CopyToClipboard,{text:t.joinCode,onCopy:function(){return f(!0)}},o.a.createElement(me.a,{variant:"outlined"},"Copy family join code")))),!t&&o.a.createElement(_.a,{variant:"h2"},"Join or Create a Family")),o.a.createElement(Te.a,{item:!0,xs:12,sm:5,md:3,container:!0,spacing:1,justify:"center",alignContent:"flex-start"},o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(Lt.a,{fullWidth:!0,label:"Select Family",variant:"outlined",value:t?t.id:null,select:!0,onChange:function(e){e.preventDefault();var t=e.target.value;C({variables:{profileId:n,toFamily:t}})},SelectProps:{name:"age",autoWidth:!0},disabled:a.length<=1},a&&a.map(function(e,t){return o.a.createElement(te.a,{key:e.id,value:e.id},e.familyName)}))),o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(Lt.a,{fullWidth:!0,id:"joinCodeField",variant:"outlined",label:"Enter join code",value:s,className:i.textField,onChange:function(e){E(""),u(e.target.value)},InputProps:{endAdornment:o.a.createElement(me.a,{variant:"contained",color:"primary",onClick:function(){0===s.length?console.error("Enter a valid joinCode"):k&&k.me.isMemberOf.map(function(e){return e.joinCode}).includes(s)?E("You are already a member of this family"):(j({variables:{joinCode:s}}),u(""))},className:i.button,size:"small"},"Join"),style:{}},helperText:y,error:!!y}))),o.a.createElement(Te.a,{container:!0,justify:"flex-start",alignItems:"stretch",spacing:1,item:!0,xs:12},P.map(function(e,t){return o.a.createElement(Te.a,{item:!0,xs:12,sm:6,md:4,key:t},o.a.createElement(ze,{artefact:e.node,className:i.card}))}),0===P.length&&t&&o.a.createElement(zt.a,{className:i.paper,style:{marginTop:15,padding:"6px"}},"This family has no artefacts, click",o.a.createElement(Mt.a,{component:N.b,to:"/artefacts/create",color:"secondary"}," here "),"to create one. Make sure to asign them to this family"),0===P.length&&!t&&o.a.createElement(zt.a,{className:i.paper,style:{marginTop:15,padding:"6px"}},"You are not yet a member of a family. Click",o.a.createElement(Mt.a,{component:N.b,to:"/family/create",color:"secondary"}," here "),"to create one. Or join using a join code on the right.")))),t&&o.a.createElement(ra.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:d,autoHideDuration:2e3,onClose:function(){return f(!1)},message:o.a.createElement("span",{id:"message-id"},"Join code copied to clipboard",o.a.createElement("br",null),t.joinCode)}),o.a.createElement(Ft,{open:e.helpOpen,setOpen:e.setHelpOpen,content:fn}))}var bn=a(298),hn=a(162),yn=a.n(hn),En=a(161),vn=a.n(En),On=a(371);function jn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function wn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?jn(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jn(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var kn=Object(L.a)(function(e){return{overlay:{position:"absolute",top:"70px",right:"5px",margin:e.spacing(1),minWidth:140},paper:{padding:e.spacing(1),margin:e.spacing(1),borderRadius:10},error:{backgroundColor:e.palette.error.dark},success:{backgroundColor:On.a[600]},icon:{opacity:.9,marginRight:e.spacing(1),fontSize:20},message:{display:"flex",alignItems:"center"}}}),Sn=function(){return o.a.createElement(r.Fragment,null,o.a.createElement(ea.a,{id:"help-title"},"Help"),o.a.createElement(ta.a,null,o.a.createElement(aa.a,null,"Select from your families to view artefacts from that family as pins on the map."),o.a.createElement(aa.a,null,"Only artefacts with a location will be shown.")),o.a.createElement(ea.a,{id:"help-title"},"Map Controls"),o.a.createElement(ta.a,null,o.a.createElement(aa.a,null,"Scroll to zoom"),o.a.createElement(aa.a,null,"Click and drag to move"),o.a.createElement(aa.a,null,"Click on an artefact to show more information.")))},xn=[{value:"mapbox://styles/mapbox/streets-v11",name:"Streets"},{value:"mapbox://styles/mapbox/satellite-v9",name:"Satellite"},{value:"mapbox://styles/mapbox/light-v10",name:"Light"},{value:"mapbox://styles/mapbox/dark-v10",name:"Dark"},{value:"mapbox://styles/zduffield/ck1q1hwgo2idy1cl3jt3rh1vk",name:"Ugly"}];function Cn(e){var t=Object(ge.a)(),a=kn(),i="mapbox://styles/mapbox/streets-v9?optimize=true";"dark"===t.palette.type&&(i="mapbox://styles/mapbox/dark-v10?optimize=true");var c=e.families,l=e.familiesLoading,s=Object(r.useState)({family:{id:"-1"},defaultMapStyle:i,mapStyle:i,selectedArtefact:{}}),u=Object(b.a)(s,2),m=u[0],p=u[1];m.defaultMapStyle!==i&&(m.mapStyle!==i?p(wn({},m,{defaultMapStyle:i,mapStyle:i})):p(wn({},m,{defaultMapStyle:i})));var d=Object(r.useState)([]),f=Object(b.a)(d,2),g=f[0],h=f[1],y=Object(r.useState)({zoom:[2]}),E=Object(b.a)(y,2),O=E[0],j=E[1],w=Object(r.useState)(!1),k=Object(b.a)(w,2),S=k[0],x=k[1],C=Object(r.useState)({open:!1,msg:""}),P=Object(b.a)(C,2),F=P[0],T=P[1];Object(v.b)(bt,{variables:{id:m.family.id},onCompleted:function(e){if(console.log("Query resulted"),e&&e.family){N=e.family.hasArtefacts.edges.map(function(e){return e.node});for(var t=[],a=0;a<N.length;a++)N[a].address&&t.push(Ke(N[a]).then(function(e){var t=e.response,a=e.artefact;if(!t.error)return wn({},a,{popup:!0,center:t.results[0].mapState.center,initPopupOpen:!1});console.log(t.error),T({open:!0,msg:"Error loading artefacts"})}));Promise.all(t).then(function(e){h(e),x(!0)})}},onError:function(e){m.family.id>0&&(T({open:!0,msg:"Error loading family"}),console.log(e))}});var N=[],D=function(e){if(e.target.value!==m.family){if("family"===e.target.name&&h([]),"selectedArtefact"===e.target.name&&null!==e.target.value){var t=e.target.value.center;t===O.center&&(t=t.map(function(e){return.99999999*e})),j({center:t}),e.target.value.initPopupOpen=!0}p(wn({},m,Object(n.a)({},e.target.name,e.target.value)))}};return o.a.createElement(zt.a,{className:a.paper,elevation:10},o.a.createElement(Te.a,{container:!0},o.a.createElement(Je,{interactive:!0,mapStyle:m.mapStyle,mapState:O,containerStyle:{height:"87vh",width:"100vw",position:"relative",zIndex:0,borderRadius:10},artefacts:g})),o.a.createElement(Te.a,{container:!0,item:!0,xs:4,sm:1,className:a.overlay,justify:"flex-end"},!l&&o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(zt.a,{className:a.paper},o.a.createElement(Lt.a,{fullWidth:!0,label:"Family",variant:"outlined",value:m.family||{},select:!0,onChange:D,SelectProps:{name:"family",autoWidth:!0}},c.map(function(e){return o.a.createElement(te.a,{value:e,key:e.id},e.familyName)})))),o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(zt.a,{className:a.paper},o.a.createElement(Lt.a,{fullWidth:!0,label:"Map Style",variant:"outlined",value:m.mapStyle,select:!0,onChange:D,SelectProps:{name:"mapStyle",autoWidth:!0}},o.a.createElement(te.a,{value:i},"Default"),xn.map(function(e){return o.a.createElement(te.a,{value:e.value,key:e.value},e.name)})))),g.length>0&&o.a.createElement(Te.a,{item:!0,xs:12},o.a.createElement(zt.a,{className:a.paper},o.a.createElement(Lt.a,{fullWidth:!0,label:"Jump to",variant:"outlined",value:m.selectedArtefact||{},select:!0,onChange:D,SelectProps:{name:"selectedArtefact",autoWidth:!0}},g.map(function(e){return o.a.createElement(te.a,{value:e,key:e.id},e.name)}))))),o.a.createElement(Ft,{open:e.helpOpen,setOpen:e.setHelpOpen,content:Sn}),o.a.createElement(ra.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:S,autoHideDuration:2e3,onClose:function(e){return x(!1)}},o.a.createElement(bn.a,{className:a.success,"aria-describedby":"success-message-id",message:o.a.createElement("span",{id:"success-message-id",className:a.message},o.a.createElement(vn.a,{className:a.icon}),g.length," Artefacts Loaded")})),o.a.createElement(ra.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:F.open,autoHideDuration:2e3,onClose:function(e){return T({open:!1,msg:""})}},o.a.createElement(bn.a,{className:a.error,"aria-describedby":"err-message-id",message:o.a.createElement("span",{id:"err-message-id",className:a.message},o.a.createElement(yn.a,{className:a.icon}),F.msg)})))}var Pn=function(e){return o.a.createElement(Ot,Object.assign({},e,{child:Cn}))};var Fn=function(e){return o.a.createElement(N.a,null,o.a.createElement(z.a,null),o.a.createElement("div",null,o.a.createElement(D.d,null,o.a.createElement(Rt,{exact:!0,path:"/",loggedIn:gn,landingPage:!0}),o.a.createElement(D.b,{exact:!0,path:"/login/",component:Ut}),o.a.createElement(D.b,{exact:!0,path:"/signup/",component:Kt}),o.a.createElement(D.b,{exact:!0,path:"/logout/",component:Xt}),o.a.createElement(Rt,{exact:!0,path:"/artefacts/create/",loggedIn:Ga}),o.a.createElement(Rt,{exact:!0,path:"/artefacts/manage/",loggedIn:nn}),o.a.createElement(Rt,{exact:!0,path:"/artefacts/:id/",loggedIn:Za}),o.a.createElement(Rt,{exact:!0,path:"/artefacts/edit/:id/",loggedIn:rn}),o.a.createElement(Rt,{exact:!0,path:"/family/create/",loggedIn:la}),o.a.createElement(Rt,{exact:!0,path:"/map/",loggedIn:Pn}),o.a.createElement(D.b,{component:on}))))};function Tn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Nn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Tn(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Tn(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Dn=Object(s.a)({uri:P.uri}),An=Object(u.a)(function(e,t){var a=t.headers,n=localStorage.getItem(k);return{headers:Nn({},a,{authorization:n?"JWT ".concat(n):""})}}),In=new l.a({link:An.concat(Dn),cache:new m.a,defaultOptions:{watchQuery:{fetchPolicy:"no-cache",errorPolicy:"all"},query:{fetchPolicy:"no-cache",errorPolicy:"all"}}});c.a.render(o.a.createElement(p.a,{client:In},o.a.createElement(function(e){var t=this,a=Object(r.useState)(!1),n=Object(b.a)(a,2),i=n[0],c=n[1],l=Object(r.useState)({}),s=Object(b.a)(l,2),u=s[0],m=s[1],p=Object(v.a)(T),d=Object(b.a)(p,2),h=d[0],y=d[1],E=y.error,O=y.loading,j=function(){var e=Object(g.a)(f.a.mark(function e(t,a){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({variables:{token:t}}).then(function(e){S(e),a&&a()}).catch(function(e){localStorage[k]="",c(!1),a&&a()});case 2:if(!E){e.next=5;break}return console.error(E),e.abrupt("return");case 5:O&&console.log("Loading...");case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),S=function(e){var t={username:e.data.verifyToken.payload.username};c(!0),m(t)},x={authenticated:i,user:u,initiateLogin:function(){t.history.pushState(null,"login")},handleAuthentication:j,logout:function(){c(!1),m({}),localStorage[k]=""}};return o.a.createElement(w,{value:x},e.children)},null,o.a.createElement(Fn,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[188,1,2]]]);
//# sourceMappingURL=main.2daf4556.chunk.js.map