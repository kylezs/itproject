(window["webpackJsonpartefacts-app"]=window["webpackJsonpartefacts-app"]||[]).push([[0],{164:function(e,t,a){e.exports=a(227)},169:function(e,t,a){},227:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a(0),o=a.n(r),i=a(14),c=a.n(i);a(169),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(56),s=a(146),u=a(142),m=a(145),p=a(29),d=a(13),f=a.n(d),g=a(16),b=a(9),h=a(23),y=a(21),v=a.n(y),E=a(15),O=Object(r.createContext)({authenticated:!1,user:{},authToken:"",initiateLogin:function(){},handleAuthentication:function(){},logout:function(){}}),j=O,S=O.Provider,w=(O.Consumer,"auth-token"),k="duplicate key",x="Please, enter valid credentials",C="pk.eyJ1IjoiemR1ZmZpZWxkIiwiYSI6ImNrMWdkODhpOTBiM28zZG03eDdjZ2dmN24ifQ.vAzlFYY5S9O82SKnwX69kQ",P={uri:"/graphql/"};function N(){var e=Object(h.a)(["\nmutation VerifyToken($token: String!) {\n    verifyToken(token: $token) {\n        payload\n    }\n}\n"]);return N=function(){return e},e}var W=v()(N());var T=a(17),I=a(55),F=a(3),$=a(77),A=a(53),D=a(124),q=a(125),B=a(147),R=a(126),z=a(271);var M=function(){var e=Object(R.a)(function(e){return{progress:{margin:e.spacing(2)}}})();return o.a.createElement(z.a,{className:e.progress})},L=a(283),U=a(277),Q=a(278),H=a(279),J=a(272),_=a(273),V=a(130),Z=a.n(V),G=a(131),K=a.n(G),Y=a(148),X=a(276),ee=a(129),te=a.n(ee),ae=function(e){var t=o.a.useState(null),a=Object(b.a)(t,2),n=a[0],i=a[1],c=Object(r.useContext)(j),l=Boolean(n);function s(){i(null)}return o.a.createElement("div",null,o.a.createElement(J.a,{component:T.b,to:"/family/create",color:"inherit"},"Create Family"),o.a.createElement(J.a,{component:T.b,to:"/artefacts/manage",color:"inherit"},"Manage Artefacts"),o.a.createElement(J.a,{component:T.b,to:"/artefacts/create",color:"inherit"},"Create Artefact"),o.a.createElement(J.a,{component:T.b,to:"/map/",color:"inherit"},"Artefact Map"),o.a.createElement(_.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){i(e.currentTarget)},color:"inherit"},o.a.createElement(te.a,null)),o.a.createElement(Y.a,{id:"menu-appbar",anchorEl:n,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:s},o.a.createElement(X.a,{onClick:s},"Profile"),o.a.createElement(X.a,{onClick:s},"Settings"),o.a.createElement(X.a,{onClick:function(){c.logout()}},"Logout")))},ne=o.a.forwardRef(function(e,t){return o.a.createElement(T.b,Object.assign({innerRef:t,to:"/login"},e))}),re=o.a.forwardRef(function(e,t){return o.a.createElement(T.b,Object.assign({innerRef:t,to:"/signup"},e))}),oe=function(e){return o.a.createElement("div",null,o.a.createElement(J.a,{color:"inherit",underline:"none",component:re},"Sign up"),o.a.createElement(J.a,{color:"inherit",underline:"none",component:ne},"Login"))},ie=a(150),ce=Object(R.a)(function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,alignText:"left"}}});function le(e){var t=ce(),a=Object(r.useContext)(j).authenticated,n=Object(ie.a)(),i=n&&"dark"===n.palette.type;return o.a.createElement("div",{className:t.root},o.a.createElement(U.a,{position:"static",color:"primary",elevation:6},o.a.createElement(Q.a,null,o.a.createElement(H.a,{container:!0},o.a.createElement(H.a,{item:!0,xs:2,container:!0},o.a.createElement(J.a,{fullWidth:!0,component:T.b,to:"/",color:"inherit"},"Home")),o.a.createElement(H.a,{item:!0,xs:10,container:!0,justify:"flex-end",alignItems:"center"},o.a.createElement(_.a,{className:t.menuButton,color:"inherit","aria-label":"menu",onClick:e.onToggleDarkTheme},i?o.a.createElement(K.a,null):o.a.createElement(Z.a,null)),a&&o.a.createElement(ae,{username:null}),!a&&o.a.createElement(oe,null))))))}var se=a(144),ue=a(282),me=a(87),pe=a(280),de=a(281),fe={primary:me.a,secondary:{main:pe.a[400]},type:"light"},ge={primary:{main:de.a.A100},secondary:pe.a,error:{main:"#CF6679"},background:{paper:"#303030",default:"#121212"},type:"dark"},be=Object(se.a)({palette:fe,type:"light"}),he=Object(se.a)({palette:ge,type:"dark"}),ye=function(e){localStorage.getItem("theme-type")||localStorage.setItem("theme-type","light");var t=Object(r.useState)("light"===localStorage.getItem("theme-type")?be:he),a=Object(b.a)(t,2),n=a[0],i=a[1];return o.a.createElement(ue.a,{theme:n},o.a.createElement(L.a,null),o.a.createElement(le,{onToggleDarkTheme:function(){var e="light"===n.palette.type?"dark":"light";localStorage.setItem("theme-type",e),i("light"===e?be:he)}}),e.children)};var ve=function(e){return o.a.createElement(ye,null,"This is some cool landing page yo. Welcome!",o.a.createElement("br",null),"Also, in the future, this page should not have a navigation bar, it'll have cooler design stuff. It only has the nav bar for easier linking to signup / login for now")},Ee=function(e){function t(){var e,a;Object($.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(D.a)(this,(e=Object(q.a)(t)).call.apply(e,[this].concat(r)))).state={checkAuthenticated:!1},a}return Object(B.a)(t,e),Object(A.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.context.authenticated&&this.setState({checkAuthenticated:!0});var t=localStorage.getItem(w);!this.context.authenticated&&t?this.context.handleAuthentication(t,function(){console.log("Setting state"),e.setState({checkAuthenticated:!0})}):this.setState({checkAuthenticated:!0})}},{key:"render",value:function(){return this.props.children(this.state.checkAuthenticated)}}]),t}(r.Component);Ee.contextType=j;var Oe=function(e){var t=e.loggedIn,a=e.loggedOut,n=(e.path,e.landingPage),i=Object(F.a)(e,["loggedIn","loggedOut","path","landingPage"]),c=Object(r.useContext)(j).authenticated;return a||(a="/login"),console.log("Authenticated: ",c),o.a.createElement(Ee,null,function(e){return!1===e?o.a.createElement(M,null):o.a.createElement(I.b,Object.assign({},i,{render:function(e){return c?o.a.createElement(t,e):!c&&n?o.a.createElement(ve,null):o.a.createElement(I.a,{to:a})}}))})},je=a(88),Se=a(58),we=a(307),ke=a(293),xe=a(299),Ce=a(68),Pe=a(284),Ne=a(285),We=a(288),Te=a(287),Ie=a(286),Fe=Object(R.a)(function(e){return{textField:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center",marginTop:e.spacing(1)},paper:{marginTop:e.spacing(1),padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center"},button:{margin:e.spacing(1)},card:{backgroundColor:e.palette.background.paper,maxWidth:345,borderRadius:10},media:{backgroundColor:e.palette.background.paper,height:140}}});var $e=function(e){var t=e.mediaURI,a=e.name,n=e.description,r=e.id,i=Fe();return console.log("here's the mediaURI: "+t),o.a.createElement(Pe.a,{className:i.card,elevation:3},o.a.createElement(Ne.a,null,o.a.createElement(Ie.a,{className:i.media,image:t,title:a}),o.a.createElement(Te.a,null,o.a.createElement(H.a,{item:!0,xs:!0,zeroMinWidth:!0},o.a.createElement(Se.a,{gutterBottom:!0,variant:"h5",component:"h2",noWrap:!0},a)),o.a.createElement(H.a,{item:!0,xs:!0,zeroMinWidth:!0},o.a.createElement(Se.a,{variant:"body2",color:"textSecondary",component:"p",noWrap:!0},n)))),o.a.createElement(We.a,null,o.a.createElement(J.a,{size:"small",color:"primary",component:T.b,to:"/artefacts/".concat(r)},"View"),o.a.createElement(J.a,{size:"small",color:"secondary",component:T.b,to:"/artefacts/edit/".concat(r)},"Edit")))};function Ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function De(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ae(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ae(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var qe=Object(R.a)(function(e){return{popup:{}}}),Be={accessToken:C,attributionControl:!1,maxZoom:18,minZoom:2},Re=Object(Ce.c)(De({},Be,{interactive:!1})),ze=Object(Ce.c)(De({},Be,{interactive:!0}));function Me(e){Object(ie.a)();var t=qe(),a=e.interactive?ze:Re,n=e.artefacts;n||(n=[]);var i=Object(r.useState)(""),c=Object(b.a)(i,2),l=c[0],s=c[1];return o.a.createElement(a,Object.assign({style:e.mapStyle?e.mapStyle:"mapbox://styles/mapbox/streets-v9?optimize=true",containerStyle:e.containerStyle},e.mapState,{onClick:function(e){return s("")}}),n.map(function(e){var a=e.center,n=e.popup,i=e.initPopupOpen,c=Object(F.a)(e,["center","popup","initPopupOpen"]);if(a&&a.length){var u=e.id;return o.a.createElement(r.Fragment,{key:u},o.a.createElement(Ce.a,{coordinates:a,onClick:function(t){s(l===u?"":u),e.initPopupOpen&&(e.initPopupOpen=!1)}},o.a.createElement("img",{src:"http://maps.google.com/mapfiles/ms/icons/red.png",alt:"marker-img"})),n&&(l===u||i)&&o.a.createElement(Ce.b,{coordinates:a,className:t.popup,offset:{"bottom-left":[12,-38],bottom:[0,-38],"bottom-right":[-12,-38]}},o.a.createElement($e,c)))}}))}var Le=a(186)({accessToken:C}),Ue=function(e){var t={},a=e.body.features;if(!a)return t.noResults=!0,t;for(var n=[],r=0;r<a.length;r++){var o=a[r],i={};if(i.mapState={center:o.center},"place"===o.place_type[0]){var c=o.bbox;if(c){var l=[[c[0],c[1]],[c[2],c[3]]];i.mapState.fitBounds=l}}else"address"===o.place_type[0]&&(i.mapState.zoom=[15]);i.placeName=o.place_name,i.locationType=o.place_type[0],n.push(i)}return t.results=n,t},Qe=function(e){var t={};return console.log("query error occurred"),t.error=e,t};function He(e,t){if(!e)return new Promise(function(e,t){e()});var a={query:e,limit:5};return t&&(a.types=t),"object"===typeof e?Le.reverseGeocode(a).send().then(function(e){return Ue(e)},function(e){return Qe(e)}):"string"===typeof e?Le.forwardGeocode(a).send().then(function(e){return Ue(e)},function(e){return Qe(e)}):void 0}function Je(e){return He(e.address).then(function(t){return{artefact:e,response:t}})}var _e=a(294),Ve=a(275),Ze=a(296),Ge=a(229),Ke=a(297),Ye=a(306),Xe=a(298),et=a(274),tt=a(231),at=a(289),nt=a(86),rt=a.n(nt),ot=a(143),it=a(304),ct=a(30),lt=a(149),st=a(138),ut=a.n(st),mt=a(135),pt=a.n(mt);function dt(){var e=Object(h.a)(["\n    mutation FamilyCreate($familyName: String!, $about: String) {\n        familyCreate(input: { familyName: $familyName, about: $about }) {\n            family {\n                familyName\n                joinCode\n            }\n        }\n    }\n"]);return dt=function(){return e},e}function ft(){var e=Object(h.a)(["\n    mutation SignupMutation(\n        $email: String!\n        $password: String!\n        $username: String!\n    ) {\n        createUser(email: $email, username: $username, password: $password) {\n            user {\n                id\n                username\n                email\n            }\n        }\n    }\n"]);return ft=function(){return e},e}function gt(){var e=Object(h.a)(["\n    query getFamilyArtefacts($id: ID!) {\n        family(id: $id) {\n            hasArtefacts {\n                edges {\n                    node {\n                        id\n                        name\n                        description\n                        address\n                    }\n                }\n            }\n        }\n    }\n"]);return gt=function(){return e},e}function bt(){var e=Object(h.a)(["\n    mutation TokenAuth($username: String!, $password: String!) {\n        tokenAuth(username: $username, password: $password) {\n            token\n        }\n    }\n"]);return bt=function(){return e},e}function ht(){var e=Object(h.a)(["\n    mutation UpdateArtefactMutation(\n        $id: ID!\n        $artefactInput: ArtefactInputType!\n    ) {\n        artefactUpdate(id: $id, input: $artefactInput) {\n            artefact {\n                id\n            }\n        }\n    }\n"]);return ht=function(){return e},e}function yt(){var e=Object(h.a)(["\n    query DetailView($id: ID!) {\n        artefact(id: $id) {\n            id\n            name\n            description\n            admin {\n                id\n                username\n            }\n            state\n            isPublic\n            upload\n            belongsToFamilies {\n                id\n            }\n            addedAt\n            address\n            date\n        }\n    }\n"]);return yt=function(){return e},e}function vt(){var e=Object(h.a)(["\n    query artefactsQuery {\n        me {\n            id\n        }\n    }\n"]);return vt=function(){return e},e}function Et(){var e=Object(h.a)(["\n    query artefactsQuery {\n        me {\n            isMemberOf {\n                familyName\n                id\n            }\n        }\n    }\n"]);return Et=function(){return e},e}function Ot(){var e=Object(h.a)(["\n    query ArtefactStatesQuery($name: String!) {\n        __type(name: $name) {\n            enumValues {\n                name\n                description\n            }\n        }\n    }\n"]);return Ot=function(){return e},e}function jt(){var e=Object(h.a)(["\n    mutation CreateArtefactMutation(\n        $name: String!\n        $state: String!\n        $isPublic: Boolean\n        $description: String!\n        $belongsToFamilies: [ID]\n        $address: String\n        $date: String\n    ) {\n        artefactCreate(\n            input: {\n                name: $name\n                state: $state\n                description: $description\n                isPublic: $isPublic\n                belongsToFamilies: $belongsToFamilies\n                address: $address\n                date: $date\n            }\n        ) {\n            artefact {\n                id\n            }\n        }\n    }\n"]);return jt=function(){return e},e}v()(jt());var St="\nmutation CreateArtefactMutation(\n        $name: String!\n        $state: String!\n        $isPublic: Boolean\n        $description: String!\n        $belongsToFamilies: [ID]\n        $address: String\n        $date: String\n    ) {\n        artefactCreate(\n            input: {\n                name: $name\n                state: $state\n                description: $description\n                isPublic: $isPublic\n                belongsToFamilies: $belongsToFamilies\n                address: $address\n                date: $date\n            }\n        ) {\n            artefact {\n                id\n            }\n        }\n    }\n",wt=v()(Ot()),kt=v()(Et()),xt=(v()(vt()),v()(yt())),Ct=v()(ht()),Pt=v()(bt()),Nt=v()(gt()),Wt=v()(ft()),Tt=v()(dt());function It(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Ft(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?It(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):It(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function $t(e){var t=e.create,a=e.edit,i=e.view,c=e.statesLoading,l=e.familiesLoading,s=e.artefactLoading,u=e.artefactStates,m=e.families,p=Object(r.useContext)(j),d=p.user.username;if(!t)var h=s?{}:e.artefactData.artefact,y=!s&&h.admin.username===d;!y&&a&&(a=!1,i=!0);var v=Object(ie.a)(),O=Ut(),S=Object(r.useState)(""),k=Object(b.a)(S,2),x=k[0],C=k[1],P=Object(r.useState)({}),N=Object(b.a)(P,2),W=N[0],T=N[1],I=Object(r.useState)(!1),F=Object(b.a)(I,2),$=F[0],A=F[1],D=Object(r.useState)({mapState:{},prevMapState:{},error:"",queryResults:[]}),q=Object(b.a)(D,2),B=q[0],R=q[1],z=Object(r.useState)(!0),U=Object(b.a)(z,2),Q=U[0],V=U[1],Z=function(e){var t=e.query,a=e.initial;if(t)return console.log("Query run with argument: ",t),He(t).then(function(e){var t={};e.noErrors?t.error="No results":e.error&&(t.error="Unknown error occurred, check console for details",console.log(e.error)),a?(t.mapState=e.results[0].mapState,V(!0)):t.queryResults=e.results,R(Ft({},B,{},t))})},G=Object(r.useState)({}),K=Object(b.a)(G,2),Y=K[0],ee=K[1];if((a||i)&&!s&&0===Object.keys(Y).length&&m){var te={};m.map(function(e){return te[e.id]=!1}),h.belongsToFamilies.map(function(e){return te[e.id]=!0}),ee(Ft({},h,{belongsToFamiliesBools:te})),Z({query:h.address,initial:!0})}if(t&&m&&!Y.belongsToFamiliesBools){te={};m.map(function(e){return te[e.id]=!1}),ee({belongsToFamiliesBools:te,date:null})}var ae=function(e,t){a&&x!==e&&(C(e),T(Y[e])),ee(Ft({},Y,Object(n.a)({},e,t)))},ne=function(){ae(x,W),C(""),"address"===x&&R(Ft({},B,{mapState:B.prevMapState,queryResults:[],prevMapState:{}}))},re=function(){R(Ft({},B,{error:"Select a search result or clear search field before saving"}))},oe=function(t){var a=e.history;a&&a.push("/artefacts/".concat(t))},ce=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:C(""),A(!0);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Update errors occured: ",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),se=function(e){console.log("here's input from call"),console.log(e);var t=new FormData;t.append("itemImage",Y.files[0]),t.append("query",St),t.append("variables",JSON.stringify(e));pt.a.post("http://localhost:8000/graphql/",t,{headers:{Authorization:"JWT "+localStorage.getItem(w),"Content-Type":"application/x-www-form-urlencoded","Content-Transfer-Encoding":"multipart/form-data"}}).then(function(e){console.log("Success, run some stuff"),console.log(e)}).catch(function(e){console.error(e)})},ue=Object(E.a)(Ct,{onCompleted:ce,onError:le}),me=Object(b.a)(ue,2),pe=me[0],de=me[1].error,fe=function(e){return e?e.toISOString().slice(0,-1):null},ge=function(){var e=Object(g.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Q){e.next=3;break}return re(),e.abrupt("return");case 3:a=[],Y.belongsToFamiliesBools&&(a=Object.keys(Y.belongsToFamiliesBools).filter(function(e){return Y.belongsToFamiliesBools[e]})),n={name:Y.name,description:Y.description,state:Y.state,isPublic:!!Y.isPublic&&Y.isPublic,belongsToFamilies:a,address:Y.address?Y.address:""},Y.date&&(n.date=fe(Y.date)),se(n);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),be=function(){var e=Object(g.a)(f.a.mark(function e(t){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=11;break}if(n={},Q){e.next=7;break}return re(),e.abrupt("return");case 7:"belongsToFamiliesBools"===x?n.belongsToFamilies=Object.keys(Y.belongsToFamiliesBools).filter(function(e){return Y.belongsToFamiliesBools[e]}):n[x]="date"===x?fe(Y[x]):Y[x];case 8:console.log("Input to GQL update mutation: input",n),{name:"hello",state:"OKY",description:"here's a short desc"},pe({variables:{id:h.id,artefactInput:n}});case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();function he(e){return o.a.createElement(J.a,{variant:"contained",color:e.color,className:O.button,onClick:e.onClick,fullWidth:!0,padding:1},e.name)}function ye(){return o.a.createElement(H.a,{container:!0,justify:"space-evenly",alignItems:"center",spacing:1,style:{marginTop:1}},o.a.createElement(H.a,{item:!0,xs:6},o.a.createElement(he,{onClick:be,name:"Save",color:"primary"})),o.a.createElement(H.a,{item:!0,xs:6},o.a.createElement(he,{onClick:ne,name:"Cancel",color:"secondary"})),de&&o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(ke.a,{error:!0},"Error Updating Artefact")))}var ve,Ee=l||c;ve=v&&"dark"===v.palette.type?"mapbox://styles/mapbox/dark-v10?optimize=true":"mapbox://styles/mapbox/streets-v9?optimize=true";return(a||i)&&Ee?o.a.createElement(M,null):o.a.createElement(r.Fragment,null,o.a.createElement(L.a,null),o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t?ge(e):be(e)},className:O.form},o.a.createElement(H.a,{container:!0,className:O.outerContainer,spacing:1},o.a.createElement(H.a,{item:!0,xs:12,container:!0,justify:"center"},o.a.createElement(H.a,{item:!0,xs:12,sm:8},o.a.createElement(Se.a,{variant:"h4",className:O.title},t&&"Create"," ",a&&"Edit"," ",i&&"View"," Artefact"),!i&&o.a.createElement(Se.a,{variant:"subtitle1",className:O.title},t&&"Artefacts are belongings of the family, enter as much or as little detail as you like",a&&"Click to start editing"))),o.a.createElement(H.a,{item:!0,xs:12,sm:6,container:!0,spacing:1},o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:O.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:O.formControl,fullWidth:!0},o.a.createElement(we.a,{id:"artefact-name",label:"Artefact name",variant:"outlined",autoFocus:!i,required:!0,fullWidth:!0,value:Y.name||"",inputProps:{readOnly:i},onChange:function(e){return ae("name",e.target.value)},disabled:a&&!!x&&"name"!==x}),a&&"name"===x&&o.a.createElement(ye,null)))),o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:O.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:O.formControl,fullWidth:!0},o.a.createElement(we.a,{id:"state",label:"Artefact State",variant:"outlined",required:!0,fullWidth:!0,value:Y.state||"",inputProps:{readOnly:i},onChange:function(e){return ae("state",e.target.value)},select:!0,disabled:a&&!!x&&"state"!==x},Object.keys(u).map(function(t){return o.a.createElement(X.a,{value:e.artefactStates[t],key:t},t)})),a&&"state"===x&&o.a.createElement(ye,null)))),o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:O.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:O.formControl,fullWidth:!0},o.a.createElement(we.a,{id:"description",label:"Description",variant:"outlined",required:!0,fullWidth:!0,multiline:!0,rows:6,value:Y.description||"",inputProps:{readOnly:i},onChange:function(e){return ae("description",e.target.value)},disabled:a&&!!x&&"description"!==x}),a&&"description"===x&&o.a.createElement(ye,null)))),o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:O.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:O.formControl,fullWidth:!0},o.a.createElement(we.a,{id:"artefact-admin",label:"Artefact Admin",variant:"outlined",required:!0,fullWidth:!0,value:Y.admin&&0!==Object.keys(Y.admin).length?Y.admin.username:p.user.username,inputProps:{readOnly:i},onChange:function(e){return console.log("admin field was changed")},disabled:!0})))),o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:O.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:O.formControl,fullWidth:!0},o.a.createElement(it.a,{disabled:i,clearable:!0,inputVariant:"outlined",format:"dd/MM/yyyy",openTo:"year",label:"Date",value:Y.date,onChange:function(e){return ae("date",e)},KeyboardButtonProps:{"aria-label":"change date"}}),a&&"date"===x&&o.a.createElement(ye,null))))),o.a.createElement(H.a,{item:!0,xs:12,sm:6,container:!0,spacing:1,alignContent:"stretch"},o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:O.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:O.formControl,fullWidth:!0},o.a.createElement(Ve.a,{subheader:o.a.createElement(Ze.a,{component:"div"},"Privacy"),dense:!0},o.a.createElement(Ge.a,{disabled:a&&!!x&&"isPublic"!==x},!i&&o.a.createElement(Ke.a,null,o.a.createElement(Ye.a,{edge:"start",checked:Y.isPublic||!1,tabIndex:-1,onClick:function(e){return ae("isPublic",e.target.checked)}})),o.a.createElement(Xe.a,{primary:"Public"}))),a&&"isPublic"===x&&o.a.createElement(ye,null)))),o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:O.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:O.formControl,fullWidth:!0},o.a.createElement(Ve.a,{subheader:o.a.createElement(Ze.a,{component:"div"},i?"Belongs to":"Select which of your families the artefact belongs to")},m.map(function(e){if(Y.belongsToFamiliesBools)return!i||Y.belongsToFamiliesBools[e.id]?o.a.createElement(Ge.a,{key:e.id,dense:!0,disabled:a&&!!x&&"belongsToFamiliesBools"!==x},!i&&o.a.createElement(Ke.a,null,o.a.createElement(Ye.a,{edge:"start",checked:Y.belongsToFamiliesBools[e.id]||!1,onClick:function(t){return ae("belongsToFamiliesBools",Ft({},Y.belongsToFamiliesBools,Object(n.a)({},e.id,t.target.checked)))},tabIndex:-1})),o.a.createElement(Xe.a,{primary:e.familyName})):void 0})),a&&"belongsToFamiliesBools"===x&&o.a.createElement(ye,null)))),!i&&o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:O.paperWrapper,elevation:3},o.a.createElement(lt.a,{initialFiles:Y.files||[],onChange:function(e){return ae("files",e)},dropzoneClass:O.dropzone})))),o.a.createElement(H.a,{container:!0,item:!0,xs:12,spacing:1},o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:O.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:O.formControl,fullWidth:!0},o.a.createElement(we.a,{id:"address",label:"Address",variant:"outlined",fullWidth:!0,value:Y.address||"",inputProps:{readOnly:i},onChange:function(e){ae("address",e.target.value),e.target.value?V(!1):V(!0)},error:!!B.error,InputProps:{endAdornment:!i&&o.a.createElement(_.a,{className:O.iconButton,"aria-label":"search",id:"search",onClick:function(e){return Z({query:Y.address,initial:!1})}},o.a.createElement(ut.a,null)),style:{marginBottom:3}},onKeyDown:function(e){13!==e.keyCode||i||(e.preventDefault(),document.getElementById("search").click())},helperText:B.error}),o.a.createElement(et.a,{id:B.queryResults.length?"results":void 0,open:!!B.queryResults.length,anchorEl:document.getElementById("address"),onClose:function(e){return R(Ft({},B,{queryResults:[]}))},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},o.a.createElement(Ve.a,{component:"div",disablePadding:!0},B.queryResults.map(function(e){return o.a.createElement(Ge.a,{key:e.placeName,button:!0,className:O.nested,onClick:function(t){return function(e){var t={mapState:e.mapState,error:"",queryResults:[]};"address"!==x||B.prevMapState||(t.prevMapState=B.mapState),ae("address",e.placeName),R(Ft({},B,{},t)),V(!0)}(e)}},o.a.createElement(Xe.a,{primary:e.placeName}))}))),a&&"address"===x&&o.a.createElement(ye,null),o.a.createElement(H.a,{container:!0,style:{marginTop:1}},o.a.createElement(Me,{interactive:!1,className:O.map,mapStyle:ve,mapState:B.mapState,containerStyle:{height:"60vh",width:"100vw",borderRadius:20,marginTop:5},artefacts:[{center:B.mapState.center}]})))))),t&&o.a.createElement(H.a,{item:!0,xs:5},o.a.createElement(J.a,{name:"create",label:"Create",type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:void 0},"Create"),!1)),o.a.createElement(tt.a,{onClickAway:function(){return A(!1)}},o.a.createElement(at.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:$,autoHideDuration:2e3,onClose:function(){return A(!1)},ContentProps:{"aria-describedby":"message-id"},message:o.a.createElement("span",{id:"message-id"},"Edit successful"),action:[o.a.createElement(J.a,{key:"view",color:"secondary",size:"small",onClick:function(e){return oe(h.id)}},"VIEW"),o.a.createElement(_.a,{key:"close","aria-label":"close",color:"inherit",onClick:function(){return A(!1)},className:O.close},o.a.createElement(rt.a,null))]}))))}var At=Object(I.g)(function(e){return o.a.createElement(ye,null,o.a.createElement(ct.a,{utils:ot.a},o.a.createElement(H.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(H.a,{item:!0,xs:10},o.a.createElement($t,e)))))});function Dt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function qt(e){var t=e.child,a=e.childProps,i=Object(F.a)(e,["child","childProps"]),c=Object(r.useState)([]),l=Object(b.a)(c,2),s=l[0],u=l[1],m=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Dt(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a,{families:s,familiesLoading:Object(E.b)(kt,{onCompleted:function(e){return u(e.me.isMemberOf)},onError:function(e){return console.log(e)}}).loading});return o.a.createElement(t,Object.assign({},i,m))}function Bt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Rt(e){var t=e.child,a=e.childProps,i=Object(F.a)(e,["child","childProps"]),c=Object(r.useState)({}),l=Object(b.a)(c,2),s=l[0],u=l[1],m=function(){var e=Object(g.a)(f.a.mark(function e(t){var a,n,r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in a={},t.__type.enumValues)r=t.__type.enumValues[o],n=r.description,a[n]=r.name;u(a);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),p=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Bt(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Bt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a,{artefactStates:s,statesLoading:Object(E.b)(wt,{variables:{name:"ArtefactState"},onCompleted:m,onError:function(e){return console.log(e)}}).loading});return o.a.createElement(t,Object.assign({},i,p))}function zt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Mt(e){var t=e.child,a=e.childProps,i=Object(F.a)(e,["child","childProps"]),c=(Object(r.useContext)(j).user.username,Object(E.b)(xt,{variables:{id:i.match.params.id},onError:function(e){return console.log(e)}})),l=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?zt(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):zt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a,{artefactData:c.data,artefactLoading:c.loading});return o.a.createElement(t,Object.assign({},i,l))}var Lt=Object(R.a)(function(e){return{root:{marginLeft:e.spacing(1),marginRight:e.spacing(1),margin:e.spacing(1),borderRadius:10},paper:{padding:e.spacing(2),backgroundColor:e.palette.background.paper,alignItems:"center",alignContent:"stretch",justify:"center",borderRadius:10},form:{display:"flex",flexWrap:"wrap"},submit:{margin:e.spacing(3,0,2)}}}),Ut=Object(R.a)(function(e){return{root:{width:"100%",height:"100%",backgroundColor:e.palette.background.paper,justifyContent:"center"},formControl:{height:"100%",justifyContent:"center",textAlign:"left"},title:{marginLeft:e.spacing(3),marginRight:e.spacing(3),padding:e.spacing(1),textAlign:"center"},paper:{padding:e.spacing(1),backgroundColor:e.palette.background.paper},paperWrapper:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,height:"100%",alignItems:"center",borderRadius:10},button:{height:"100%"},map:{height:"200px",type:e.palette.type},form:{marginBottom:e.spacing(10),marginTop:e.spacing(2),display:"flex",flexWrap:"wrap",textAlign:"center"},iconButton:{padding:10},dropzone:{backgroundColor:e.palette.background.paper,minHeight:"80px",borderRadius:10},outerContainer:{spacing:e.spacing(1),alignItems:"stretch",alignContent:"stretch",justifyContent:"center"}}});function Qt(e){var t=Object(r.useContext)(j),a=Lt(),n=Object(r.useState)(""),i=Object(b.a)(n,2),c=i[0],l=i[1],s=Object(r.useState)(""),u=Object(b.a)(s,2),m=u[0],p=u[1],d=Object(r.useState)(!1),h=Object(b.a)(d,2),y=h[0],v=h[1],O=Object(r.useState)(!1),S=Object(b.a)(O,2),k=S[0],C=S[1],P=function(){var a=Object(g.a)(f.a.mark(function a(n){var r;return f.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r=n.tokenAuth.token,t.handleAuthentication(r),localStorage.setItem(w,r),e.history.push("/");case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),N=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("_handleError run"),t.graphQLErrors&&(a=t.graphQLErrors[0].message.substring(0,15),x.startsWith(a)?(v(!0),console.log("invalid credentials")):(console.log("unexpect error(s):"),console.log(t),C(!0)));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),W=Object(E.a)(Pt,{onCompleted:P,onError:N}),I=Object(b.a)(W,1)[0],F=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I({variables:{username:c,password:m}}),t.preventDefault();case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return o.a.createElement(je.a,{className:a.paper,elevation:6},o.a.createElement("form",{onSubmit:F,className:a.form},o.a.createElement(Se.a,{component:"h1",variant:"h5",className:a.root},"Log In"),o.a.createElement(we.a,{className:a.root,variant:"outlined",required:!0,fullWidth:!0,id:"username",label:"Username",autoFocus:!0,onChange:function(e){return l(e.target.value)},error:y}),o.a.createElement(we.a,{className:a.root,variant:"outlined",required:!0,fullWidth:!0,label:"Password",type:"password",id:"password",onChange:function(e){return p(e.target.value)},error:y,helperText:y?"Please enter valid credentials":""}),o.a.createElement(H.a,{container:!0,justify:"center",alignItems:"center",spacing:3},o.a.createElement(H.a,{item:!0,xs:6},o.a.createElement(J.a,{className:a.root,name:"submit",label:"Submit",type:"submit",variant:"contained",color:"primary",fullWidth:!0},"Log In"),k&&o.a.createElement(ke.a,{error:k,className:a.root},"Unknown Error Occurred")),o.a.createElement(H.a,{item:!0,xs:6},o.a.createElement(xe.a,{component:T.b,to:"/signup",className:a.root,color:"inherit"},"Need an account? Sign up")))))}var Ht=function(e){return o.a.createElement(ye,null,o.a.createElement(H.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(H.a,{item:!0,xs:10,sm:8,md:6,lg:4},o.a.createElement(Qt,e))))},Jt=new(a(222));Jt.is().min(6).is().max(100).has().uppercase().has().digits().is().not().oneOf(["password","Password123"]);var _t=function(e){for(var t="",a=0;a<e.length;a++){a>=1&&(t+=" | ");var n=e[a];"min"===n&&(t+="Password must be at least ".concat(6," characters long")),"max"===n&&(t+="Password must be at most ".concat(100," characters long")),"uppercase"===n&&(t+="Password must have an uppercase letter"),"digits"===n&&(t+="Password must have a digit"),"oneOf"===n&&(t+="Password is too common")}return t};function Vt(e){var t=Object(r.useState)(""),n=Object(b.a)(t,2),i=n[0],c=n[1],l=Object(r.useState)(""),s=Object(b.a)(l,2),u=s[0],m=s[1],p=Object(r.useState)(""),d=Object(b.a)(p,2),h=d[0],y=d[1],v=Object(r.useState)(""),O=Object(b.a)(v,2),j=O[0],S=O[1],w=Object(r.useState)(!1),x=Object(b.a)(w,2),C=x[0],P=x[1],N=Object(r.useState)(!1),W=Object(b.a)(N,2),I=W[0],F=(W[1],Object(r.useState)(!1)),$=Object(b.a)(F,2),A=$[0],D=$[1],q=Object(r.useState)([]),B=Object(b.a)(q,2),R=B[0],z=B[1],M=Object(r.useState)(!1),L=Object(b.a)(M,2),U=L[0],Q=L[1],_=a(226),V=Lt(),Z=function(){var t=Object(g.a)(f.a.mark(function t(a){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.history.push("/login");case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),G=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("_handleError run"),t.graphQLErrors&&(a=t.graphQLErrors[0].message.substring(0,10),k.startsWith(a)?P(!0):(console.log("unexpect error(s):"),console.log(t),Q(!0)));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),K=Object(E.a)(Wt,{onCompleted:Z,onError:G}),Y=Object(b.a)(K,1)[0],X=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("form submitted"),Y({variables:{username:i,email:u,password:h}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:y(t),a=Jt.validate(t,{list:!0}),z(a),0!==a.length?D(!1):D(!0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),te=!!h&&!A,ae=!!j&&!(j===h),ne=!!h&&(!(j===h)||!A)||!!u&&!_.validate(u),re=!!u&&!_.validate(u),oe=I||re,ie="";return re?ie="Email is invalid":I&&(ie="Email is taken"),o.a.createElement(je.a,{className:V.paper,elevation:6},o.a.createElement("form",{className:V.form,onSubmit:X},o.a.createElement(Se.a,{component:"h1",variant:"h5",className:V.root},"Sign up"),o.a.createElement(we.a,{className:V.root,onChange:function(e){return c(e.target.value)},variant:"outlined",required:!0,fullWidth:!0,autoComplete:"username",label:"Username",type:"username",autoFocus:!0,error:C,helperText:C?"Username is taken":""}),o.a.createElement(we.a,{className:V.root,variant:"outlined",required:!0,fullWidth:!0,autoComplete:"email",label:"Email",type:"email",onChange:function(e){return m(e.target.value)},error:oe,helperText:ie}),o.a.createElement(we.a,{className:V.root,variant:"outlined",required:!0,fullWidth:!0,autoComplete:"password",label:"Password",type:"password",onChange:function(e){return ee(e.target.value)},error:te,helperText:te?_t(R):""}),o.a.createElement(we.a,{className:V.root,variant:"outlined",required:!0,fullWidth:!0,label:"Confirm Password",type:"password",onChange:function(e){return S(e.target.value)},error:ae,helperText:ae?"Passwords must match":""}),o.a.createElement(H.a,{container:!0,justify:"center",alignItems:"center",spacing:3},o.a.createElement(H.a,{item:!0,xs:6},o.a.createElement(J.a,{className:V.root,fullWidth:!0,label:"Submit",type:"submit",variant:"contained",color:"primary",disabled:ne},"Sign Up"),U&&o.a.createElement(ke.a,{error:U})),o.a.createElement(H.a,{item:!0,xs:6},o.a.createElement(xe.a,{className:V.root,component:T.b,to:"/login",color:"inherit"},"Already have an account? Log in")))))}var Zt=function(e){return o.a.createElement(ye,null,o.a.createElement(H.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(H.a,{item:!0,xs:10,sm:8,md:6,lg:4},o.a.createElement(Vt,e))))};var Gt=function(){return Object(r.useContext)(j).logout(),o.a.createElement(I.a,{to:"/login"})},Kt=a(290),Yt=a(308),Xt=a(291),ea=function(e){var t=Ut(),a=e.children,n=e.onClose;return o.a.createElement(Kt.a,{disableTypography:!0,className:t.root},o.a.createElement(Se.a,{variant:"h6"},a),n?o.a.createElement(_.a,{"aria-label":"close",className:t.closeButton,onClick:n},o.a.createElement(rt.a,null)):null)};function ta(e){var t=Ut(),a=Object(r.useContext)(j).user.username,i=Object(r.useState)(""),c=Object(b.a)(i,2),l=c[0],s=c[1],u=Object(r.useState)(""),m=Object(b.a)(u,2),p=m[0],d=m[1],h=Object(r.useState)(""),y=Object(b.a)(h,2),v=y[0],O=y[1],S=Object(r.useState)(!1),w=Object(b.a)(S,2),k=w[0],x=w[1],C=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),a=t.familyCreate.family.joinCode,O(a),x(!0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),P=Object(E.a)(Tt,{onCompleted:C}),N=Object(b.a)(P,2),W=N[0],T=N[1].data,I=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("Family name: "+l),console.log("About: "+p),W({variables:{familyName:l,about:p}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),F=function(e){e.preventDefault(),x(!1)};return o.a.createElement("form",{className:t.form,onSubmit:I},o.a.createElement(H.a,Object(n.a)({container:!0,spacing:1,className:t.outerContainer},"spacing",1),o.a.createElement(H.a,{item:!0,xs:12,container:!0,justify:"center"},o.a.createElement(Se.a,{variant:"h4",className:t.title},"Create Family"),o.a.createElement(Se.a,{variant:"subtitle1",className:t.title},"Families are how you manage your artefacts. We recognise there is often complex overlap between families. That's why you can create and be a part of several families, so you can separate which of the artefacts you manage belong to which family.")),o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:t.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:t.formControl,fullWidth:!0},o.a.createElement(we.a,{variant:"outlined",required:!0,fullWidth:!0,id:"family-name",label:"Family name",autoFocus:!0,onChange:function(e){return s(e.target.value)}})))),o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:t.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:t.formControl,fullWidth:!0},o.a.createElement(we.a,{variant:"outlined",multiline:!0,rows:6,fullWidth:!0,id:"about",label:"Tell people about your family",onChange:function(e){return d(e.target.value)}})))),o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:t.paperWrapper,elevation:3},o.a.createElement(_e.a,{className:t.formControl,fullWidth:!0},o.a.createElement(we.a,{variant:"outlined",disabled:!0,defaultValue:a,fullWidth:!0,id:"family-admin",label:"Family Admin",onChange:function(e){return console.log("hello")}})))),o.a.createElement(H.a,{item:!0,xs:5},o.a.createElement(J.a,{name:"create",label:"Create",type:"submit",fullWidth:!0,variant:"contained",color:"primary"},"Create"))),T&&o.a.createElement(Yt.a,{open:k,onClose:F},o.a.createElement(ea,{onClose:F},"Begin adding members to '",l,"'!"),o.a.createElement(Xt.a,null,o.a.createElement(Se.a,{align:"center"},"Begin getting members to join your family! Simply share the code below to your family members, get them to sign up and then they can join!",o.a.createElement("br",null),v))))}var aa=function(e){return o.a.createElement(ye,null,o.a.createElement(L.a,null),o.a.createElement(H.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(H.a,{item:!0,xs:6},o.a.createElement(ta,e))))};function na(e){var t={child:Mt,childProps:{child:At},create:!0};return o.a.createElement(Rt,Object.assign({},e,t,{child:qt}))}function ra(e){var t={child:Mt,childProps:{child:At},view:!0};return o.a.createElement(Rt,Object.assign({},e,{child:qt,childProps:t}))}function oa(){var e=Object(h.a)(["\n    query artefactsQuery($first: Int!) {\n        me {\n            artefactAdministratorOf(first: $first) {\n                edges {\n                    node {\n                        id\n                        name\n                        description\n                        upload\n                    }\n                }\n            }\n        }\n    }\n"]);return oa=function(){return e},e}var ia=Object(R.a)(function(e){return{textField:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center",marginTop:e.spacing(1)},container:{padding:e.spacing(1),margin:e.spacing(1)},button:{margin:e.spacing(1)}}}),ca=v()(oa());var la=function(e){var t=ia(),a=Object(r.useState)([]),n=Object(b.a)(a,2),i=n[0],c=n[1],l=Object(E.b)(ca,{variables:{first:10},onCompleted:function(e){return c(e.me.artefactAdministratorOf.edges)}}),s=l.data,u=l.loading;return console.log("The data is: ",s),u?o.a.createElement("p",null,"Loading..."):o.a.createElement(ye,null,o.a.createElement(L.a,null),o.a.createElement(H.a,{container:!0,spacing:2,className:t.container},o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(H.a,{container:!0,justify:"center",spacing:2},i.map(function(e){return o.a.createElement(H.a,{item:!0,key:e.node.id},o.a.createElement($e,{mediaURI:"/media/"+e.node.upload,title:e.node.name,description:e.node.description,id:e.node.id}))})))))};function sa(e){var t={child:Mt,childProps:{child:At},edit:!0};return o.a.createElement(Rt,Object.assign({},e,{child:qt,childProps:t}))}function ua(e){return o.a.createElement("div",{style:{padding:"50px"}},o.a.createElement("h1",{style:{color:"red"}},"404 Page Not Found"),o.a.createElement("h3",null,"If you're seeing this page..."),o.a.createElement("img",{src:"https://media0.giphy.com/media/KVZXay4Uduy8XHpZRc/giphy.gif",alt:""}),o.a.createElement("p",null,o.a.createElement("a",{href:"/"},"Return home")))}var ma=a(300),pa=a(301),da=a(309),fa=a(305);function ga(){var e=Object(h.a)(["\nmutation SelectFamilyMutation($profileId: Int!, $toFamily: String!) {\n    updateProfile(input: {\n        id: $profileId,\n        selectedFamily: $toFamily\n    }) {\n        id\n        selectedFamily\n    }\n}"]);return ga=function(){return e},e}function ba(){var e=Object(h.a)(["\nmutation JoinFamily($joinCode: String!) {\n  familyJoin(joinCode: $joinCode) {\n    family {\n      familyName\n      familyAdmin {\n          username\n      }\n    }\n  }\n}"]);return ba=function(){return e},e}function ha(){var e=Object(h.a)(["\n        query {\n            me {\n            isMemberOf {\n            id\n            familyName\n            joinCode\n            hasArtefacts {\n                edges {\n                node {\n                    id\n                    name\n                    admin {\n                    username\n                    }\n                }\n                }\n            }\n            }\n            profile {\n                id\n                selectedFamily {\n                    id\n                    familyName\n                    joinCode\n                        hasArtefacts {\n                            edges {\n                                node {\n                                    id\n                                    name\n                                    description\n                                    upload\n                                }\n                            }\n                        }\n                    }\n                }\n        }\n    }"]);return ha=function(){return e},e}var ya=Object(R.a)(function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},icon:{color:"rgba(255, 255, 255, 0.54)"}}}),va=v()(ha()),Ea=v()(ba()),Oa=v()(ga());var ja=function(e){var t=ya(),a=Object(r.useContext)(j).user.username,n=Object(r.useState)(""),i=Object(b.a)(n,2),c=i[0],l=i[1],s=Object(E.a)(Ea,{refetchQueries:function(e){return[{query:va}]}}),u=Object(b.a)(s,2),m=u[0],p=(u[1].data,Object(E.b)(va,{onCompleted:function(e){!function(e){e.me.profile.selectedFamily||console.error("User has not selected a family")}(e)}})),d=p.data,f=p.loading,g=(p.called,Object(E.a)(Oa,{refetchQueries:function(e){return[{query:va}]}})),h=Object(b.a)(g,2),y=h[0],v=(h[1].data,o.a.useRef(null));if(f)return o.a.createElement("p",null,"Loading...");var O=d.me.profile.selectedFamily,S=d.me.isMemberOf,w=d.me.profile.id,k=[];return O&&(k=d.me.profile.selectedFamily.hasArtefacts.edges),o.a.createElement(ye,null,o.a.createElement(L.a,null),o.a.createElement(H.a,{container:!0,spacing:3},o.a.createElement(H.a,{item:!0,xs:9},O&&o.a.createElement("div",null,o.a.createElement(Se.a,{variant:"h1"},O.familyName),o.a.createElement(Se.a,{variant:"h5"},"Join code: ",O.joinCode)),!O&&o.a.createElement(Se.a,{variant:"h2"},"Join and/or Select a Family"),o.a.createElement("h4",null,"Your username is (temp, for testing): ",a),o.a.createElement(ma.a,{cellHeight:"auto",cols:2},k.map(function(e,t){return o.a.createElement(pa.a,{key:t},o.a.createElement($e,{key:t,mediaURI:e.node.upload,title:e.node.name,description:e.node.description,id:e.node.id}))}))),o.a.createElement(H.a,{item:!0,xs:3},o.a.createElement(da.a,{ref:v,htmlFor:"outlined-age-simple"},"Select Family"),o.a.createElement(fa.a,{variant:"outlined",fullWidth:!0,disabled:S.length<=1,value:O?O.id:null,onChange:function(e){e.preventDefault();var t=e.target.value;y({variables:{profileId:w,toFamily:t}})},inputProps:{name:"age",id:"outlined-age-simple"}},S&&S.map(function(e,t){return o.a.createElement(X.a,{key:e.id,value:e.id},e.familyName)})),o.a.createElement(_e.a,{fullWidth:!0},o.a.createElement(we.a,{id:"joinCodeField",label:"Join a family",value:c,className:t.textField,margin:"normal",onChange:function(e){return l(e.target.value)},fullWidth:!0}),o.a.createElement(J.a,{variant:"outlined",onClick:function(){0!==c.length?m({variables:{joinCode:c}}):console.error("Enter a valid joinCode")}},"Join Family")))))},Sa=a(303),wa=a(292),ka=a(230),xa=a(139),Ca=a.n(xa),Pa=a(141),Na=a.n(Pa),Wa=a(140),Ta=a.n(Wa),Ia=a(302);function Fa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function $a(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fa(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fa(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Aa=Object(R.a)(function(e){return{overlay:{position:"absolute",top:"70px",right:"5px",margin:e.spacing(1),minWidth:120},paper:{padding:e.spacing(1),margin:e.spacing(1),borderRadius:10},error:{backgroundColor:e.palette.error.dark},success:{backgroundColor:Ia.a[600]},icon:{opacity:.9,marginRight:e.spacing(1),fontSize:20},message:{display:"flex",alignItems:"center"}}}),Da=function(){return o.a.createElement(r.Fragment,null,o.a.createElement(Kt.a,{id:"help-title"},"Help"),o.a.createElement(Xt.a,null,o.a.createElement(Sa.a,null,"Select from your families in the corner to view their artefacts"),o.a.createElement(Sa.a,null,"Only artefacts with a location will be shown")),o.a.createElement(Kt.a,{id:"help-title"},"Map Controls"),o.a.createElement(Xt.a,null,o.a.createElement(Sa.a,null,"Scroll to zoom"),o.a.createElement(Sa.a,null,"Click and drag to move"),o.a.createElement(Sa.a,null,"Click on an artefact to open a popup")))},qa=[{value:"mapbox://styles/mapbox/streets-v11",name:"Streets"},{value:"mapbox://styles/mapbox/satellite-v9",name:"Satellite"},{value:"mapbox://styles/mapbox/light-v10",name:"Light"},{value:"mapbox://styles/mapbox/dark-v10",name:"Dark"},{value:"mapbox://styles/zduffield/ck1q1hwgo2idy1cl3jt3rh1vk",name:"Ugly"}];function Ba(e){var t=Object(ie.a)(),a=Aa(),i="mapbox://styles/mapbox/streets-v9?optimize=true";"dark"===t.palette.type&&(i="mapbox://styles/mapbox/dark-v10?optimize=true");var c=e.families,l=e.familiesLoading,s=(Object(r.useRef)(null),Object(r.useState)({family:{id:"-1"},defaultMapStyle:i,mapStyle:i,selectedArtefact:{}})),u=Object(b.a)(s,2),m=u[0],p=u[1];m.defaultMapStyle!==i&&(m.mapStyle!==i?p($a({},m,{defaultMapStyle:i,mapStyle:i})):p($a({},m,{defaultMapStyle:i})));var d=Object(r.useState)([]),f=Object(b.a)(d,2),g=f[0],h=f[1],y=Object(r.useState)({zoom:[2]}),v=Object(b.a)(y,2),O=v[0],j=v[1],S=Object(r.useState)(!1),w=Object(b.a)(S,2),k=w[0],x=w[1],C=Object(r.useState)({open:!1,msg:""}),P=Object(b.a)(C,2),N=P[0],W=P[1],T=Object(r.useState)(!1),I=Object(b.a)(T,2),F=I[0],$=I[1];Object(E.b)(Nt,{variables:{id:m.family.id},onCompleted:function(e){if(e){A=e.family.hasArtefacts.edges.map(function(e){return e.node});for(var t=[],a=0;a<A.length;a++)A[a].address&&t.push(Je(A[a]).then(function(e){var t=e.response,a=e.artefact;if(!t.error)return $a({},a,{popup:!0,center:t.results[0].mapState.center,initPopupOpen:!1});console.log(t.error),W({open:!0,msg:"Error loading artefacts"})}));Promise.all(t).then(function(e){h(e),x(!0)})}},onError:function(e){m.family.id>0&&(W({open:!0,msg:"Error loading family"}),console.log(e))}});var A=[],D=function(e){e.target.value!==m.family&&("family"===e.target.name&&h([]),"selectedArtefact"===e.target.name&&(j($a({},O,{center:e.target.value.center})),e.target.value.initPopupOpen=!0),p($a({},m,Object(n.a)({},e.target.name,e.target.value))))};return o.a.createElement(je.a,{className:a.paper,elevation:10},o.a.createElement(H.a,{container:!0},o.a.createElement(Me,{interactive:!0,mapStyle:m.mapStyle,mapState:O,containerStyle:{height:"87vh",width:"100vw",position:"relative",zIndex:0,borderRadius:10},artefacts:g})),o.a.createElement(H.a,{container:!0,item:!0,xs:4,sm:1,className:a.overlay,justify:"flex-end"},!l&&o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:a.paper},o.a.createElement(we.a,{fullWidth:!0,label:"Family",variant:"outlined",value:m.family||{},select:!0,onChange:D,SelectProps:{name:"family",autoWidth:!0}},c.map(function(e){return o.a.createElement(X.a,{value:e,key:e.id},e.familyName)})))),o.a.createElement(H.a,{item:!0,xs:12},o.a.createElement(je.a,{className:a.paper},o.a.createElement(we.a,{fullWidth:!0,label:"Map Style",variant:"outlined",value:m.mapStyle,select:!0,onChange:D,SelectProps:{name:"mapStyle",autoWidth:!0}},o.a.createElement(X.a,{value:i},"Default"),qa.map(function(e){return o.a.createElement(X.a,{value:e.value},e.name)})))),o.a.createElement(_.a,{edge:"start",color:"inherit","aria-label":"menu",onClick:function(){return $(!0)}},o.a.createElement(Ca.a,null))),o.a.createElement(Yt.a,{fullWidth:!0,maxWidth:"sm",open:F,onClose:function(){return $(!1)},"aria-labelledby":"help-title"},o.a.createElement(Da,null),o.a.createElement(wa.a,null,o.a.createElement(J.a,{onClick:function(){return $(!1)},color:"primary"},"Close"))),o.a.createElement(at.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:k,autoHideDuration:2e3,onClose:function(e){return x(!1)}},o.a.createElement(ka.a,{className:a.success,"aria-describedby":"success-message-id",message:o.a.createElement("span",{id:"success-message-id",className:a.message},o.a.createElement(Ta.a,{className:a.icon}),g.length," Artefacts Loaded")})),o.a.createElement(at.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:N.open,autoHideDuration:2e3,onClose:function(e){return W({open:!1,msg:""})}},o.a.createElement(ka.a,{className:a.error,"aria-describedby":"err-message-id",message:o.a.createElement("span",{id:"err-message-id",className:a.message},o.a.createElement(Na.a,{className:a.icon}),N.msg)})))}var Ra=function(e){return o.a.createElement(ye,null,o.a.createElement(qt,Object.assign({},e,{child:Ba})))};var za=function(e){return o.a.createElement(T.a,null,o.a.createElement(L.a,null),o.a.createElement("div",null,o.a.createElement(I.d,null,o.a.createElement(Oe,{exact:!0,path:"/",loggedIn:ja,landingPage:!0}),o.a.createElement(I.b,{exact:!0,path:"/login/",component:Ht}),o.a.createElement(I.b,{exact:!0,path:"/signup/",component:Zt}),o.a.createElement(I.b,{exact:!0,path:"/logout/",component:Gt}),o.a.createElement(Oe,{exact:!0,path:"/artefacts/create/",loggedIn:na,landingPage:!0}),o.a.createElement(Oe,{exact:!0,path:"/artefacts/manage/",loggedIn:la,landingPage:!0}),o.a.createElement(Oe,{exact:!0,path:"/artefacts/:id/",loggedIn:ra,landingPage:!0}),o.a.createElement(Oe,{exact:!0,path:"/artefacts/edit/:id/",loggedIn:sa,landingPage:!0}),o.a.createElement(Oe,{exact:!0,path:"/family/create/",loggedIn:aa,landingPage:!0}),o.a.createElement(Oe,{exact:!0,path:"/map/",loggedIn:Ra,landingPage:!0}),o.a.createElement(I.b,{component:ua}))))};function Ma(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function La(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ma(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ma(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Ua=Object(s.a)({uri:P.uri}),Qa=Object(u.a)(function(e,t){var a=t.headers,n=localStorage.getItem(w);return{headers:La({},a,{authorization:n?"JWT ".concat(n):""})}}),Ha=new l.a({link:Qa.concat(Ua),cache:new m.a});c.a.render(o.a.createElement(p.a,{client:Ha},o.a.createElement(function(e){var t=this,a=Object(r.useState)(!1),n=Object(b.a)(a,2),i=n[0],c=n[1],l=Object(r.useState)({}),s=Object(b.a)(l,2),u=s[0],m=s[1],p=Object(r.useState)(""),d=Object(b.a)(p,2),h=d[0],y=d[1],v=Object(E.a)(W),O=Object(b.a)(v,2),j=O[0],k=O[1],x=k.error,C=k.loading,P=function(){var e=Object(g.a)(f.a.mark(function e(t,a){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(t=localStorage.getItem(w)),e.next=3,j({variables:{token:t}}).then(function(e){N(e),a&&a()}).catch(function(e){localStorage[w]="",a&&a()});case 3:if(!x){e.next=6;break}return console.log("[Error] handleAuthentication()"),e.abrupt("return");case 6:C&&console.log("Thing is loading");case 7:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),N=function(e){if(x)console.log("Invalid data, please sign in again");else{var t=e.data.verifyToken.payload.username;console.log("Here's the user id: ",e.data.verifyToken.payload.id);var a={username:t};c(!0),y(e.verifyToken),m(a)}},T={authenticated:i,authToken:h,user:u,initiateLogin:function(){t.history.pushState(null,"login")},handleAuthentication:P,logout:function(){console.log("Logout called"),c(!1),m({}),y(""),localStorage[w]=""}};return o.a.createElement(S,{value:T},e.children)},null,o.a.createElement(za,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[164,1,2]]]);
//# sourceMappingURL=main.a9d97940.chunk.js.map