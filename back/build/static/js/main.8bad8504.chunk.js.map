{"version":3,"sources":["serviceWorker.js","authContext.js","constants.js","components/Auth.js","components/Loading.js","components/LoggedInBar.js","components/NotLoggedInBar.js","components/Header.js","components/Layout.js","views/LandingPage.js","components/PrivateRoute.js","components/ArtefactCard.js","components/Map.js","components/MapAPI.js","gqlQueriesMutations.js","components/GetFamiliesWrapper.js","components/GetStatesWrapper.js","components/GetArtefactWrapper.js","components/LoginSignupFormStyling.js","components/ArtefactFamilyFormStyling.js","views/LoginView.js","components/passwordValidator.js","views/SignupView.js","components/Logout.js","views/CreateFamilyView.js","views/artefactViews/components/Title.js","views/artefactViews/components/Name.js","views/artefactViews/components/State.js","views/artefactViews/components/Description.js","views/artefactViews/components/Admin.js","views/artefactViews/components/Date.js","views/artefactViews/components/Privacy.js","views/artefactViews/components/Families.js","views/artefactViews/components/Images.js","views/artefactViews/components/Address.js","views/artefactViews/components/EditButtons.js","views/artefactViews/components/FieldWrapper.js","views/artefactViews/components/SuccessSnackbar.js","views/artefactViews/components/CreateButton.js","views/artefactViews/ArtefactView.js","views/artefactViews/CreateArtefactView.js","views/artefactViews/DetailView.js","views/artefactViews/ManageArtefactsView.js","views/artefactViews/EditArtefactView.js","views/Error404View.js","views/UserHomeView.js","views/MapView.js","App.js","index.js"],"names":["Boolean","window","location","hostname","match","authContext","createContext","authenticated","user","authToken","initiateLogin","handleAuthentication","logout","AuthProvider","Provider","AUTH_TOKEN","Consumer","USERNAME_TAKEN_ERR_MSG","INVALID_CRED_ERR_MSG","MY_ACCESS_TOKEN","config","uri","mediaRoot","VERIFY_TOKEN_MUTATION","gql","Loading","classes","makeStyles","theme","progress","margin","spacing","useStyles","CircularProgress","className","props","React","useState","anchorEl","setAnchorEl","context","useContext","open","handleClose","Button","component","RouterLink","to","color","IconButton","aria-label","aria-controls","aria-haspopup","onClick","event","currentTarget","Menu","id","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","onClose","MenuItem","LoginLink","forwardRef","ref","innerRef","SignupLink","underline","root","flexGrow","menuButton","marginRight","title","alignText","MenuAppBar","loggedIn","useTheme","dark","palette","type","AppBar","position","elevation","Toolbar","Grid","container","item","xs","fullWidth","justify","alignItems","onToggleDarkTheme","LoggedInBar","username","NotLoggedInBar","lightPalette","primary","indigo","secondary","main","teal","darkPalette","deepPurple","error","background","paper","default","lightTheme","createMuiTheme","darkTheme","localStorage","getItem","setItem","setTheme","ThemeProvider","CssBaseline","newTheme","children","LandingPage","Layout","WaitWraper","state","checkAuthenticated","this","setState","localToken","console","log","Component","contextType","PrivateRoute","LoggedIn","loggedOut","landingPage","path","rest","render","textField","padding","backgroundColor","textAlign","marginTop","button","card","maxWidth","borderRadius","media","height","ArtefactCard","mediaURI","name","description","Card","CardActionArea","CardMedia","image","CardContent","zeroMinWidth","Typography","gutterBottom","variant","noWrap","CardActions","size","popup","mapProps","accessToken","attributionControl","maxZoom","minZoom","Mapbox","ReactMapboxGl","interactive","InteractiveMapbox","Map","MapType","artefacts","openArtefactID","setOpenArtefactID","style","mapStyle","containerStyle","mapState","e","map","artefact","center","initPopupOpen","length","artefactID","key","coordinates","src","alt","offset","bottom","geocodingService","require","mbxGeocoding","_handleResponse","response","out","features","body","noResults","results","i","feature","result","place_type","bboxCoords","bbox","fitBounds","zoom","placeName","place_name","locationType","push","_handleError","geocodeQuery","query","types","Promise","resolve","reject","args","limit","reverseGeocode","send","then","forwardGeocode","artefactGeocodeQuery","address","CREATE_ARTEFACT_MUTATION_STR","GET_ARTEFACT_STATES_QUERY","GET_FAMILIES_QUERY","ARTEFACT_DETAIL","UPDATE_ARTEFACT_MUTATION","LOGIN_MUTATION","GET_FAMILY_ARTEFACTS","SIGNUP_MUTATION","CREATE_FAMILY_MUTATION","GetFamiliesWrapper","Child","child","childProps","families","setFamilies","thisChildProps","familiesLoading","useQuery","onCompleted","data","me","isMemberOf","onError","loading","GetStatesWrapper","artefactStates","setArtefactStates","_saveArtefactStates","statesData","a","temp","__type","enumValues","desc","statesLoading","variables","GetArtefactWrapper","params","artefactData","artefactLoading","marginLeft","alignContent","form","display","flexWrap","submit","width","justifyContent","formControl","paperWrapper","marginBottom","iconButton","dropzone","minHeight","outerContainer","Login","formUseStyles","setUsername","password","setPassword","invalidCred","setInvalidCred","unknownError","setUnknownError","_confirm","token","tokenAuth","history","errors","graphQLErrors","subMessage","message","substring","startsWith","useMutation","login","submitForm","preventDefault","Paper","onSubmit","TextField","required","label","autoFocus","onChange","target","value","helperText","FormHelperText","Link","direction","sm","md","lg","PASSWORD_SCHEMA","is","min","max","has","uppercase","digits","not","oneOf","parseFailedRules","rules","output","rule","Signup","email","setEmail","confirmPassword","setConfirmPassword","usernameIsTaken","setUsernameIsTaken","emailIsTaken","validPassword","setValidPassword","failedPassRules","setFailedPassRules","emailValidator","signup","changePassword","pass","failedRules","validate","list","errorPassword","errorConfirmPassword","disableSubmit","invalidEmail","emailError","emailErrMsg","autoComplete","disabled","Logout","MyDialogTitle","artefactFamilyFormUseStyles","DialogTitle","disableTypography","closeButton","CreateFamilyView","familyName","setFamilyName","about","setAbout","joinCode","setJoinCode","setOpen","_completed","familyCreate","family","createFamily","FormControl","multiline","rows","defaultValue","Dialog","DialogContent","align","mode","create","edit","view","states","setters","handleSetField","inputProps","readOnly","select","Object","keys","admin","clearable","inputVariant","format","openTo","date","KeyboardButtonProps","List","subheader","ListSubheader","dense","ListItem","ListItemIcon","Checkbox","edge","checked","isPublic","tabIndex","ListItemText","belongsToFamiliesBools","initialFiles","files","dropzoneClass","handleGeocodeQuery","setAddressIsSearchResult","setLocationState","handleSetLocationResult","locationState","InputProps","endAdornment","initial","onKeyDown","keyCode","document","getElementById","click","Popover","queryResults","undefined","disablePadding","nested","save","cancel","updateErrors","MyButton","editButtonProps","beingEdited","thisBeingEdited","someBeingEdited","EditButtons","viewArtefact","ClickAwayListener","onClickAway","Snackbar","autoHideDuration","ContentProps","action","close","noErrors","ArtefactView","isAdmin","setBeingEdited","prevValue","setPrevValue","snackbarOpen","setSnackbarOpen","prevMapState","addressIsSearchResult","newState","belong","val","belongsToFamilies","fieldName","handleUnselectedSearchField","pushViewArtefactURL","handleCreationCompleted","artefactCreate","updateCompleted","handleCreationError","handleUpdateError","createArtefact","successCallback","errorCallback","form_data","FormData","append","JSON","stringify","url","axios","post","headers","Authorization","res","catch","err","updateArtefact","parseDate","toISOString","slice","famIDs","filter","input","saveChange","artefactInput","componentProps","addressProps","newLocationState","Panes","comp","Name","State","Description","Admin","Date","Privacy","Families","Images","Title","pane","FieldWrapper","Address","CreateButton","SuccessSnackbar","withRouter","utils","DateFnsUtils","CreateArtefactView","EditArtefactView","LIST_OF_ARTEFACTS","ManageArtefactsView","artefactEdges","SetArtefactEdges","first","artefactAdministratorOf","edges","node","upload","Error404View","href","overflow","icon","HOMEPAGE_INFO","JOIN_FAMILY_MUTATION","SELECT_FAMILY_MUTATION","UserHomeView","formJoinCode","setFormJoinCode","refetchQueries","joinFamilyMutation","profile","selectedFamily","_homepageInfoCompleted","home_data","called","selectFamily","inputLabel","useRef","profileId","hasArtefacts","GridList","cellHeight","cols","GridListTile","InputLabel","htmlFor","Select","newFamily","toFamily","overlay","top","right","minWidth","success","green","opacity","fontSize","MyDialogContent","DialogContentText","MapStyles","MapView","defaultMapStyle","selectedArtefact","mapArtefacts","setMapArtefacts","setMapState","msg","errorSnackbar","setErrorSnackbar","helpOpen","setHelpOpen","promiseArr","all","handleChange","zIndex","SelectProps","autoWidth","fam","aria-labelledby","DialogActions","SnackbarContent","aria-describedby","App","exact","DetailView","httpLink","createHttpLink","authLink","setContext","_","authorization","client","ApolloClient","link","concat","cache","InMemoryCache","ReactDOM","setAuthenticated","setUser","setAuthToken","VerifyToken","_callback","setSession","verifyToken","payload","authProviderValue","pushState","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.8bad8504.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { createContext } from \"react\";\n\nconst authContext = createContext({\n    authenticated: false, // to check if authenticated or not\n    user: {}, // store all the user details\n    authToken: \"\", \n    initiateLogin: () => { }, \n    handleAuthentication: () => { }, \n    logout: () => { }\n});\n\nexport default authContext;\nexport const AuthProvider = authContext.Provider;\nexport const AuthConsumer = authContext.Consumer;","export const AUTH_TOKEN = 'auth-token'\nexport const THEME_TYPE = 'theme-type'\nexport const USERNAME_TAKEN_ERR_MSG = `duplicate key`\nexport const INVALID_CRED_ERR_MSG = `Please, enter valid credentials`\nexport const MY_ACCESS_TOKEN =\n           'pk.eyJ1IjoiemR1ZmZpZWxkIiwiYSI6ImNrMWdkODhpOTBiM28zZG03eDdjZ2dmN24ifQ.vAzlFYY5S9O82SKnwX69kQ'\n\n// GQL API for prod vs dev\n\n// Whatever server the app is on, /graphql/\nconst prod = {\n    uri: '/graphql/',\n    mediaRoot: 'https://artefact-picture.s3.amazonaws.com/media/'\n}\n\n// In case running dev on either :8000 or :3000, this must be specified as full path\nconst dev = {\n    uri: 'http://localhost:8000/graphql/',\n    mediaRoot: 'http://localhost:8000/media/'\n}\n\n// If npm run build => production, if npm start => development (built into react)\nexport const config = process.env.NODE_ENV === 'development' ? dev : prod\n","import React, { useState } from \"react\";\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { AuthProvider } from \"../authContext\";\nimport { AUTH_TOKEN } from '../constants'\n\n\nconst VERIFY_TOKEN_MUTATION = gql`\nmutation VerifyToken($token: String!) {\n    verifyToken(token: $token) {\n        payload\n    }\n}\n`\n\nexport default function Auth(props) {\n    const [authenticated, setAuthenticated] = useState(false)\n    const [user, setUser] = useState({})\n    const [authToken, setAuthToken] = useState(\"\");\n    const [VerifyToken, {error, loading }] = useMutation(VERIFY_TOKEN_MUTATION)\n\n    const handleAuthentication = async (authToken, _callback) => {\n        if (!authToken) {\n            authToken = localStorage.getItem(AUTH_TOKEN)\n        }\n\n        await VerifyToken({ variables: { token: authToken } }).then((data) => {\n            setSession(data)\n            if (_callback) {\n                _callback();\n            }\n        }).catch((errors) => {\n            // If could not validate it, remove it to stop unnecessary requests\n            localStorage[AUTH_TOKEN] = \"\"\n            if (_callback) {\n                _callback();\n            }\n        }\n\n        );\n        if (error) {\n            console.log(\"[Error] handleAuthentication()\")\n            return;\n        }\n\n        if (loading) {\n            console.log(\"Thing is loading\");\n        }\n\n    };\n\n    const setSession = (data) => {\n\n        if (error) {\n            console.log(\"Invalid data, please sign in again\");\n            return;\n        }\n\n        const username = data.data.verifyToken.payload.username\n        console.log(\"Here's the user id: \", data.data.verifyToken.payload.id);\n        const user = {\n            username: username,\n        };\n        setAuthenticated(true);\n        setAuthToken(data.verifyToken);\n        setUser(user);\n    }\n\n    const initiateLogin = () => {\n        this.history.pushState(null, 'login');\n    };\n\n    const logout = () => {\n        console.log(\"Logout called\");\n        setAuthenticated(false);\n        setUser({});\n        setAuthToken(\"\");\n        localStorage[AUTH_TOKEN] = \"\";\n    };\n\n    const authProviderValue = {\n        authenticated,\n        authToken,\n        user,\n        initiateLogin: initiateLogin,\n        handleAuthentication: handleAuthentication,\n        logout: logout\n    };\n\n    return (\n        <AuthProvider value={authProviderValue}>\n            {props.children}\n        </AuthProvider>\n    );\n}\n","import React from 'react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport CircularProgress from '@material-ui/core/CircularProgress'\n\nfunction Loading() {\n    const useStyles = makeStyles(theme => ({\n        progress: {\n            margin: theme.spacing(2)\n        }\n    }))\n\n    const classes = useStyles()\n\n    return <CircularProgress className={classes.progress} />\n}\n\nexport default Loading\n","import React, { useContext } from 'react'\nimport { IconButton, Menu, MenuItem, Button } from '@material-ui/core'\nimport AccountCircle from '@material-ui/icons/AccountCircle'\nimport authContext from '../authContext'\nimport { Link as RouterLink } from 'react-router-dom'\n\nexport default props => {\n    const [anchorEl, setAnchorEl] = React.useState(null)\n    const context = useContext(authContext)\n    const open = Boolean(anchorEl)\n\n    function handleMenu(event) {\n        setAnchorEl(event.currentTarget)\n    }\n\n    function handleClose() {\n        setAnchorEl(null)\n    }\n\n    function handleLogout() {\n        context.logout()\n    }\n\n    return (\n        <div>\n            <Button component={RouterLink} to='/family/create' color='inherit'>\n                Create Family\n            </Button>\n            <Button\n                component={RouterLink}\n                to='/artefacts/manage'\n                color='inherit'\n            >\n                Manage Artefacts\n            </Button>\n            <Button\n                component={RouterLink}\n                to='/artefacts/create'\n                color='inherit'\n            >\n                Create Artefact\n            </Button>\n            <Button component={RouterLink} to='/map/' color='inherit'>\n                Artefact Map\n            </Button>\n            <IconButton\n                aria-label='account of current user'\n                aria-controls='menu-appbar'\n                aria-haspopup='true'\n                onClick={handleMenu}\n                color='inherit'\n            >\n                <AccountCircle />\n            </IconButton>\n            <Menu\n                id='menu-appbar'\n                anchorEl={anchorEl}\n                anchorOrigin={{\n                    vertical: 'top',\n                    horizontal: 'right'\n                }}\n                keepMounted\n                transformOrigin={{\n                    vertical: 'top',\n                    horizontal: 'right'\n                }}\n                open={open}\n                onClose={handleClose}\n            >\n                <MenuItem onClick={handleClose}>Profile</MenuItem>\n                <MenuItem onClick={handleClose}>Settings</MenuItem>\n                <MenuItem onClick={handleLogout}>Logout</MenuItem>\n            </Menu>\n        </div>\n    )\n}\n","import React from 'react';\nimport { Button } from '@material-ui/core';\nimport { Link as RouterLink } from 'react-router-dom';\n\nconst LoginLink = React.forwardRef((props, ref) => (\n    <RouterLink innerRef={ref} to=\"/login\" {...props} />\n));\n\nconst SignupLink = React.forwardRef((props, ref) => (\n    <RouterLink innerRef={ref} to=\"/signup\" {...props} />\n));\n\n\nexport default props => {\n    return (\n        <div>\n            <Button color=\"inherit\" underline=\"none\" component={SignupLink}>Sign up</Button>\n            <Button color=\"inherit\" underline=\"none\" component={LoginLink}>Login</Button>\n        </div>\n    );\n};\n","import React, { useContext } from 'react'\nimport {\n    IconButton,\n    Typography,\n    Toolbar,\n    AppBar,\n    Button,\n    makeStyles,\n    Grid\n} from '@material-ui/core'\nimport MenuIcon from '@material-ui/icons/Menu'\n\nimport Brightness3Icon from '@material-ui/icons/Brightness3'\nimport BrightnessHighIcon from '@material-ui/icons/BrightnessHigh'\n\nimport LoggedInBar from './LoggedInBar'\nimport NotLoggedInBar from './NotLoggedInBar'\nimport { Link as RouterLink } from 'react-router-dom'\nimport { Link } from '@material-ui/core'\nimport { useTheme } from '@material-ui/styles'\n\nimport authContext from '../authContext'\n\nconst useStyles = makeStyles(theme => ({\n    root: {\n        flexGrow: 1\n    },\n    menuButton: {\n        marginRight: theme.spacing(2)\n    },\n    title: {\n        flexGrow: 1,\n        alignText: 'left'\n    }\n}))\n\nexport default function MenuAppBar(props) {\n    const classes = useStyles()\n    const context = useContext(authContext)\n    let loggedIn = context.authenticated\n    let username = null\n    const theme = useTheme()\n    const dark = theme && theme.palette.type === 'dark'\n    return (\n        <div className={classes.root}>\n            <AppBar position='static' color='primary' elevation={6}>\n            {/* <AppBar position='static' color={dark ? 'inherit' : 'primary'} elevation={6}> */}\n                <Toolbar>\n                    <Grid container>\n                        <Grid item xs={2} container>\n                            <Button\n                                fullWidth\n                                component={RouterLink}\n                                to='/'\n                                color='inherit'\n                            >\n                                Home\n                            </Button>\n                        </Grid>\n\n                        <Grid item xs={10} container justify='flex-end' alignItems='center'>\n                            <IconButton\n                                className={classes.menuButton}\n                                color='inherit'\n                                aria-label='menu'\n                                onClick={props.onToggleDarkTheme}\n                            >\n                                {!dark ? (\n                                    <Brightness3Icon />\n                                ) : (\n                                    <BrightnessHighIcon />\n                                )}\n                            </IconButton>\n\n                            {loggedIn && <LoggedInBar username={username} />}\n                            {!loggedIn && <NotLoggedInBar />}\n                        </Grid>\n                    </Grid>\n                </Toolbar>\n            </AppBar>\n        </div>\n    )\n}\n","import React, { useState } from 'react'\nimport { CssBaseline } from '@material-ui/core'\nimport Header from './Header'\n\nimport { createMuiTheme } from '@material-ui/core/styles'\nimport { ThemeProvider } from '@material-ui/styles'\nimport {\n    teal,\n    blue,\n    deepPurple,\n    lightBlue,\n    indigo\n} from '@material-ui/core/colors'\n\nimport { THEME_TYPE } from '../constants.js'\n\nconst lightPalette = {\n    primary: indigo,\n    secondary: {\n        main: teal[400]\n    },\n    type: 'light'\n}\n\nconst darkPalette = {\n    primary: {\n        // light: deepPurple[100],\n        main: deepPurple['A100'],\n        // dark: deepPurple[500]\n    },\n    secondary: teal,\n    error: {\n        main: '#CF6679'\n    },\n    background: {\n        paper: '#303030',\n        default: '#121212'\n    },\n    type: 'dark'\n}\n\nconst lightTheme = createMuiTheme({ palette: lightPalette, type: 'light' })\nconst darkTheme = createMuiTheme({ palette: darkPalette, type: 'dark' })\n\nexport default props => {\n    if (!localStorage.getItem(THEME_TYPE)) {\n        localStorage.setItem(THEME_TYPE, 'light')\n    }\n\n    const [theme, setTheme] = useState(\n        localStorage.getItem(THEME_TYPE) === 'light' ? lightTheme : darkTheme\n    )\n\n    const toggleDarkTheme = () => {\n        var newTheme = theme.palette.type === 'light' ? 'dark' : 'light'\n        localStorage.setItem(THEME_TYPE, newTheme)\n        setTheme(newTheme === 'light' ? lightTheme : darkTheme)\n    }\n\n    return (\n        <ThemeProvider theme={theme}>\n            <CssBaseline />\n            <Header onToggleDarkTheme={toggleDarkTheme} />\n            {props.children}\n        </ThemeProvider>\n    )\n}\n","import React from 'react'\nimport Layout from '../components/Layout'\n\n// NB: REMOVE THE LAYOUT, THIS SHOULD NOT HAVE THE APP BAR, THIS SHOULD BE EXTRA COOL DESIGNED PAGE\nfunction LandingPage(props) {\n    return (\n        <Layout>\n            This is some cool landing page yo. Welcome!\n            <br />\n            Also, in the future, this page should not have a navigation bar,\n            it'll have cooler design stuff. It only has the nav bar for easier\n            linking to signup / login for now\n        </Layout>\n    )\n}\nexport default LandingPage\n","import React, { Component, useContext } from 'react';\nimport { Route, Redirect } from 'react-router-dom';\nimport authContext from '../authContext';\nimport { AUTH_TOKEN } from '../constants';\nimport Loading from './Loading';\nimport LandingPage from '../views/LandingPage';\n\n\nclass WaitWraper extends Component {\n    state = { checkAuthenticated: false }\n    static contextType = authContext;\n\n    componentDidMount() {\n        if (this.context.authenticated) {\n            this.setState({checkAuthenticated: true})\n        }\n        const localToken = localStorage.getItem(AUTH_TOKEN);\n\n        // If there's no token, then they can't have been logged in i.e. checkauthenticated complete\n        if (!this.context.authenticated && localToken) {\n            this.context.handleAuthentication(localToken, () => {\n                console.log(\"Setting state\");\n                this.setState({checkAuthenticated: true})\n            });\n        } else {\n            this.setState({ checkAuthenticated: true })\n        }\n    }\n\n    render() {\n        // Render the children with a function using state as the argument\n        return this.props.children(this.state.checkAuthenticated);\n    }\n}\n\nexport const PrivateRoute = ({loggedIn: LoggedIn, loggedOut, path, landingPage, ...rest}) => {\n    const context = useContext(authContext);\n    const authenticated = context.authenticated;\n\n    if (!loggedOut) {\n        loggedOut = \"/login\"\n    }\n\n    console.log(\"Authenticated: \", authenticated)\n    return (\n        <WaitWraper>\n            {checkAuthenticated => checkAuthenticated === false\n            ? <Loading />\n            : <Route {...rest}\n                render={props => {\n                    if (authenticated) {\n                        return <LoggedIn {...props} />\n                    } else if (!authenticated && landingPage) {\n                        return <LandingPage />;\n                    } else {\n                        return (\n                            <Redirect to={loggedOut} />\n                        )\n                    }\n                }} />\n            }\n        </WaitWraper>\n    )\n}","import React from 'react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport Card from '@material-ui/core/Card'\nimport CardActionArea from '@material-ui/core/CardActionArea'\nimport CardActions from '@material-ui/core/CardActions'\nimport CardContent from '@material-ui/core/CardContent'\nimport CardMedia from '@material-ui/core/CardMedia'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport Grid from '@material-ui/core/Grid'\nimport { Link as RouterLink } from 'react-router-dom'\n\nconst useStyles = makeStyles(theme => ({\n    textField: {\n        // marginLeft: theme.spacing(1),\n        // marginRight: theme.spacing(1),\n        padding: theme.spacing(1),\n        backgroundColor: theme.palette.background.paper,\n        textAlign: 'center',\n        marginTop: theme.spacing(1)\n    },\n    paper: {\n        marginTop: theme.spacing(1),\n        padding: theme.spacing(1),\n        backgroundColor: theme.palette.background.paper,\n        textAlign: 'center'\n    },\n    button: {\n        margin: theme.spacing(1)\n    },\n    card: {\n        backgroundColor: theme.palette.background.paper,\n        maxWidth: 345,\n        borderRadius: 10\n    },\n    media: {\n        backgroundColor: theme.palette.background.paper,\n        height: 140\n    }\n}))\n\n\n/*\nThis component is to present a summary of the artefact to a user, it's used in the homepage\nand manage page as a quick way to assist navigating through artefacts\n*/\nfunction ArtefactCard({ mediaURI, name, description, id }) {\n    const classes = useStyles()\n\n    console.log(\"here's the mediaURI: \" + mediaURI)\n    return (\n        <Card className={classes.card} elevation={3}>\n            <CardActionArea>\n                <CardMedia\n                    className={classes.media}\n                    image={mediaURI}\n                    title={name}\n                />\n                <CardContent>\n                    <Grid item xs zeroMinWidth>\n                        <Typography\n                            gutterBottom\n                            variant='h5'\n                            component='h2'\n                            noWrap\n                        >\n                            {name}\n                        </Typography>\n                    </Grid>\n                    <Grid item xs zeroMinWidth>\n                        <Typography\n                            variant='body2'\n                            color='textSecondary'\n                            component='p'\n                            noWrap\n                        >\n                            {description}\n                        </Typography>\n                    </Grid>\n                </CardContent>\n            </CardActionArea>\n            <CardActions>\n                <Button\n                    size='small'\n                    color='primary'\n                    component={RouterLink}\n                    to={`/artefacts/${id}`}\n                >\n                    View\n                </Button>\n                <Button\n                    size='small'\n                    color='secondary'\n                    component={RouterLink}\n                    to={`/artefacts/edit/${id}`}\n                >\n                    Edit\n                </Button>\n            </CardActions>\n        </Card>\n    )\n}\n\nexport default ArtefactCard\n","import React, { Fragment, useState } from 'react'\nimport ReactMapboxGl, { Marker, Popup } from 'react-mapbox-gl'\nimport { MY_ACCESS_TOKEN } from '../constants'\nimport ArtefactCard from '../components/ArtefactCard'\nimport { useTheme } from '@material-ui/styles'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n    popup: {\n        // color: theme.palette.background.default,\n        // background: theme.palette.background.default,\n        // background: '#000 !important',\n        // color: '#000 !important'\n    }\n}))\n\nconst mapProps = {\n    accessToken: MY_ACCESS_TOKEN,\n    attributionControl: false,\n    maxZoom: 18,\n    minZoom: 2\n}\nconst Mapbox = ReactMapboxGl({\n    ...mapProps,\n    interactive: false\n})\n\nconst InteractiveMapbox = ReactMapboxGl({\n    ...mapProps,\n    interactive: true\n})\n\nexport default function Map(props) {\n    const theme = useTheme()\n    const classes = useStyles()\n    const MapType = props.interactive ? InteractiveMapbox : Mapbox\n    var artefacts = props.artefacts\n    if (!artefacts) artefacts = []\n\n    const [openArtefactID, setOpenArtefactID] = useState('')\n\n    return (\n        <MapType\n            style={\n                props.mapStyle\n                    ? props.mapStyle\n                    : 'mapbox://styles/mapbox/streets-v9?optimize=true'\n            }\n            containerStyle={props.containerStyle}\n            {...props.mapState}\n            onClick={e => setOpenArtefactID('')}\n        >\n            {artefacts.map(artefact => {\n                var { center, popup, initPopupOpen, ...rest } = artefact\n                if (!center || !center.length) {\n                    return\n                }\n                var artefactID = artefact.id\n                return (\n                    <Fragment key={artefactID}>\n                        <Marker\n                            coordinates={center}\n                            onClick={e => {\n                                if (openArtefactID === artefactID) {\n                                    setOpenArtefactID('')\n                                } else {\n                                    setOpenArtefactID(artefactID)\n                                }\n                                if (artefact.initPopupOpen){\n                                    artefact.initPopupOpen = false\n                                }\n                            }}\n                        >\n                            <img\n                                src={\n                                    'http://maps.google.com/mapfiles/ms/icons/red.png'\n                                }\n                                alt='marker-img'\n                            />\n                        </Marker>\n                        {popup &&\n                            (openArtefactID === artefactID ||\n                                initPopupOpen) && (\n                                <Popup\n                                    coordinates={center}\n                                    className={classes.popup}\n                                    offset={{\n                                        'bottom-left': [12, -38],\n                                        bottom: [0, -38],\n                                        'bottom-right': [-12, -38]\n                                    }}\n                                    // style={{color: '#000000'}}\n                                >\n                                    <ArtefactCard {...rest} />\n                                </Popup>\n                            )}\n                    </Fragment>\n                )\n            })}\n        </MapType>\n    )\n}\n","import { MY_ACCESS_TOKEN } from '../constants'\n// import { geocodeQuery } from '.'\nconst mbxGeocoding = require('@mapbox/mapbox-sdk/services/geocoding')\nconst geocodingService = mbxGeocoding({ accessToken: MY_ACCESS_TOKEN })\n\nconst _handleResponse = response => {\n    var out = {}\n    // console.log('GEOCODING RESPONSE: ', response.body)\n    const features = response.body.features\n    if (!features) {\n        out.noResults = true\n        return out\n    }\n    var results = []\n    for (var i = 0; i < features.length; i++) {\n        var feature = features[i]\n        var result = {}\n        result.mapState = { center: feature.center }\n\n        if (feature.place_type[0] === 'place') {\n            const bboxCoords = feature.bbox\n            if (bboxCoords) {\n                const bbox = [\n                    [bboxCoords[0], bboxCoords[1]],\n                    [bboxCoords[2], bboxCoords[3]]\n                ]\n                result.mapState.fitBounds = bbox\n            }\n        } else if (feature.place_type[0] === 'address') {\n            result.mapState.zoom = [15]\n        }\n        result.placeName = feature.place_name\n        result.locationType = feature.place_type[0]\n        results.push(result)\n    }\n    out.results = results\n    return out\n}\n\nconst _handleError = error => {\n    var out = {}\n    console.log('query error occurred')\n    out.error = error\n    return out\n}\n\nexport default function geocodeQuery(query, types) {\n    if (!query) {\n        return new Promise(function(resolve, reject) {\n            resolve()\n        })\n    }\n\n    var args = {\n        query: query,\n        limit: 5,\n    }\n    if (types) args.types = types\n\n    if (typeof query === 'object') {\n        return geocodingService\n            .reverseGeocode(args)\n            .send()\n            .then(\n                response => _handleResponse(response),\n                error => _handleError(error)\n            )\n    } else if (typeof query === 'string') {\n        return geocodingService\n            .forwardGeocode(args)\n            .send()\n            .then(\n                response => _handleResponse(response),\n                error => _handleError(error)\n            )\n    }\n}\n\nexport function artefactGeocodeQuery(artefact) {\n    return geocodeQuery(artefact.address).then(response => {\n        return { artefact: artefact, response: response }\n    })\n}\n","import gql from 'graphql-tag'\n\n// Get the id back to allow for querying for the artefact later\nexport const CREATE_ARTEFACT_MUTATION = gql`\n    mutation CreateArtefactMutation(\n        $name: String!\n        $state: String!\n        $isPublic: Boolean\n        $description: String!\n        $belongsToFamilies: [ID]\n        $address: String\n        $date: String\n    ) {\n        artefactCreate(\n            input: {\n                name: $name\n                state: $state\n                description: $description\n                isPublic: $isPublic\n                belongsToFamilies: $belongsToFamilies\n                address: $address\n                date: $date\n            }\n        ) {\n            artefact {\n                id\n            }\n        }\n    }\n`\n\nexport const CREATE_ARTEFACT_MUTATION_STR = `\nmutation CreateArtefactMutation(\n        $name: String!\n        $state: String!\n        $isPublic: Boolean\n        $description: String!\n        $belongsToFamilies: [ID]\n        $address: String\n        $date: String\n    ) {\n        artefactCreate(\n            input: {\n                name: $name\n                state: $state\n                description: $description\n                isPublic: $isPublic\n                belongsToFamilies: $belongsToFamilies\n                address: $address\n                date: $date\n            }\n        ) {\n            artefact {\n                id\n            }\n        }\n    }\n`\n\nexport const GET_ARTEFACT_STATES_QUERY = gql`\n    query ArtefactStatesQuery($name: String!) {\n        __type(name: $name) {\n            enumValues {\n                name\n                description\n            }\n        }\n    }\n`\n\nexport const GET_FAMILIES_QUERY = gql`\n    query artefactsQuery {\n        me {\n            isMemberOf {\n                familyName\n                id\n            }\n        }\n    }\n`\n\nexport const GET_MY_ID_QUERY = gql`\n    query artefactsQuery {\n        me {\n            id\n        }\n    }\n`\n\nexport const ARTEFACT_DETAIL = gql`\n    query DetailView($id: ID!) {\n        artefact(id: $id) {\n            id\n            name\n            description\n            admin {\n                id\n                username\n            }\n            state\n            isPublic\n            upload\n            belongsToFamilies {\n                id\n            }\n            addedAt\n            address\n            date\n        }\n    }\n`\n\nexport const UPDATE_ARTEFACT_MUTATION = gql`\n    mutation UpdateArtefactMutation(\n        $id: ID!\n        $artefactInput: ArtefactInputType!\n    ) {\n        artefactUpdate(id: $id, input: $artefactInput) {\n            artefact {\n                id\n            }\n        }\n    }\n`\n\nexport const LOGIN_MUTATION = gql`\n    mutation TokenAuth($username: String!, $password: String!) {\n        tokenAuth(username: $username, password: $password) {\n            token\n        }\n    }\n`\n\nexport const GET_FAMILY_ARTEFACTS = gql`\n    query getFamilyArtefacts($id: ID!) {\n        family(id: $id) {\n            hasArtefacts {\n                edges {\n                    node {\n                        id\n                        name\n                        description\n                        address\n                    }\n                }\n            }\n        }\n    }\n`\n\nexport const SIGNUP_MUTATION = gql`\n    mutation SignupMutation(\n        $email: String!\n        $password: String!\n        $username: String!\n    ) {\n        createUser(email: $email, username: $username, password: $password) {\n            user {\n                id\n                username\n                email\n            }\n        }\n    }\n`\n\n// Get the familyName and joinCode back to present to the user straight away after\n// successful creation\nexport const CREATE_FAMILY_MUTATION = gql`\n    mutation FamilyCreate($familyName: String!, $about: String) {\n        familyCreate(input: { familyName: $familyName, about: $about }) {\n            family {\n                familyName\n                joinCode\n            }\n        }\n    }\n`","import React, { useState } from 'react'\nimport { useQuery } from '@apollo/react-hooks'\n\nimport {\n    GET_FAMILIES_QUERY\n} from '../gqlQueriesMutations'\n\nexport default function GetFamiliesWrapper({\n    child: Child,\n    childProps,\n    ...rest\n}) {\n\n    const [families, setFamilies] = useState([])\n    // get users families\n    const { loading } = useQuery(GET_FAMILIES_QUERY, {\n        onCompleted: data => setFamilies(data.me.isMemberOf),\n        onError: error => console.log(error)\n    })\n\n    var thisChildProps = {\n        ...childProps,\n        families: families,\n        familiesLoading: loading\n    }\n\n    return <Child {...rest} {...thisChildProps} />\n}\n","import React, { useState } from 'react'\nimport { useQuery } from '@apollo/react-hooks'\n\nimport { GET_ARTEFACT_STATES_QUERY } from '../gqlQueriesMutations'\n\nexport default function GetStatesWrapper({\n    child: Child,\n    childProps,\n    ...rest\n}) {\n    // get artefact states\n    const [artefactStates, setArtefactStates] = useState({})\n    const _saveArtefactStates = async statesData => {\n        var temp = {}\n        var desc\n        var state\n        for (var i in statesData.__type.enumValues) {\n            state = statesData.__type.enumValues[i]\n            desc = state.description\n            temp[desc] = state.name\n        }\n        setArtefactStates(temp)\n    }\n    const { loading } = useQuery(GET_ARTEFACT_STATES_QUERY, {\n        variables: {\n            name: 'ArtefactState'\n        },\n        onCompleted: _saveArtefactStates,\n        onError: error => console.log(error)\n    })\n\n    var thisChildProps = {\n        ...childProps,\n        artefactStates: artefactStates,\n        statesLoading: loading\n    }\n\n    return <Child {...rest} {...thisChildProps} />\n}\n","import React from 'react'\nimport { useQuery } from '@apollo/react-hooks'\nimport { ARTEFACT_DETAIL } from '../gqlQueriesMutations'\n\nexport default function GetArtefactWrapper({\n    child: Child,\n    childProps,\n    ...rest\n}) {\n    const { data, loading } = useQuery(ARTEFACT_DETAIL, {\n        variables: {\n            id: rest.match.params.id\n        },\n        onError: error => console.error(error)\n    })\n\n    var thisChildProps = {\n        ...childProps,\n        artefactData: data,\n        artefactLoading: loading,\n    }\n\n    return <Child {...rest} {...thisChildProps} />\n}\n","import { makeStyles } from '@material-ui/core/styles'\n\nexport default makeStyles(theme => ({\n    root: {\n        marginLeft: theme.spacing(1),\n        marginRight: theme.spacing(1),\n        margin: theme.spacing(1),\n        borderRadius: 10\n    },\n    paper: {\n        padding: theme.spacing(2),\n        backgroundColor: theme.palette.background.paper,\n        alignItems: 'center',\n        alignContent: 'stretch',\n        justify: 'center',\n        borderRadius: 10\n    },\n    form: {\n        display: 'flex',\n        flexWrap: 'wrap'\n    },\n    submit: {\n        margin: theme.spacing(3, 0, 2)\n    }\n}))","import { makeStyles } from '@material-ui/core/styles'\n\nexport default makeStyles(theme => ({\n    root: {\n        width: '100%',\n        height: '100%',\n        backgroundColor: theme.palette.background.paper,\n        justifyContent: 'center'\n    },\n    formControl: {\n        height: '100%',\n        justifyContent: 'center',\n        textAlign: 'left'\n    },\n    title: {\n        marginLeft: theme.spacing(3),\n        marginRight: theme.spacing(3),\n        padding: theme.spacing(1),\n        textAlign: 'center'\n    },\n    paper: {\n        padding: theme.spacing(1),\n        // textAlign: 'center',\n        backgroundColor: theme.palette.background.paper\n    },\n    paperWrapper: {\n        padding: theme.spacing(1),\n        backgroundColor: theme.palette.background.paper,\n        height: '100%',\n        alignItems: 'center',\n        borderRadius: 10\n    },\n    button: {\n        height: '100%'\n    },\n    map: {\n        height: '200px',\n        type: theme.palette.type\n    },\n    form: {\n        marginBottom: theme.spacing(10),\n        marginTop: theme.spacing(2),\n        display: 'flex',\n        flexWrap: 'wrap',\n        textAlign: 'center'\n    },\n    iconButton: {\n        padding: 10\n    },\n    dropzone: {\n        backgroundColor: theme.palette.background.paper,\n        minHeight: '80px',\n        borderRadius: 10\n    },\n    outerContainer: {\n        spacing: theme.spacing(1),\n        alignItems: 'stretch',\n        alignContent: 'stretch',\n        justifyContent: 'center'\n    }\n}))\n","import React, { useState, useContext } from 'react'\nimport { Link as RouterLink } from 'react-router-dom'\n\nimport {\n    Button,\n    TextField,\n    FormHelperText,\n    Link,\n    Grid,\n    Typography,\n    Paper\n} from '@material-ui/core'\n\nimport { useMutation } from '@apollo/react-hooks'\n\nimport authContext from '../authContext'\nimport { AUTH_TOKEN, INVALID_CRED_ERR_MSG } from '../constants.js'\nimport { Layout, formUseStyles } from '../components'\n\nimport { LOGIN_MUTATION } from '../gqlQueriesMutations'\n\nfunction Login(props) {\n    const context = useContext(authContext)\n    const classes = formUseStyles()\n\n    const [username, setUsername] = useState('')\n    const [password, setPassword] = useState('')\n    const [invalidCred, setInvalidCred] = useState(false)\n    const [unknownError, setUnknownError] = useState(false)\n\n    const _confirm = async data => {\n        const { token } = data.tokenAuth\n        context.handleAuthentication(token)\n        localStorage.setItem(AUTH_TOKEN, token)\n        props.history.push(`/`)\n    }\n\n    const _handleError = async errors => {\n        console.log('_handleError run')\n        if (errors.graphQLErrors) {\n            const subMessage = errors.graphQLErrors[0].message.substring(0, 15)\n            if (INVALID_CRED_ERR_MSG.startsWith(subMessage)) {\n                setInvalidCred(true)\n                console.log('invalid credentials')\n            } else {\n                console.log('unexpect error(s):')\n                console.log(errors)\n                setUnknownError(true)\n            }\n        }\n    }\n\n    const [login] = useMutation(LOGIN_MUTATION, {\n        onCompleted: _confirm,\n        onError: _handleError\n    })\n\n    const submitForm = async event => {\n        login({ variables: { username: username, password: password } })\n        event.preventDefault()\n    }\n\n    return (\n        <Paper className={classes.paper} elevation={6}>\n            <form onSubmit={submitForm} className={classes.form}>\n                <Typography\n                    component='h1'\n                    variant='h5'\n                    className={classes.root}\n                >\n                    Log In\n                </Typography>\n                <TextField\n                    className={classes.root}\n                    variant='outlined'\n                    required\n                    fullWidth\n                    id='username'\n                    label='Username'\n                    autoFocus\n                    onChange={e => setUsername(e.target.value)}\n                    error={invalidCred}\n                />\n                <TextField\n                    className={classes.root}\n                    variant='outlined'\n                    required\n                    fullWidth\n                    label='Password'\n                    type='password'\n                    id='password'\n                    onChange={e => setPassword(e.target.value)}\n                    error={invalidCred}\n                    helperText={invalidCred ? 'Please enter valid credentials' : ''}\n                />\n\n                <Grid\n                    container\n                    justify='center'\n                    alignItems='center'\n                    spacing={3}\n                >\n                    <Grid item xs={6}>\n                        <Button\n                            className={classes.root}\n                            name='submit'\n                            label='Submit'\n                            type='submit'\n                            variant='contained'\n                            color='primary'\n                            fullWidth\n                        >\n                            Log In\n                        </Button>\n\n                        {unknownError && (\n                            <FormHelperText\n                                error={unknownError}\n                                className={classes.root}\n                            >\n                                Unknown Error Occurred\n                            </FormHelperText>\n                        )}\n                    </Grid>\n\n                    <Grid item xs={6}>\n                        <Link\n                            component={RouterLink}\n                            to='/signup'\n                            className={classes.root}\n                            color='inherit'\n                        >\n                            Need an account? Sign up\n                        </Link>\n                    </Grid>\n                </Grid>\n            </form>\n        </Paper>\n    )\n}\n\nexport default props => (\n    <Layout>\n        <Grid\n            container\n            spacing={0}\n            direction='column'\n            alignItems='center'\n            justify='center'\n            style={{ minHeight: '80vh' }}\n        >\n            <Grid item xs={10} sm={8} md={6} lg={4}>\n                <Login {...props} />\n            </Grid>\n        </Grid>\n    </Layout>\n)\n","var passwordValidator = require('password-validator');\n\n// Create a schema\nexport var PASSWORD_SCHEMA = new passwordValidator();\n\nconst min_len = 6\nconst max_len = 100\n\n// NOTE: for every rule added to the Schema, a corresponding parsing conditional should be added below\nPASSWORD_SCHEMA\n    .is().min(min_len)                                    // Minimum length 8\n    .is().max(max_len)                                  // Maximum length 100\n    .has().uppercase()                              // Must have uppercase letters\n    .has().digits()                                 // Must have digits\n    .is().not().oneOf(['password', 'Password123']); // Blacklist these values\n    // .has().lowercase()                              // Must have lowercase letters\n    // .has().not().spaces()                           // Should not have spaces\n\nexport const parseFailedRules = (rules) => {\n    var output = ''\n    for (var i=0; i < rules.length; i++){\n        if (i >=1) output += \" | \"\n        \n        var rule = rules[i]\n        if (rule === 'min'){\n            output += `Password must be at least ${min_len} characters long`\n        }\n        if (rule === 'max') {\n            output += `Password must be at most ${max_len} characters long`\n        }\n        if (rule === 'uppercase') {\n            output += `Password must have an uppercase letter`\n        }\n        if (rule === 'digits') {\n            output += `Password must have a digit`\n        }\n        if (rule === 'oneOf') {\n            output += `Password is too common`\n        }\n    }\n    return output\n}","import React, { useState } from 'react'\nimport { Link as RouterLink } from 'react-router-dom'\n\nimport {\n    Button,\n    TextField,\n    FormHelperText,\n    Link,\n    Grid,\n    Typography,\n    Paper\n} from '@material-ui/core'\n\nimport { useMutation } from '@apollo/react-hooks'\n\nimport { Layout, formUseStyles } from '../components'\nimport { USERNAME_TAKEN_ERR_MSG } from '../constants.js'\nimport {\n    PASSWORD_SCHEMA,\n    parseFailedRules\n} from '../components/passwordValidator.js'\n\nimport { SIGNUP_MUTATION } from '../gqlQueriesMutations'\n\nfunction Signup(props) {\n    const [username, setUsername] = useState('')\n    const [email, setEmail] = useState('')\n    const [password, setPassword] = useState('')\n    const [confirmPassword, setConfirmPassword] = useState('')\n    const [usernameIsTaken, setUsernameIsTaken] = useState(false)\n    const [emailIsTaken, setEmailIsTaken] = useState(false)\n    const [validPassword, setValidPassword] = useState(false)\n    const [failedPassRules, setFailedPassRules] = useState([])\n    const [unknownError, setUnknownError] = useState(false)\n\n    var emailValidator = require('email-validator')\n\n    const classes = formUseStyles()\n    const _confirm = async data => {\n        // handle signup errors and potentially login\n        props.history.push(`/login`)\n    }\n\n    const _handleError = async errors => {\n        console.log('_handleError run')\n        if (errors.graphQLErrors) {\n            const subMessage = errors.graphQLErrors[0].message.substring(0, 10)\n            if (USERNAME_TAKEN_ERR_MSG.startsWith(subMessage)) {\n                setUsernameIsTaken(true)\n            } else {\n                console.log('unexpect error(s):')\n                console.log(errors)\n                setUnknownError(true)\n            }\n        }\n    }\n\n    const [signup] = useMutation(SIGNUP_MUTATION, {\n        onCompleted: _confirm,\n        onError: _handleError\n    })\n\n    const submitForm = async event => {\n        event.preventDefault()\n        console.log('form submitted')\n        signup({\n            variables: { username: username, email: email, password: password }\n        })\n    }\n\n    const changePassword = async pass => {\n        setPassword(pass)\n\n        // password validation\n        var failedRules = PASSWORD_SCHEMA.validate(pass, { list: true })\n        setFailedPassRules(failedRules)\n        if (failedRules.length !== 0) {\n            setValidPassword(false)\n        } else {\n            setValidPassword(true)\n        }\n    }\n\n    const errorPassword = !!password && !validPassword\n    const errorConfirmPassword =\n        !!confirmPassword && !(confirmPassword === password)\n\n    const disableSubmit =\n        (!!password && (!(confirmPassword === password) || !validPassword)) ||\n        (!!email && !emailValidator.validate(email))\n\n    const invalidEmail = !!email && !emailValidator.validate(email)\n    const emailError = emailIsTaken || invalidEmail\n    var emailErrMsg = ''\n    if (invalidEmail) {\n        emailErrMsg = 'Email is invalid'\n    } else if (emailIsTaken) {\n        emailErrMsg = 'Email is taken'\n    }\n\n    return (\n        <Paper className={classes.paper} elevation={6}>\n            <form className={classes.form} onSubmit={submitForm}>\n                <Typography\n                    component='h1'\n                    variant='h5'\n                    className={classes.root}\n                >\n                    Sign up\n                </Typography>\n\n                <TextField\n                    className={classes.root}\n                    onChange={e => setUsername(e.target.value)}\n                    variant='outlined'\n                    required\n                    fullWidth\n                    autoComplete='username'\n                    label='Username'\n                    type='username'\n                    autoFocus\n                    error={usernameIsTaken}\n                    helperText={usernameIsTaken ? 'Username is taken' : ''}\n                />\n\n                <TextField\n                    className={classes.root}\n                    variant='outlined'\n                    required\n                    fullWidth\n                    autoComplete='email'\n                    label='Email'\n                    type='email'\n                    onChange={e => setEmail(e.target.value)}\n                    error={emailError}\n                    helperText={emailErrMsg}\n                />\n\n                <TextField\n                    className={classes.root}\n                    variant='outlined'\n                    required\n                    fullWidth\n                    autoComplete='password'\n                    label='Password'\n                    type='password'\n                    onChange={e => changePassword(e.target.value)}\n                    error={errorPassword}\n                    helperText={\n                        errorPassword ? parseFailedRules(failedPassRules) : ''\n                    }\n                />\n\n                <TextField\n                    className={classes.root}\n                    variant='outlined'\n                    required\n                    fullWidth\n                    label='Confirm Password'\n                    type='password'\n                    onChange={e => setConfirmPassword(e.target.value)}\n                    error={errorConfirmPassword}\n                    helperText={\n                        errorConfirmPassword ? 'Passwords must match' : ''\n                    }\n                />\n\n                <Grid\n                    container\n                    justify='center'\n                    alignItems='center'\n                    spacing={3}\n                >\n                    <Grid item xs={6}>\n                        <Button\n                            className={classes.root}\n                            fullWidth\n                            label='Submit'\n                            type='submit'\n                            variant='contained'\n                            color='primary'\n                            disabled={disableSubmit}\n                        >\n                            Sign Up\n                        </Button>\n                        {unknownError && (\n                            <FormHelperText\n                                error={unknownError}\n                            ></FormHelperText>\n                        )}\n                    </Grid>\n\n                    <Grid item xs={6}>\n                        <Link\n                            className={classes.root}\n                            component={RouterLink}\n                            to='/login'\n                            color='inherit'\n                        >\n                            Already have an account? Log in\n                        </Link>\n                    </Grid>\n                </Grid>\n            </form>\n        </Paper>\n    )\n}\n\nexport default props => (\n    <Layout>\n        <Grid\n            container\n            spacing={0}\n            direction='column'\n            alignItems='center'\n            justify='center'\n            style={{ minHeight: '80vh' }}\n        >\n            <Grid item xs={10} sm={8} md={6} lg={4}>\n                <Signup {...props} />\n            </Grid>\n        </Grid>\n    </Layout>\n)\n","import React, { useContext } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport authContext from '../authContext';\n\nfunction Logout() {\n    const context = useContext(authContext);\n    context.logout();\n\n    return (\n        <Redirect to='/login' />\n    );\n}\n\nexport default Logout;\n","import React, { useContext, useState } from 'react'\nimport {\n    IconButton,\n    Button,\n    CssBaseline,\n    TextField,\n    Typography,\n    Dialog,\n    DialogTitle,\n    DialogContent,\n    Grid,\n    Paper,\n    FormControl\n} from '@material-ui/core'\nimport CloseIcon from '@material-ui/icons/Close'\n\nimport { useMutation } from '@apollo/react-hooks'\n\nimport Layout from '../components/Layout'\nimport authContext from '../authContext'\nimport { artefactFamilyFormUseStyles } from '../components'\nimport { CREATE_FAMILY_MUTATION } from '../gqlQueriesMutations'\n\nconst MyDialogTitle = props => {\n    const classes = artefactFamilyFormUseStyles()\n    const { children, onClose } = props\n\n    return (\n        <DialogTitle disableTypography className={classes.root}>\n            <Typography variant='h6'>{children}</Typography>\n            {onClose ? (\n                <IconButton\n                    aria-label='close'\n                    className={classes.closeButton}\n                    onClick={onClose}\n                >\n                    <CloseIcon />\n                </IconButton>\n            ) : null}\n        </DialogTitle>\n    )\n}\n\nfunction CreateFamilyView(props) {\n    const classes = artefactFamilyFormUseStyles()\n\n    const context = useContext(authContext)\n    const username = context.user.username\n\n    const [familyName, setFamilyName] = useState('')\n    const [about, setAbout] = useState('')\n    const [joinCode, setJoinCode] = useState('')\n    const [open, setOpen] = useState(false)\n\n    const _completed = async data => {\n        console.log(data)\n        const { joinCode } = data.familyCreate.family\n        setJoinCode(joinCode)\n        setOpen(true)\n    }\n\n    const [createFamily, { data }] = useMutation(CREATE_FAMILY_MUTATION, {\n        onCompleted: _completed\n    })\n\n    const submitForm = async event => {\n        event.preventDefault()\n        console.log('Family name: ' + familyName)\n        console.log('About: ' + about)\n        createFamily({\n            variables: {\n                familyName: familyName,\n                about: about\n            }\n        })\n    }\n\n    const handleClose = event => {\n        event.preventDefault()\n        setOpen(false)\n    }\n\n    return (\n        <form className={classes.form} onSubmit={submitForm}>\n            <Grid\n                container\n                spacing={1}\n                className={classes.outerContainer}\n                spacing={1}\n            >\n                <Grid item xs={12} container justify='center'>\n                    <Typography variant='h4' className={classes.title}>\n                        Create Family\n                    </Typography>\n\n                    <Typography variant='subtitle1' className={classes.title}>\n                        Families are how you manage your artefacts. We recognise\n                        there is often complex overlap between families. That's\n                        why you can create and be a part of several families, so\n                        you can separate which of the artefacts you manage\n                        belong to which family.\n                    </Typography>\n                </Grid>\n\n                <Grid item xs={12}>\n                    <Paper className={classes.paperWrapper} elevation={3}>\n                        <FormControl className={classes.formControl} fullWidth>\n                            <TextField\n                                variant='outlined'\n                                required\n                                fullWidth\n                                id='family-name'\n                                label='Family name'\n                                autoFocus\n                                onChange={e => setFamilyName(e.target.value)}\n                            />\n                        </FormControl>\n                    </Paper>\n                </Grid>\n                <Grid item xs={12}>\n                    <Paper className={classes.paperWrapper} elevation={3}>\n                        <FormControl className={classes.formControl} fullWidth>\n                            <TextField\n                                variant='outlined'\n                                multiline\n                                rows={6}\n                                fullWidth\n                                id='about'\n                                label='Tell people about your family'\n                                onChange={e => setAbout(e.target.value)}\n                            />\n                        </FormControl>\n                    </Paper>\n                </Grid>\n\n                <Grid item xs={12}>\n                    <Paper className={classes.paperWrapper} elevation={3}>\n                        <FormControl className={classes.formControl} fullWidth>\n                            <TextField\n                                variant='outlined'\n                                disabled\n                                defaultValue={username}\n                                fullWidth\n                                id='family-admin'\n                                label='Family Admin'\n                                onChange={e => console.log('hello')}\n                            />\n                        </FormControl>\n                    </Paper>\n                </Grid>\n\n                <Grid item xs={5}>\n                    <Button\n                        name='create'\n                        label='Create'\n                        type='submit'\n                        fullWidth\n                        variant='contained'\n                        color='primary'\n                    >\n                        Create\n                    </Button>\n                </Grid>\n            </Grid>\n            {data && (\n                <Dialog open={open} onClose={handleClose}>\n                    <MyDialogTitle onClose={handleClose}>\n                        Begin adding members to '{familyName}'!\n                    </MyDialogTitle>\n                    <DialogContent>\n                        <Typography align='center'>\n                            Begin getting members to join your family! Simply\n                            share the code below to your family members, get\n                            them to sign up and then they can join!\n                            <br />\n                            {joinCode}\n                        </Typography>\n                    </DialogContent>\n                </Dialog>\n            )}\n        </form>\n    )\n}\n\nexport default props => (\n    <Layout>\n        <CssBaseline />\n        <Grid\n            container\n            spacing={0}\n            direction='column'\n            alignItems='center'\n            justify='center'\n            style={{ minHeight: '80vh' }}\n        >\n            <Grid item xs={6}>\n                <CreateFamilyView {...props} />\n            </Grid>\n        </Grid>\n    </Layout>\n)\n","import React from 'react'\nimport { Grid, Typography } from '@material-ui/core'\n\nexport default ({ mode, classes }) => {\n    var {create, edit, view} = mode\n    return (\n        <Grid item xs={12} sm={8}>\n            <Typography variant='h4' className={classes.title}>\n                {create && 'Create'} {edit && 'Edit'} {view && 'View'} Artefact\n            </Typography>\n            {!view && (\n                <Typography variant='subtitle1' className={classes.title}>\n                    {create &&\n                        'Artefacts are belongings of the family, enter as much or as little detail as you like'}\n                    {edit && 'Click to start editing'}\n                </Typography>\n            )}\n        </Grid>\n    )\n}\n","import React from 'react'\nimport { TextField } from '@material-ui/core'\n\nexport default ({ mode, states, setters, disabled, name }) => {\n    var { view } = mode\n    var { state } = states\n    var { handleSetField } = setters\n    return (\n        <TextField\n            // style={{ height: '100%' }}\n            // InputProps={{ style: {height: '100%'} }}\n            id='artefact-name'\n            label='Artefact name'\n            variant='outlined'\n            autoFocus={!view}\n            required\n            fullWidth\n            value={state.name || ''}\n            inputProps={{\n                readOnly: view\n            }}\n            onChange={e => handleSetField(name, e.target.value)}\n            disabled={disabled}\n        />\n    )\n}\n","import React from 'react'\nimport { TextField, MenuItem } from '@material-ui/core'\n\nexport default ({ mode, states, setters, artefactStates, disabled, name }) => {\n    var { view } = mode\n    var { state } = states\n    var { handleSetField } = setters\n    return (\n        <TextField\n            id='state'\n            label='Artefact State'\n            variant='outlined'\n            required\n            fullWidth\n            value={state.state || ''}\n            inputProps={{\n                readOnly: view\n            }}\n            onChange={e => handleSetField(name, e.target.value)}\n            select\n            disabled={disabled}\n        >\n            {Object.keys(artefactStates).map(value => {\n                return (\n                    <MenuItem value={artefactStates[value]} key={value}>\n                        {value}\n                    </MenuItem>\n                )\n            })}\n        </TextField>\n    )\n}\n","import React from 'react'\nimport { TextField } from '@material-ui/core'\n\nexport default ({ mode, states, setters, disabled, name }) => {\n    var { view } = mode\n    var { state } = states\n    var { handleSetField } = setters\n    return (\n        <TextField\n            id='description'\n            label='Description'\n            variant='outlined'\n            required\n            fullWidth\n            multiline\n            rows={6}\n            value={state.description || ''}\n            inputProps={{\n                readOnly: view\n            }}\n            onChange={e => handleSetField(name, e.target.value)}\n            disabled={disabled}\n        />\n    )\n}\n","import React from 'react'\nimport { TextField } from '@material-ui/core'\n\nexport default ({ mode, states, username }) => {\n    var { view } = mode\n    var { state } = states\n    return (\n        <TextField\n            id='artefact-admin'\n            label='Artefact Admin'\n            variant='outlined'\n            required\n            fullWidth\n            value={\n                state.admin && Object.keys(state.admin).length !== 0\n                    ? state.admin.username\n                    : username\n            }\n            inputProps={{\n                readOnly: view\n            }}\n            onChange={e => console.log('admin field was changed')}\n            disabled\n        />\n    )\n}\n","import React from 'react'\n\nimport 'date-fns'\nimport { KeyboardDatePicker } from '@material-ui/pickers'\n\nexport default ({ mode, states, setters, disabled, name }) => {\n    var { view } = mode\n    var { state } = states\n    var { handleSetField } = setters\n    return (\n        <KeyboardDatePicker\n            disabled={view || disabled}\n            clearable\n            // variant='inline'\n            inputVariant='outlined'\n            format='dd/MM/yyyy'\n            openTo='year'\n            label='Date'\n            value={state.date}\n            onChange={date => handleSetField(name, date)}\n            KeyboardButtonProps={{\n                'aria-label': 'change date'\n            }}\n        />\n    )\n}\n","import React from 'react'\nimport {\n    List,\n    ListSubheader,\n    ListItem,\n    Checkbox,\n    ListItemIcon,\n    ListItemText\n} from '@material-ui/core'\n\nexport default ({ mode, states, setters, disabled, name }) => {\n    var { view } = mode\n    var { state } = states\n    var { handleSetField } = setters\n    return (\n        <List\n            subheader={<ListSubheader component='div'>Privacy</ListSubheader>}\n            dense\n        >\n            <ListItem disabled={disabled}>\n                {!view && (\n                    <ListItemIcon>\n                        <Checkbox\n                            edge='start'\n                            checked={state.isPublic || false}\n                            tabIndex={-1}\n                            onClick={e =>\n                                handleSetField(name, e.target.checked)\n                            }\n                        />\n                    </ListItemIcon>\n                )}\n                <ListItemText primary={'Public'} />\n            </ListItem>\n        </List>\n    )\n}\n","import React from 'react'\nimport {\n    List,\n    ListSubheader,\n    ListItem,\n    Checkbox,\n    ListItemIcon,\n    ListItemText\n} from '@material-ui/core'\n\nexport default ({ mode, states, setters, families, disabled, name }) => {\n    var { view } = mode\n    var { state } = states\n    var { handleSetField } = setters\n    return (\n        <List\n            subheader={\n                <ListSubheader component='div'>\n                    {!view\n                        ? 'Select which of your families the artefact belongs to'\n                        : 'Belongs to'}\n                </ListSubheader>\n            }\n        >\n            {families.map(family => {\n                if (\n                    state.belongsToFamiliesBools &&\n                    (!view || state.belongsToFamiliesBools[family.id])\n                ) {\n                    return (\n                        <ListItem key={family.id} dense disabled={disabled}>\n                            {!view && (\n                                <ListItemIcon>\n                                    <Checkbox\n                                        edge='start'\n                                        checked={\n                                            state.belongsToFamiliesBools[\n                                                family.id\n                                            ] || false\n                                        }\n                                        onClick={e =>\n                                            handleSetField(name, {\n                                                ...state.belongsToFamiliesBools,\n                                                [family.id]: e.target.checked\n                                            })\n                                        }\n                                        tabIndex={-1}\n                                    />\n                                </ListItemIcon>\n                            )}\n                            <ListItemText primary={family.familyName} />\n                        </ListItem>\n                    )\n                }\n                return null\n            })}\n        </List>\n    )\n}\n","import React from 'react'\nimport { DropzoneArea } from 'material-ui-dropzone'\n\nexport default ({ mode, classes, states, setters, disabled, name }) => {\n    var { view } = mode\n    var { state } = states\n    var { handleSetField } = setters\n    return (\n        <DropzoneArea\n            initialFiles={state.files || []}\n            onChange={files => handleSetField(name, files)}\n            dropzoneClass={classes.dropzone}\n        />\n    )\n}\n","import React, { Fragment } from 'react'\nimport {\n    TextField,\n    Grid,\n    IconButton,\n    Popover,\n    List,\n    ListItem,\n    ListItemText,\n} from '@material-ui/core'\nimport { useTheme } from '@material-ui/styles'\nimport SearchIcon from '@material-ui/icons/Search'\nimport { Map } from '../../../components'\n\nexport default ({\n    mode,\n    states,\n    setters,\n    classes,\n    name,\n    handleGeocodeQuery\n}) => {\n    var { view } = mode\n    var {\n        handleSetField,\n        setAddressIsSearchResult,\n        setLocationState,\n        handleSetLocationResult\n    } = setters\n    var { locationState, state } = states\n\n    const theme = useTheme()\n    var mapStyle\n    if (theme && theme.palette.type === 'dark') {\n        mapStyle = 'mapbox://styles/mapbox/dark-v10?optimize=true'\n    } else {\n        mapStyle = 'mapbox://styles/mapbox/streets-v9?optimize=true'\n    }\n\n    return (\n        <Fragment>\n            <TextField\n                id='address'\n                label='Address'\n                variant='outlined'\n                fullWidth\n                value={state.address || ''}\n                inputProps={{\n                    readOnly: view\n                }}\n                onChange={e => {\n                    handleSetField(name, e.target.value)\n                    if (e.target.value) {\n                        setAddressIsSearchResult(false)\n                    } else {\n                        // allow blank address\n                        setAddressIsSearchResult(true)\n                    }\n                }}\n                error={!!locationState.error}\n                InputProps={{\n                    endAdornment: !view && (\n                        <IconButton\n                            className={classes.iconButton}\n                            aria-label='search'\n                            id='search'\n                            onClick={e =>\n                                handleGeocodeQuery({\n                                    query: state.address,\n                                    initial: false\n                                })\n                            }\n                        >\n                            <SearchIcon />\n                        </IconButton>\n                    ),\n                    style: { marginBottom: 3 }\n                }}\n                onKeyDown={e => {\n                    if (e.keyCode === 13 && !view) {\n                        e.preventDefault()\n                        document.getElementById('search').click()\n                    }\n                }}\n                helperText={locationState.error}\n            />\n            <Popover\n                id={locationState.queryResults.length ? 'results' : undefined}\n                open={!!locationState.queryResults.length}\n                anchorEl={document.getElementById('address')}\n                onClose={e =>\n                    setLocationState({\n                        ...locationState,\n                        queryResults: []\n                    })\n                }\n                anchorOrigin={{\n                    vertical: 'bottom',\n                    horizontal: 'left'\n                }}\n                transformOrigin={{\n                    vertical: 'top',\n                    horizontal: 'left'\n                }}\n            >\n                <List component='div' disablePadding>\n                    {locationState.queryResults.map(result => (\n                        <ListItem\n                            key={result.placeName}\n                            button\n                            className={classes.nested}\n                            onClick={e => handleSetLocationResult(result)}\n                        >\n                            <ListItemText primary={result.placeName} />\n                        </ListItem>\n                    ))}\n                </List>\n            </Popover>\n\n            <Grid container style={{ marginTop: 1 }}>\n                <Map\n                    interactive={false}\n                    className={classes.map}\n                    mapState={locationState.mapState}\n                    mapStyle={mapStyle}\n                    containerStyle={{\n                        height: '60vh',\n                        width: '100vw',\n                        borderRadius: 20,\n                        marginTop: 5\n                    }}\n                    artefacts={[\n                        {\n                            center: locationState.mapState.center\n                        }\n                    ]}\n                />\n            </Grid>\n        </Fragment>\n    )\n}\n","import React from 'react'\nimport { Button, Grid, FormHelperText } from '@material-ui/core'\n\nexport default ({ save, cancel, updateErrors, classes }) => {\n    function MyButton(props) {\n        return (\n            <Button\n                variant='contained'\n                color={props.color}\n                className={classes.button}\n                onClick={props.onClick}\n                fullWidth\n                padding={1}\n            >\n                {props.name}\n            </Button>\n        )\n    }\n\n    return (\n        <Grid\n            container\n            justify='space-evenly'\n            alignItems='center'\n            spacing={1}\n            style={{ marginTop: 1 }}\n        >\n            <Grid item xs={6}>\n                <MyButton onClick={save} name='Save' color='primary' />\n            </Grid>\n            <Grid item xs={6}>\n                <MyButton\n                    onClick={cancel}\n                    name='Cancel'\n                    color='secondary'\n                />\n            </Grid>\n\n            {updateErrors && (\n                <Grid item xs={12}>\n                    <FormHelperText error>\n                        Error Updating Artefact\n                    </FormHelperText>\n                </Grid>\n            )}\n        </Grid>\n    )\n}\n","import React from 'react'\nimport { Grid, FormControl, Paper } from '@material-ui/core'\nimport EditButtons from './EditButtons'\n\nexport default ({\n    child: Child,\n    childProps,\n    name,\n    classes,\n    editButtonProps\n}) => {\n    var { beingEdited, mode } = childProps\n    var { edit } = mode\n    var thisBeingEdited = beingEdited === name\n    var someBeingEdited = edit && !!beingEdited\n    return (\n        <Grid item xs={12}>\n            <Paper className={classes.paperWrapper} elevation={3}>\n                <FormControl className={classes.formControl} fullWidth>\n                    <Child\n                        {...childProps}\n                        disabled={someBeingEdited && !thisBeingEdited}\n                        name={name}\n                    />\n\n                    {thisBeingEdited && <EditButtons {...editButtonProps} />}\n                </FormControl>\n            </Paper>\n        </Grid>\n    )\n}\n","import React from 'react'\nimport {\n    Button,\n    CssBaseline,\n    Grid,\n    Snackbar,\n    IconButton,\n    FormHelperText,\n    ClickAwayListener\n} from '@material-ui/core'\nimport CloseIcon from '@material-ui/icons/Close'\n\nexport default ({ open, setOpen, viewArtefact, classes, id }) => {\n    return (\n        <ClickAwayListener onClickAway={() => setOpen(false)}>\n            <Snackbar\n                anchorOrigin={{\n                    vertical: 'bottom',\n                    horizontal: 'left'\n                }}\n                open={open}\n                autoHideDuration={2000}\n                onClose={() => setOpen(false)}\n                ContentProps={{\n                    'aria-describedby': 'message-id'\n                }}\n                message={<span id='message-id'>Edit successful</span>}\n                action={[\n                    <Button\n                        key='view'\n                        color='secondary'\n                        size='small'\n                        onClick={e => viewArtefact(id)}\n                    >\n                        VIEW\n                    </Button>,\n                    <IconButton\n                        key='close'\n                        aria-label='close'\n                        color='inherit'\n                        onClick={() => setOpen(false)}\n                        className={classes.close}\n                    >\n                        <CloseIcon />\n                    </IconButton>\n                ]}\n            />\n        </ClickAwayListener>\n    )\n}\n","import React, { Fragment } from 'react'\n\nimport { Button, FormHelperText } from '@material-ui/core'\n\nexport default ({ noErrors }) => (\n    <Fragment>\n        <Button\n            name='create'\n            label='Create'\n            type='submit'\n            fullWidth\n            variant='contained'\n            color='primary'\n        >\n            Create\n        </Button>\n        {!noErrors && (\n            <FormHelperText error={!noErrors}>\n                Unknown Error Occurred\n            </FormHelperText>\n        )}\n    </Fragment>\n)\n","import React, { useContext, useState } from 'react'\nimport { withRouter } from 'react-router-dom'\nimport { useMutation } from '@apollo/react-hooks'\n\nimport { CssBaseline, Grid } from '@material-ui/core'\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers'\n\nimport DateFnsUtils from '@date-io/date-fns'\n\nimport {\n    Loading,\n    geocodeQuery,\n    artefactFamilyFormUseStyles\n} from '../../components'\n\nimport {\n    Title,\n    Name,\n    State,\n    Description,\n    Admin,\n    Date,\n    Privacy,\n    Families,\n    Images,\n    FieldWrapper,\n    Address,\n    SuccessSnackbar,\n    CreateButton\n} from './components'\nimport authContext from '../../authContext'\n\nimport { Layout } from '../../components'\n\nimport {\n    CREATE_ARTEFACT_MUTATION_STR,\n    UPDATE_ARTEFACT_MUTATION\n} from '../../gqlQueriesMutations'\n\nimport { AUTH_TOKEN, config } from '../../constants'\nimport axios from 'axios'\n\nfunction ArtefactView(props) {\n    // get the mode\n    var { create, edit, view } = props\n    var mode = { create: create, edit: edit, view: view }\n\n    // get families, states, and artefact data\n    var { statesLoading, familiesLoading, artefactLoading } = props\n    var { artefactStates, families } = props\n\n    // if viewing an existing artefact get the details (potentially unloaded)\n    const context = useContext(authContext)\n    const username = context.user.username\n    let creationErrors, creationLoading\n\n    if (!create) {\n        var artefact = !artefactLoading ? props.artefactData.artefact : {}\n        var isAdmin = !artefactLoading\n            ? artefact.admin.username === username\n            : false\n    }\n\n    // only allow admins to see the edit page\n    if (!isAdmin && edit) {\n        edit = false\n        view = true\n    }\n\n    const classes = artefactFamilyFormUseStyles()\n\n    // state variables for use in the \"edit\" mode:\n    // the name of the field being edited, for use in the \"edit\" mode\n    const [beingEdited, setBeingEdited] = useState('')\n    // the value of the field being edited before it was changed\n    const [prevValue, setPrevValue] = useState({})\n    // a message indicating successful edit\n    const [snackbarOpen, setSnackbarOpen] = useState(false)\n\n    // state variables for the map\n    const [locationState, setLocationState] = useState({\n        mapState: {},\n        prevMapState: {},\n        error: '',\n        queryResults: []\n    })\n    // the address field of the main state object must be a query result on submit\n    const [addressIsSearchResult, setAddressIsSearchResult] = useState(true)\n\n    // makes a geocode query and sets the map's state accordingly\n    // <inital> intended for use on loading in an artefact in edit or view mode\n    // if <initial> is true then it will set the map to the first\n    // result of the query rather than presenting query results\n    const handleGeocodeQuery = ({ query, initial }) => {\n        if (query) {\n            console.log('Query run with argument: ', query)\n            return geocodeQuery(query).then(response => {\n                var newState = {}\n                if (response.noErrors) {\n                    newState.error = 'No results'\n                } else if (response.error) {\n                    newState.error =\n                        'Unknown error occurred, check console for details'\n                    console.log(response.error)\n                }\n\n                if (initial) {\n                    newState.mapState = response.results[0].mapState\n                    setAddressIsSearchResult(true)\n                } else {\n                    newState.queryResults = response.results\n                }\n                setLocationState({\n                    ...locationState,\n                    ...newState\n                })\n            })\n        }\n    }\n\n    // state object for the input fields, GQL mutation variables taken from this\n    const [state, setState] = useState({})\n    // if in edit or view mode load in the data for the artefact into the state\n    // only if the artefact has loaded and this hasn't already run\n    if (\n        (edit || view) &&\n        !artefactLoading &&\n        Object.keys(state).length === 0 &&\n        families\n    ) {\n        var belong = {}\n        families.map(val => (belong[val.id] = false))\n        artefact.belongsToFamilies.map(val => (belong[val.id] = true))\n\n        setState({\n            ...artefact,\n            belongsToFamiliesBools: belong\n        })\n        handleGeocodeQuery({ query: artefact.address, initial: true })\n    }\n\n    // if in create mode, initialise the booleans for the family checkboxes to false\n    if (create && families && !state.belongsToFamiliesBools) {\n        var belong = {}\n        families.map(val => (belong[val.id] = false))\n\n        setState({ belongsToFamiliesBools: belong, date: null })\n    }\n\n    // handler for setting the state object\n    const handleSetField = (fieldName, value) => {\n        if (edit && beingEdited !== fieldName) {\n            setBeingEdited(fieldName)\n            setPrevValue(state[fieldName])\n        }\n        setState({\n            ...state,\n            [fieldName]: value\n        })\n    }\n\n    // handler for setting the map state when a user selects a location result\n    const handleSetLocationResult = result => {\n        var newLocationState = {\n            mapState: result.mapState,\n            error: '',\n            queryResults: []\n        }\n        if (beingEdited === 'address' && !locationState.prevMapState) {\n            newLocationState.prevMapState = locationState.mapState\n        }\n        handleSetField('address', result.placeName)\n\n        setLocationState({\n            ...locationState,\n            ...newLocationState\n        })\n        setAddressIsSearchResult(true)\n    }\n\n    // reset the map to before the location was edited\n    const resetMapToPrevState = () => {\n        setLocationState({\n            ...locationState,\n            mapState: locationState.prevMapState,\n            queryResults: [],\n            prevMapState: {}\n        })\n    }\n\n    // reset the field being edited\n    const cancelEditing = () => {\n        handleSetField(beingEdited, prevValue)\n        setBeingEdited('')\n\n        if (beingEdited === 'address') {\n            resetMapToPrevState()\n        }\n    }\n\n    // handle an edited but not finalised search field on submit\n    const handleUnselectedSearchField = () => {\n        setLocationState({\n            ...locationState,\n            error: 'Select a search result or clear search field before saving'\n        })\n    }\n\n    // send user to view the specified artefact\n    const pushViewArtefactURL = id => {\n        const { history } = props\n        if (history) {\n            history.push(`/artefacts/${id}`)\n        }\n    }\n\n    // handlers for GQL mutations\n    const handleCreationCompleted = data => {\n        console.log(\"here's the data\")\n        console.log(data)\n        var id = data.data.artefactCreate.artefact.id\n        pushViewArtefactURL(id)\n    }\n    const updateCompleted = async data => {\n        setBeingEdited('')\n        setSnackbarOpen(true)\n    }\n    const handleCreationError = async errors => {\n        console.error('Creation errors occurred:', errors)\n    }\n    const handleUpdateError = async errors => {\n        console.error('Update errors occured: ', errors)\n    }\n\n    const createArtefact = async (\n        variables,\n        successCallback,\n        errorCallback\n    ) => {\n        console.log(\"here's input from call\")\n        console.log(variables)\n        // const input = \"hello\"\n        let form_data = new FormData()\n        // Image not passed through by variables\n        if (state.files && state.files.length) {\n            form_data.append('itemImage', state.files[0])\n        }\n        form_data.append('query', CREATE_ARTEFACT_MUTATION_STR)\n        form_data.append('variables', JSON.stringify(variables))\n        let url = config.uri\n        axios\n            .post(url, form_data, {\n                headers: {\n                    Authorization: 'JWT ' + localStorage.getItem(AUTH_TOKEN),\n                    'Content-Type': 'application/x-www-form-urlencoded',\n                    'Content-Transfer-Encoding': 'multipart/form-data'\n                }\n            })\n            .then(res => {\n                successCallback(res.data)\n            })\n            .catch(err => {\n                // console.error(err);\n                errorCallback(err)\n            })\n    }\n\n    const [updateArtefact, { error: updateErrors }] = useMutation(\n        UPDATE_ARTEFACT_MUTATION,\n        {\n            onCompleted: updateCompleted,\n            onError: handleUpdateError\n        }\n    )\n\n    const parseDate = date => {\n        return date ? date.toISOString().slice(0, -1) : null\n    }\n\n    // for creation of a new artefact\n    const submitForm = async event => {\n        if (!addressIsSearchResult) {\n            handleUnselectedSearchField()\n            return\n        }\n\n        var famIDs = []\n        if (state.belongsToFamiliesBools) {\n            famIDs = Object.keys(state.belongsToFamiliesBools).filter(\n                id => state.belongsToFamiliesBools[id]\n            )\n        }\n\n        // File/uploaded included directly from state, multipart request\n        var input = {\n            name: state.name,\n            description: state.description,\n            state: state.state,\n            isPublic: state.isPublic ? state.isPublic : false,\n            belongsToFamilies: famIDs,\n            address: state.address ? state.address : '',\n        }\n        if (state.date) {\n            input.date = parseDate(state.date)\n        }\n        createArtefact(input, handleCreationCompleted, handleCreationError)\n    }\n\n    // for updating an existing artefact\n    const saveChange = async event => {\n        if (edit) {\n            var input = {}\n            if (!addressIsSearchResult) {\n                handleUnselectedSearchField()\n                return\n            } else if (beingEdited === 'belongsToFamiliesBools') {\n                input['belongsToFamilies'] = Object.keys(\n                    state.belongsToFamiliesBools\n                ).filter(id => state.belongsToFamiliesBools[id])\n            } else if (beingEdited === 'date') {\n                input[beingEdited] = parseDate(state[beingEdited])\n            } else {\n                input[beingEdited] = state[beingEdited]\n            }\n\n            console.log('Input to GQL update mutation: input', input)\n            updateArtefact({\n                variables: {\n                    id: artefact.id,\n                    artefactInput: input\n                }\n            })\n        }\n    }\n\n    const noErrors = !creationErrors\n    const dataLoading = familiesLoading || statesLoading\n\n    // select the submit handler\n    const submitHandler = e => {\n        e.preventDefault()\n        create ? submitForm(e) : saveChange(e)\n    }\n\n    if ((edit || view) && dataLoading) {\n        return <Loading />\n    }\n\n    const editButtonProps = {\n        save: saveChange,\n        cancel: cancelEditing,\n        updateErrors: updateErrors,\n        classes: classes\n    }\n\n    const componentProps = {\n        beingEdited: beingEdited,\n        mode: mode,\n        classes: classes,\n        artefactStates: artefactStates,\n        username: context.user.username,\n        families: families,\n        states: {\n            state: state,\n            locationState: locationState\n        },\n        setters: {\n            handleSetField: handleSetField\n        }\n    }\n\n    const addressProps = {\n        ...componentProps,\n        handleGeocodeQuery: handleGeocodeQuery,\n        setters: {\n            ...componentProps.setters,\n            setLocationState: setLocationState,\n            setAddressIsSearchResult: setAddressIsSearchResult,\n            handleSetLocationResult: handleSetLocationResult\n        }\n    }\n\n    const LeftPaneComponents = [\n        { comp: Name, name: 'name' },\n        { comp: State, name: 'state' },\n        { comp: Description, name: 'description' },\n        { comp: Admin, name: 'admin' },\n        { comp: Date, name: 'date' }\n    ]\n\n    const RightPaneComponents = [\n        { comp: Privacy, name: 'isPublic' },\n        { comp: Families, name: 'belongsToFamiliesBools' },\n        { comp: Images, name: 'files' }\n    ]\n\n    const Panes = [LeftPaneComponents, RightPaneComponents]\n\n    return (\n        <form onSubmit={submitHandler} className={classes.form}>\n            <Grid container className={classes.outerContainer} spacing={1}>\n                <Grid item xs={12} container justify='center'>\n                    <Title mode={mode} classes={classes} />\n                </Grid>\n\n                {Panes.map(pane => (\n                    <Grid item xs={12} sm={6} container spacing={1} key={pane}>\n                        {pane.map(({ comp, name }) => {\n                            return (\n                                <FieldWrapper\n                                    key={comp}\n                                    child={comp}\n                                    name={name}\n                                    childProps={componentProps}\n                                    editButtonProps={editButtonProps}\n                                    classes={classes}\n                                />\n                            )\n                        })}\n                    </Grid>\n                ))}\n\n                <Grid item xs={12}>\n                    <FieldWrapper\n                        child={Address}\n                        name='address'\n                        childProps={addressProps}\n                        editButtonProps={editButtonProps}\n                        classes={classes}\n                    />\n                </Grid>\n\n                {create && (\n                    <Grid item xs={5}>\n                        <CreateButton noErrors={noErrors} />\n                    </Grid>\n                )}\n\n                <SuccessSnackbar\n                    open={snackbarOpen}\n                    setOpen={setSnackbarOpen}\n                    viewArtefact={pushViewArtefactURL}\n                    classes={classes}\n                    id={artefact ? artefact.id : '-1'}\n                />\n            </Grid>\n        </form>\n    )\n}\n\nfunction Wrapped(props) {\n    return (\n        <Layout>\n            <MuiPickersUtilsProvider utils={DateFnsUtils}>\n                <Grid\n                    container\n                    spacing={0}\n                    direction='column'\n                    alignItems='center'\n                    justify='center'\n                    style={{ minHeight: '80vh' }}\n                >\n                    <Grid item xs={10}>\n                        <CssBaseline />\n                        <ArtefactView {...props} />\n                    </Grid>\n                </Grid>\n            </MuiPickersUtilsProvider>\n        </Layout>\n    )\n}\n\nexport default withRouter(Wrapped)\n","import React from 'react'\nimport ArtefactView from './ArtefactView'\nimport {\n    GetArtefactWrapper,\n    GetFamiliesWrapper,\n    GetStatesWrapper\n} from '../../components'\n\nexport default function CreateArtefactView(props) {\n    const childProps = {\n        child: GetArtefactWrapper,\n        childProps: {\n            child: ArtefactView\n        },\n        create: true\n    }\n    return (\n        <GetStatesWrapper\n            {...props}\n            {...childProps}\n            child={GetFamiliesWrapper}\n        />\n    )\n}\n","import React from 'react'\nimport ArtefactView from './ArtefactView'\nimport {\n    GetArtefactWrapper,\n    GetFamiliesWrapper,\n    GetStatesWrapper\n} from '../../components'\n\nexport default function EditArtefactView(props) {\n    const thisChildProps = {\n        child: GetArtefactWrapper,\n        childProps: {\n            child: ArtefactView\n        },\n        view: true\n    }\n    return (\n        <GetStatesWrapper\n            {...props}\n            child={GetFamiliesWrapper}\n            childProps={thisChildProps}\n        />\n    )\n}\n","import React, { useState } from 'react'\nimport Layout from '../../components/Layout'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { CssBaseline, Grid } from '@material-ui/core'\nimport gql from 'graphql-tag'\nimport { useQuery } from '@apollo/react-hooks'\nimport ArtefactCard from '../../components/ArtefactCard'\nimport { config } from '../../constants'\n\nconst useStyles = makeStyles(theme => ({\n    textField: {\n        // marginLeft: theme.spacing(1),\n        // marginRight: theme.spacing(1),\n        padding: theme.spacing(1),\n        backgroundColor: theme.palette.background.paper,\n        textAlign: 'center',\n        marginTop: theme.spacing(1)\n    },\n    container: {\n        padding: theme.spacing(1),\n        margin: theme.spacing(1),\n    },\n    button: {\n        margin: theme.spacing(1)\n    }\n}))\n\nconst LIST_OF_ARTEFACTS = gql`\n    query artefactsQuery($first: Int!) {\n        me {\n            artefactAdministratorOf(first: $first) {\n                edges {\n                    node {\n                        id\n                        name\n                        description\n                        upload\n                    }\n                }\n            }\n        }\n    }\n`\n\nfunction ManageArtefactsView(props) {\n\n    const classes = useStyles()\n    const numArtefactsFetched = 10\n    const [artefactEdges, SetArtefactEdges] = useState([])\n\n    let { data, loading } = useQuery(LIST_OF_ARTEFACTS, {\n        variables: {\n            first: numArtefactsFetched\n        },\n        onCompleted: data =>\n            SetArtefactEdges(data.me.artefactAdministratorOf.edges)\n    })\n\n    console.log('The data is: ', data)\n\n    if (loading) {\n        return <p>Loading...</p>\n    }\n    return (\n        <Layout>\n            <CssBaseline />\n            <Grid container spacing={2} className={classes.container}>\n                <Grid item xs={12}>\n                    <Grid container justify='center' spacing={2}>\n                        {artefactEdges.map(edge => (\n                            <Grid item key={edge.node.id}>\n                                <ArtefactCard\n                                    mediaURI={config.mediaRoot + edge.node.upload}\n                                    name={edge.node.name}\n                                    description={edge.node.description}\n                                    id={edge.node.id}\n                                />\n                            </Grid>\n                        ))}\n                    </Grid>\n                </Grid>\n            </Grid>\n        </Layout>\n    )\n}\n\nexport default ManageArtefactsView\n","import React from 'react'\nimport ArtefactView from './ArtefactView'\nimport {\n    GetArtefactWrapper,\n    GetFamiliesWrapper,\n    GetStatesWrapper\n} from '../../components'\n\nexport default function EditArtefactView(props) {\n    const thisChildProps = {\n        child: GetArtefactWrapper,\n        childProps: {\n            child: ArtefactView\n        },\n        edit: true\n    }\n\n    return (\n            <GetStatesWrapper\n                {...props}\n                child={GetFamiliesWrapper}\n                childProps={thisChildProps}\n            />\n    )\n}\n","import React from 'react'\n\nexport default function Error404View(props) {\n    return (\n        <div style={{padding:'50px'}}>\n            <h1 style={{color: 'red'}}>404 Page Not Found</h1>\n            <h3>If you're seeing this page...</h3>\n            <img src=\"https://media0.giphy.com/media/KVZXay4Uduy8XHpZRc/giphy.gif\" alt=''/>\n            <p><a href=\"/\">Return home</a></p>\n        </div>\n    )\n}","import React, { useContext, useState } from 'react';\nimport Layout from '../components/Layout';\nimport authContext from '../authContext';\nimport { makeStyles } from '@material-ui/core/styles';\nimport GridList from '@material-ui/core/GridList';\nimport GridListTile from '@material-ui/core/GridListTile';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport { Typography, CssBaseline, Button, TextField, Grid,\nFormControl } from '@material-ui/core';\nimport Select from '@material-ui/core/Select';\nimport gql from \"graphql-tag\";\nimport { useMutation, useQuery } from '@apollo/react-hooks';\nimport ArtefactCard from '../components/ArtefactCard';\n\n\nconst useStyles = makeStyles(theme => ({\n    root: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        justifyContent: 'space-around',\n        overflow: 'hidden',\n        backgroundColor: theme.palette.background.paper\n    },\n    icon: {\n        color: 'rgba(255, 255, 255, 0.54)'\n    }\n}))\n\nconst HOMEPAGE_INFO = gql`\n        query {\n            me {\n            isMemberOf {\n            id\n            familyName\n            joinCode\n            hasArtefacts {\n                edges {\n                node {\n                    id\n                    name\n                    admin {\n                    username\n                    }\n                }\n                }\n            }\n            }\n            profile {\n                id\n                selectedFamily {\n                    id\n                    familyName\n                    joinCode\n                        hasArtefacts {\n                            edges {\n                                node {\n                                    id\n                                    name\n                                    description\n                                    upload\n                                }\n                            }\n                        }\n                    }\n                }\n        }\n    }`\n\nconst JOIN_FAMILY_MUTATION = gql`\nmutation JoinFamily($joinCode: String!) {\n  familyJoin(joinCode: $joinCode) {\n    family {\n      familyName\n      familyAdmin {\n          username\n      }\n    }\n  }\n}`\n\nconst SELECT_FAMILY_MUTATION = gql`\nmutation SelectFamilyMutation($profileId: Int!, $toFamily: String!) {\n    updateProfile(input: {\n        id: $profileId,\n        selectedFamily: $toFamily\n    }) {\n        id\n        selectedFamily\n    }\n}`\n\nfunction UserHomeView(props) {\n    const classes = useStyles()\n\n    const context = useContext(authContext)\n    const username = context.user.username\n    const [formJoinCode, setFormJoinCode] = useState(\"\")\n\n    const [joinFamilyMutation, { data: join_mutation_data }] = useMutation(JOIN_FAMILY_MUTATION,\n        {\n            refetchQueries: (data) => [\n                { query: HOMEPAGE_INFO },\n            ],\n        });\n\n    const handleJoinFamily = () => {\n        if (formJoinCode.length === 0) {\n            console.error(\"Enter a valid joinCode\");\n            return;\n        }\n\n        joinFamilyMutation({variables: {joinCode: formJoinCode }})\n    }\n\n    const _homepageInfoCompleted = (data) => {\n        const selectedFamily = data.me.profile.selectedFamily\n        if (!selectedFamily) {\n            console.error(\"User has not selected a family\");\n            return;\n        }\n    }\n\n    let { data: home_data, loading, called: home_page_info_called } = useQuery(HOMEPAGE_INFO, {\n        onCompleted: (data) => {\n            _homepageInfoCompleted(data)\n        }\n    })\n\n\n    const [selectFamily, { data: mutation_data }] = useMutation(SELECT_FAMILY_MUTATION,\n        {\n            refetchQueries: (data) => [\n                { query: HOMEPAGE_INFO },\n            ],\n        });\n\n    const inputLabel = React.useRef(null);\n\n    const handleChange = event => {\n        event.preventDefault()\n        const newFamily = event.target.value;\n        selectFamily({ variables: { profileId: profileId, toFamily: newFamily } })\n    };\n\n    if (loading) {\n        return <p>Loading...</p>\n    }\n\n    const selectedFamily = home_data.me.profile.selectedFamily\n    const families = home_data.me.isMemberOf;\n    const profileId = home_data.me.profile.id;\n    let artefacts = []\n    \n    // If the user has selected a family there will be a list of artefacts\n    // Though the list may be empty\n    if (selectedFamily) {\n        artefacts = home_data.me.profile.selectedFamily.hasArtefacts.edges;\n    }\n    \n    return (\n        <Layout>\n            <CssBaseline />\n            <Grid container spacing={3}>\n                <Grid item xs={9}>\n                    {selectedFamily && (\n                        <div>\n                        <Typography variant=\"h1\">{selectedFamily.familyName}</Typography>\n                        <Typography variant=\"h5\">Join code: {selectedFamily.joinCode}</Typography>\n                        </div>\n                    )}\n                    {!selectedFamily && (\n                        <Typography variant=\"h2\">Join and/or Select a Family</Typography>\n                    )}\n                    <h4>Your username is (temp, for testing): {username}</h4>\n                    <GridList cellHeight={\"auto\"} cols={2}>\n                        {artefacts.map((artefact, key) => (\n                            <GridListTile\n                                key={key}>\n                                <ArtefactCard\n                                    key={key}\n                                    mediaURI={artefact.node.upload}\n                                    name={artefact.node.name}\n                                    description={artefact.node.description}\n                                    id={artefact.node.id} />\n                            </GridListTile>\n                        ))}\n                    </GridList>\n                </Grid>\n                <Grid item xs={3}>\n                    <InputLabel ref={inputLabel} htmlFor=\"outlined-age-simple\">\n                        Select Family\n                    </InputLabel>\n                    <Select\n                        variant='outlined'\n                        fullWidth\n                        disabled={families.length <= 1}\n                        value={selectedFamily ? selectedFamily.id : null}\n                        onChange={handleChange}\n                        inputProps={{\n                            name: 'age',\n                            id: 'outlined-age-simple',\n                        }}\n                    >\n                        {families && (families.map((item, key) =>\n                            <MenuItem\n                                key={item.id}\n                                value={item.id}\n                            >\n                                {item.familyName}\n                            </MenuItem>\n                        )\n                        )}\n                    </Select>\n                    <FormControl\n                    fullWidth\n                    >\n                    <TextField \n                        id=\"joinCodeField\"\n                        label=\"Join a family\"\n                        value={formJoinCode}\n                        className={classes.textField}\n                        margin=\"normal\"\n                        onChange={e => setFormJoinCode(e.target.value)}\n                        fullWidth\n                    />\n                    <Button\n                        variant=\"outlined\" \n                        onClick={handleJoinFamily}\n                    >\n                        Join Family\n                    </Button>\n                    </FormControl>\n                </Grid>\n            </Grid>\n        </Layout>\n    )\n}\n\nexport default UserHomeView\n","import React, { useState, Fragment } from 'react'\nimport { useTheme } from '@material-ui/styles'\nimport {\n    MenuItem,\n    TextField,\n    Grid,\n    Paper,\n    IconButton,\n    Snackbar,\n    SnackbarContent,\n    Button,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    DialogTitle\n} from '@material-ui/core'\nimport HelpIcon from '@material-ui/icons/Help'\nimport ErrorIcon from '@material-ui/icons/Error'\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle'\nimport { green } from '@material-ui/core/colors'\n\nimport { Map } from '../components'\nimport { artefactGeocodeQuery } from '../components/MapAPI'\n\nimport { GetFamiliesWrapper, Layout } from '../components'\n\nimport { GET_FAMILY_ARTEFACTS } from '../gqlQueriesMutations'\nimport { useQuery } from '@apollo/react-hooks'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n    overlay: {\n        position: 'absolute',\n        top: '70px',\n        right: '5px',\n        // backgroundColor: theme.palette.background.paper,\n        margin: theme.spacing(1),\n        minWidth: 120\n    },\n    paper: {\n        padding: theme.spacing(1),\n        margin: theme.spacing(1),\n        borderRadius: 10\n    },\n    error: {\n        backgroundColor: theme.palette.error.dark\n    },\n    success: {\n        backgroundColor: green[600]\n    },\n    icon: {\n        opacity: 0.9,\n        marginRight: theme.spacing(1),\n        fontSize: 20\n    },\n    message: {\n        display: 'flex',\n        alignItems: 'center'\n    }\n}))\n\nconst MyDialogContent = () => (\n    <Fragment>\n        <DialogTitle id='help-title'>Help</DialogTitle>\n        <DialogContent>\n            <DialogContentText>\n                Select from your families in the corner to view their artefacts\n            </DialogContentText>\n            <DialogContentText>\n                Only artefacts with a location will be shown\n            </DialogContentText>\n        </DialogContent>\n\n        <DialogTitle id='help-title'>Map Controls</DialogTitle>\n        <DialogContent>\n            <DialogContentText>Scroll to zoom</DialogContentText>\n            <DialogContentText>Click and drag to move</DialogContentText>\n            <DialogContentText>\n                Click on an artefact to open a popup\n            </DialogContentText>\n        </DialogContent>\n    </Fragment>\n)\n\nconst MapStyles = [\n    { value: 'mapbox://styles/mapbox/streets-v11', name: 'Streets' },\n    { value: 'mapbox://styles/mapbox/satellite-v9', name: 'Satellite' },\n    { value: 'mapbox://styles/mapbox/light-v10', name: 'Light' },\n    { value: 'mapbox://styles/mapbox/dark-v10', name: 'Dark' },\n    {\n        value: 'mapbox://styles/zduffield/ck1q1hwgo2idy1cl3jt3rh1vk',\n        name: 'Ugly'\n    }\n]\n\nfunction MapView(props) {\n    const theme = useTheme()\n    const classes = useStyles()\n    var defaultMapStyle = 'mapbox://styles/mapbox/streets-v9?optimize=true'\n    if (theme.palette.type === 'dark') {\n        defaultMapStyle = 'mapbox://styles/mapbox/dark-v10?optimize=true'\n    }\n\n    var { families, familiesLoading } = props\n\n    // initally query is run with invalid ID\n    const [state, setState] = useState({\n        family: { id: '-1' },\n        defaultMapStyle: defaultMapStyle,\n        mapStyle: defaultMapStyle,\n        selectedArtefact: {}\n    })\n\n    if (state.defaultMapStyle !== defaultMapStyle) {\n        // avoid unnecessary rerender of map\n        if (state.mapStyle !== defaultMapStyle) {\n            setState({\n                ...state,\n                defaultMapStyle: defaultMapStyle,\n                mapStyle: defaultMapStyle\n            })\n        } else {\n            setState({\n                ...state,\n                defaultMapStyle: defaultMapStyle\n            })\n        }\n    }\n\n    const [mapArtefacts, setMapArtefacts] = useState([])\n    const [mapState, setMapState] = useState({\n        zoom: [2]\n    })\n    const [snackbarOpen, setSnackbarOpen] = useState(false)\n    const [errorSnackbar, setErrorSnackbar] = useState({ open: false, msg: '' })\n    const [helpOpen, setHelpOpen] = useState(false)\n    const getArtefactMapData = data => {\n        if (!data) return\n        artefacts = data.family.hasArtefacts.edges.map(edge => edge.node)\n\n        var promiseArr = []\n        for (var i = 0; i < artefacts.length; i++) {\n            if (artefacts[i].address) {\n                promiseArr.push(\n                    artefactGeocodeQuery(artefacts[i]).then(result => {\n                        var { response, artefact } = result\n                        if (response.error) {\n                            console.log(response.error)\n                            setErrorSnackbar({\n                                open: true,\n                                msg: 'Error loading artefacts'\n                            })\n                        } else {\n                            var mapArtefact = {\n                                ...artefact,\n                                popup: true,\n                                center: response.results[0].mapState.center,\n                                initPopupOpen: false\n                            }\n                            return mapArtefact\n                        }\n                    })\n                )\n            }\n        }\n        Promise.all(promiseArr).then(result => {\n            setMapArtefacts(result)\n            setSnackbarOpen(true)\n        })\n    }\n\n    useQuery(GET_FAMILY_ARTEFACTS, {\n        variables: { id: state.family.id },\n        onCompleted: getArtefactMapData,\n        onError: error => {\n            if (state.family.id > 0) {\n                setErrorSnackbar({ open: true, msg: 'Error loading family' })\n                console.log(error)\n            }\n        }\n    })\n\n    var artefacts = []\n\n    const handleChange = event => {\n        if (event.target.value === state.family) return\n\n        if (event.target.name === 'family') {\n            setMapArtefacts([])\n        }\n\n        if (event.target.name === 'selectedArtefact'){\n            setMapState({\n                ...mapState,\n                center: event.target.value.center\n            })\n            event.target.value.initPopupOpen = true\n        }\n        setState({\n            ...state,\n            [event.target.name]: event.target.value\n        })\n    }\n\n    return (\n        <Paper className={classes.paper} elevation={10}>\n            <Grid container>\n                <Map\n                    interactive\n                    mapStyle={state.mapStyle}\n                    mapState={mapState}\n                    containerStyle={{\n                        height: '87vh',\n                        width: '100vw',\n                        position: 'relative',\n                        zIndex: 0,\n                        borderRadius: 10\n                    }}\n                    artefacts={mapArtefacts}\n                />\n            </Grid>\n            <Grid\n                container\n                item\n                xs={4}\n                sm={1}\n                className={classes.overlay}\n                justify='flex-end'\n            >\n                {!familiesLoading && (\n                    <Grid item xs={12}>\n                        <Paper className={classes.paper}>\n                            <TextField\n                                fullWidth\n                                label='Family'\n                                variant='outlined'\n                                value={state.family || {}}\n                                select\n                                onChange={handleChange}\n                                SelectProps={{\n                                    name: 'family',\n                                    autoWidth: true\n                                }}\n                            >\n                                {families.map(fam => (\n                                    <MenuItem value={fam} key={fam.id}>\n                                        {fam.familyName}\n                                    </MenuItem>\n                                ))}\n                            </TextField>\n                        </Paper>\n                    </Grid>\n                )}\n                <Grid item xs={12}>\n                    <Paper className={classes.paper}>\n                        <TextField\n                            fullWidth\n                            label='Map Style'\n                            variant='outlined'\n                            value={state.mapStyle}\n                            select\n                            onChange={handleChange}\n                            SelectProps={{\n                                name: 'mapStyle',\n                                autoWidth: true\n                            }}\n                        >\n                            <MenuItem value={defaultMapStyle}>Default</MenuItem>\n                            {MapStyles.map(style => (\n                                <MenuItem value={style.value}>\n                                    {style.name}\n                                </MenuItem>\n                            ))}\n                        </TextField>\n                    </Paper>\n                </Grid>\n\n                {/* {mapArtefacts && (\n                    <Grid item xs={12}>\n                        <Paper className={classes.paper}>\n                            <TextField\n                                fullWidth\n                                label='Go to artefact'\n                                variant='outlined'\n                                value={state.selectedArtefact}\n                                select\n                                onChange={handleChange}\n                                SelectProps={{\n                                    name: 'selectedArtefact',\n                                    autoWidth: true\n                                }}\n                            >\n                                <MenuItem value={{}}>None</MenuItem>\n                                {mapArtefacts.map(artefact => (\n                                    <MenuItem value={artefact}>\n                                        {artefact.name}\n                                    </MenuItem>\n                                ))}\n                            </TextField>\n                        </Paper>\n                    </Grid>\n                )} */}\n\n                <IconButton\n                    edge='start'\n                    color='inherit'\n                    aria-label='menu'\n                    onClick={() => setHelpOpen(true)}\n                >\n                    <HelpIcon />\n                </IconButton>\n            </Grid>\n\n            <Dialog\n                fullWidth\n                maxWidth='sm'\n                open={helpOpen}\n                onClose={() => setHelpOpen(false)}\n                aria-labelledby='help-title'\n            >\n                <MyDialogContent />\n                <DialogActions>\n                    <Button onClick={() => setHelpOpen(false)} color='primary'>\n                        Close\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n            <Snackbar\n                anchorOrigin={{\n                    vertical: 'bottom',\n                    horizontal: 'left'\n                }}\n                open={snackbarOpen}\n                autoHideDuration={2000}\n                onClose={e => setSnackbarOpen(false)}\n            >\n                <SnackbarContent\n                    className={classes.success}\n                    aria-describedby='success-message-id'\n                    message={\n                        <span\n                            id='success-message-id'\n                            className={classes.message}\n                        >\n                            <CheckCircleIcon className={classes.icon} />\n                            {mapArtefacts.length} Artefacts Loaded\n                        </span>\n                    }\n                />\n            </Snackbar>\n\n            <Snackbar\n                anchorOrigin={{\n                    vertical: 'bottom',\n                    horizontal: 'left'\n                }}\n                open={errorSnackbar.open}\n                autoHideDuration={2000}\n                onClose={e => setErrorSnackbar({ open: false, msg: '' })}\n            >\n                <SnackbarContent\n                    className={classes.error}\n                    aria-describedby='err-message-id'\n                    message={\n                        <span id='err-message-id' className={classes.message}>\n                            <ErrorIcon className={classes.icon} />\n                            {errorSnackbar.msg}\n                        </span>\n                    }\n                />\n            </Snackbar>\n        </Paper>\n    )\n}\n\nexport default props => (\n    <Layout>\n        <GetFamiliesWrapper {...props} child={MapView} />\n    </Layout>\n)\n","import React from 'react'\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom'\nimport { PrivateRoute } from './components/PrivateRoute'\nimport { CssBaseline } from '@material-ui/core'\n\n// Views\nimport Login from './views/LoginView'\nimport Signup from './views/SignupView'\nimport Logout from './components/Logout'\n\n// Family views\nimport CreateFamilyView from './views/CreateFamilyView'\n// Artefact Views\nimport CreateArtefactView from './views/artefactViews/CreateArtefactView'\nimport DetailView from './views/artefactViews/DetailView'\nimport ManageArtefactsView from './views/artefactViews/ManageArtefactsView'\nimport EditArtefactView from './views/artefactViews/EditArtefactView'\nimport Error404View from './views/Error404View'\n\nimport UserHomeView from './views/UserHomeView'\n\nimport MapView from './views/MapView'\n\nfunction App(props) {\n    return (\n        <Router>\n            <CssBaseline />\n            <div>\n                <Switch>\n                    {/* This is a special protected route, since it sends to the landing page if not logged in, which \n                        has the same url as the userHomeView */}\n                    <PrivateRoute\n                        exact\n                        path='/'\n                        loggedIn={UserHomeView}\n                        landingPage\n                    />\n                    {/* User auth routes */}\n                    <Route exact path='/login/' component={Login} />\n                    <Route exact path='/signup/' component={Signup} />\n                    <Route exact path='/logout/' component={Logout} />\n\n                    {/* Artefact routes */}\n                    <PrivateRoute\n                        exact\n                        path='/artefacts/create/'\n                        loggedIn={CreateArtefactView}\n                        landingPage\n                    />\n                    <PrivateRoute\n                        exact\n                        path='/artefacts/manage/'\n                        loggedIn={ManageArtefactsView}\n                        landingPage\n                    />\n                    <PrivateRoute\n                        exact\n                        path='/artefacts/:id/'\n                        loggedIn={DetailView}\n                        landingPage\n                    />\n                    <PrivateRoute\n                        exact\n                        path='/artefacts/edit/:id/'\n                        loggedIn={EditArtefactView}\n                        landingPage\n                    />\n\n                    {/* Family routes */}\n                    <PrivateRoute\n                        exact\n                        path='/family/create/'\n                        loggedIn={CreateFamilyView}\n                        landingPage\n                    />\n\n                    {/* Map */}\n                    <PrivateRoute\n                        exact\n                        path='/map/'\n                        loggedIn={MapView}\n                        landingPage\n                    />\n\n                    <Route component={Error404View} />\n                </Switch>\n            </div>\n        </Router>\n    )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport * as serviceWorker from './serviceWorker'\nimport { ApolloClient } from 'apollo-client'\nimport { createHttpLink } from 'apollo-link-http'\nimport { setContext } from 'apollo-link-context'\nimport { InMemoryCache } from 'apollo-cache-inmemory'\nimport { ApolloProvider } from '@apollo/react-hooks'\nimport Auth from './components/Auth'\n\nimport App from './App'\nimport { AUTH_TOKEN, config } from './constants'\n\n// Depending on prod or dev, set the appropriate uri for the graphql queries\nconst httpLink = createHttpLink({\n    uri: config.uri\n})\n\nconst authLink = setContext((_, { headers }) => {\n    // get the authentication token from local storage if it exists\n    const token = localStorage.getItem(AUTH_TOKEN)\n    // return the headers to the context so httpLink can read them\n    return {\n        headers: {\n            ...headers,\n            authorization: token ? `JWT ${token}` : ''\n        }\n    }\n})\n\n// Set up Apollo client using Jwt auth\nconst client = new ApolloClient({\n    link: authLink.concat(httpLink),\n    cache: new InMemoryCache()\n})\n\n// Wrap application with Apollo and Auth providers to give access across the application\nReactDOM.render(\n    <ApolloProvider client={client}>\n        <Auth>\n            <App />\n        </Auth>\n    </ApolloProvider>,\n    document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}