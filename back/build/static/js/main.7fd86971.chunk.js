(window["webpackJsonpartefacts-app"]=window["webpackJsonpartefacts-app"]||[]).push([[0],{174:function(e,t,a){e.exports=a(241)},179:function(e,t,a){},241:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a(0),o=a.n(r),i=a(14),c=a.n(i);a(179),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(59),s=a(151),u=a(147),m=a(150),d=a(32),p=a(13),f=a.n(p),g=a(17),b=a(9),h=a(22),y=a(23),v=a.n(y),O=a(16),E=Object(r.createContext)({authenticated:!1,user:{},authToken:"",initiateLogin:function(){},handleAuthentication:function(){},logout:function(){}}),j=E,w=E.Provider,S=(E.Consumer,"auth-token"),k="duplicate key",x="Please, enter valid credentials",P="pk.eyJ1IjoiemR1ZmZpZWxkIiwiYSI6ImNrMWdkODhpOTBiM28zZG03eDdjZ2dmN24ifQ.vAzlFYY5S9O82SKnwX69kQ",C={uri:"/graphql/",mediaRoot:"https://artefact-picture.s3.amazonaws.com/media/"};function F(){var e=Object(h.a)(["\nmutation VerifyToken($token: String!) {\n    verifyToken(token: $token) {\n        payload\n    }\n}\n"]);return F=function(){return e},e}var N=v()(F());var T=a(21),D=a(58),A=a(3),I=a(81),$=a(56),W=a(129),B=a(130),z=a(153),L=a(131),R=a(110);var q=function(){var e=Object(L.a)(function(e){return{progress:{margin:e.spacing(2)}}})();return o.a.createElement(R.a,{className:e.progress})},M=a(132),_=a.n(M),Q=a(283),U=a(50),H=a(133),V=a.n(H);function J(e){var t=e.linkTo;return o.a.createElement(Q.a,{style:{color:"#f0f0f0",padding:"12px",margin:"5px"},component:T.b,to:t},e.children)}var Z=function(e){return o.a.createElement("div",null,o.a.createElement("link",{href:"https://fonts.googleapis.com/css?family=Dosis&display=swap",rel:"stylesheet"}),o.a.createElement(U.a,{variant:"h1",style:{padding:"5rem",zIndex:3,position:"absolute",fontWeight:"lighter",fontFamily:"Dosis",color:"#f0f0f0"}},"Family Artefacts Register"),o.a.createElement(U.a,{variant:"h2",style:{padding:"5rem",zIndex:3,position:"absolute",top:"8rem",fontWeight:"lighter",fontFamily:"Dosis",color:"#f0f0f0"}},o.a.createElement(V.a,null,"Connecting you to your family ",o.a.createElement("br",null),"and your family's history.")),o.a.createElement(_.a,{style:Object(n.a)({position:"fixed",left:0,top:0,background:"rgb(103, 58, 183)"},"background","linear-gradient(90deg, rgba(103, 58, 183, 1) 25%, rgba(63, 81, 181, 1) 100%, rgba(255, 255, 255, 1) 100%)"),params:{particles:{number:{value:120,density:{enable:!0,value_area:800}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#FFFFFF"},polygon:{nb_sides:5},image:{src:"img/github.svg",width:100,height:100}},opacity:{value:.44093831673801875,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:4.008530152163807,random:!0,anim:{enable:!1,speed:40,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.4,width:1},move:{enable:!0,speed:6,direction:"none",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!0,mode:"grab"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{grab:{distance:400,line_linked:{opacity:1}},bubble:{distance:400,size:40,duration:2,opacity:8,speed:3},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!0}}),o.a.createElement("div",{style:{position:"absolute",right:0}},o.a.createElement(J,{linkTo:"/signup"},"Sign up"),o.a.createElement(J,{linkTo:"/login"},"Login")))},G=function(e){function t(){var e,a;Object(I.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(W.a)(this,(e=Object(B.a)(t)).call.apply(e,[this].concat(r)))).state={checkAuthenticated:!1},a}return Object(z.a)(t,e),Object($.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.context.authenticated&&this.setState({checkAuthenticated:!0});var t=localStorage.getItem(S);!this.context.authenticated&&t?this.context.handleAuthentication(t,function(){console.log("Setting state"),e.setState({checkAuthenticated:!0})}):this.setState({checkAuthenticated:!0})}},{key:"render",value:function(){return this.props.children(this.state.checkAuthenticated)}}]),t}(r.Component);G.contextType=j;var K=function(e){var t=e.loggedIn,a=e.loggedOut,n=(e.path,e.landingPage),i=Object(A.a)(e,["loggedIn","loggedOut","path","landingPage"]),c=Object(r.useContext)(j).authenticated;return a||(a="/login"),console.log("Authenticated: ",c),o.a.createElement(G,null,function(e){return!1===e?o.a.createElement(q,null):o.a.createElement(D.b,Object.assign({},i,{render:function(e){return c?o.a.createElement(t,e):!c&&n?o.a.createElement(Z,null):o.a.createElement(D.a,{to:a})}}))})},Y=a(303),X=a(73),ee=a(327),te=a(308),ae=a(312),ne=a(313),re=a(295),oe=a(296),ie=a(245),ce=a(297),le=a(285),se=a(298),ue=a(299),me=a(329),de=a(284),pe=a(244),fe=a(290),ge=a(291),be=a(152),he=a(294),ye=a(286),ve=a(287),Oe=a(288),Ee=a(289),je=a(292),we=Object(L.a)(function(e){return{drawer:{width:"auto",margin:e.spacing(1),marginTop:e.spacing(5)}}}),Se=function(e){var t=e.drawerOpen,a=e.setDrawerOpen,n=we(),i=o.a.useState(null),c=Object(b.a)(i,2),l=c[0],s=c[1],u=Object(r.useContext)(j),m=Boolean(l);function d(){s(null)}return o.a.createElement("div",null,o.a.createElement(me.a,{anchor:"left",open:t,onClose:function(e){return a(!1)}},o.a.createElement("div",{className:n.drawer,role:"presentation",onClick:function(e){return a(!1)},onKeyDown:function(e){return a(!1)}},o.a.createElement(de.a,null,[{name:"Home",path:"/",icon:le.a},{name:"Create Family",path:"/family/create/",icon:ye.a},{name:"Manage Artefacts",path:"/artefacts/manage/",icon:ve.a},{name:"Create Artefact",path:"/artefacts/create/",icon:Oe.a},{name:"Artefact Map",path:"/map/",icon:Ee.a}].map(function(e){var t=e.name,a=e.path,n=e.icon;return o.a.createElement(pe.a,{button:!0,key:a,component:T.b,to:a,style:{borderRadius:10}},o.a.createElement(fe.a,null,o.a.createElement(n,null)),o.a.createElement(ge.a,{primary:t}))})))),o.a.createElement(ie.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){s(e.currentTarget)},color:"inherit"},o.a.createElement(je.a,null)),o.a.createElement(be.a,{id:"menu-appbar",anchorEl:l,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:m,onClose:d},o.a.createElement(he.a,{onClick:d},"Profile"),o.a.createElement(he.a,{onClick:d},"Settings"),o.a.createElement(he.a,{onClick:function(){u.logout()}},"Logout")))},ke=o.a.forwardRef(function(e,t){return o.a.createElement(T.b,Object.assign({innerRef:t,to:"/login"},e))}),xe=o.a.forwardRef(function(e,t){return o.a.createElement(T.b,Object.assign({innerRef:t,to:"/signup"},e))}),Pe=function(e){return o.a.createElement("div",null,o.a.createElement(Q.a,{color:"inherit",underline:"none",component:xe},"Sign up"),o.a.createElement(Q.a,{color:"inherit",underline:"none",component:ke},"Login"))},Ce=a(155),Fe=Object(L.a)(function(e){return{root:{flexGrow:1},iconButton:{marginRight:e.spacing(1)},title:{flexGrow:1,alignText:"left"}}});function Ne(e){var t=Fe(),a=Object(r.useContext)(j).authenticated,n=Object(Ce.a)(),i=n&&"dark"===n.palette.type,c=Object(r.useState)(!1),l=Object(b.a)(c,2),s=l[0],u=l[1];return o.a.createElement("div",{className:t.root},o.a.createElement(re.a,{position:"static",color:"primary",elevation:6},o.a.createElement(oe.a,null,o.a.createElement(ie.a,{className:t.iconButton,edge:"start",color:"inherit","aria-label":"menu",onClick:function(e){return u(!0)}},o.a.createElement(ce.a,null)),o.a.createElement(ie.a,{className:t.iconButton,color:"inherit","aria-label":"home",component:T.b,to:"/"},o.a.createElement(le.a,null)),o.a.createElement(U.a,{variant:"h6",className:t.title},"Family Artefacts Register"),o.a.createElement(ie.a,{className:t.iconButton,color:"inherit","aria-label":"theme-toggle",onClick:e.onToggleDarkTheme},i?o.a.createElement(ue.a,null):o.a.createElement(se.a,null)),a?o.a.createElement(Se,{username:null,drawerOpen:s,setDrawerOpen:u}):o.a.createElement(Pe,null))))}var Te=a(149),De=a(302),Ae=a(91),Ie=a(300),$e=a(301),We={primary:Ae.a,secondary:{main:Ie.a[400]},type:"light"},Be={primary:{main:$e.a.A100},secondary:Ie.a,error:{main:"#CF6679"},background:{paper:"#303030",default:"#121212"},type:"dark"},ze=Object(Te.a)({palette:We,type:"light"}),Le=Object(Te.a)({palette:Be,type:"dark"}),Re=function(e){localStorage.getItem("theme-type")||localStorage.setItem("theme-type","light");var t=Object(r.useState)("light"===localStorage.getItem("theme-type")?ze:Le),a=Object(b.a)(t,2),n=a[0],i=a[1];return o.a.createElement(De.a,{theme:n},o.a.createElement(Y.a,null),o.a.createElement(Ne,{onToggleDarkTheme:function(){var e="light"===n.palette.type?"dark":"light";localStorage.setItem("theme-type",e),i("light"===e?ze:Le)}}),e.children)},qe=a(72),Me=a(304),_e=a(305),Qe=a(309),Ue=a(307),He=a(306),Ve=Object(L.a)(function(e){return{textField:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center",marginTop:e.spacing(1)},paper:{marginTop:e.spacing(1),padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center"},button:{margin:e.spacing(1)},card:{backgroundColor:e.palette.background.paper,maxWidth:345,borderRadius:10},media:{backgroundColor:e.palette.background.paper,height:140}}});var Je=function(e){var t=e.artefact,a=Ve(),n=t.upload,r=t.name,i=t.description,c=t.id,l=C.mediaRoot+n;return o.a.createElement(Me.a,{className:a.card,elevation:3},o.a.createElement(_e.a,null,o.a.createElement(He.a,{className:a.media,image:l,title:r}),o.a.createElement(Ue.a,null,o.a.createElement(te.a,{item:!0,xs:!0,zeroMinWidth:!0},o.a.createElement(U.a,{gutterBottom:!0,variant:"h5",component:"h2",noWrap:!0},r)),o.a.createElement(te.a,{item:!0,xs:!0,zeroMinWidth:!0},o.a.createElement(U.a,{variant:"body2",color:"textSecondary",component:"p",noWrap:!0},i)))),o.a.createElement(Qe.a,null,o.a.createElement(Q.a,{size:"small",fullWidth:!0,color:"primary",component:T.b,to:"/artefacts/".concat(c)},"View")))};function Ze(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Ge(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ze(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ze(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Ke=Object(L.a)(function(e){return{popup:{zIndex:"50 !important"}}}),Ye={accessToken:P,attributionControl:!1,maxZoom:18,minZoom:2},Xe=Object(qe.c)(Ge({},Ye,{interactive:!1})),et=Object(qe.c)(Ge({},Ye,{interactive:!0}));function tt(e){var t=Ke(),a=e.interactive?et:Xe,n=e.artefacts;n||(n=[]);var i=Object(r.useState)(""),c=Object(b.a)(i,2),l=c[0],s=c[1];return o.a.createElement(a,Object.assign({style:e.mapStyle?e.mapStyle:"mapbox://styles/mapbox/streets-v9?optimize=true",containerStyle:e.containerStyle},e.mapState,{onClick:function(e){return s("")}}),n.map(function(e){var a=e.center,n=e.popup,i=e.initPopupOpen;Object(A.a)(e,["center","popup","initPopupOpen"]);if(!a||!a.length)return null;var c=e.id;return o.a.createElement(r.Fragment,{key:c},o.a.createElement(qe.a,{coordinates:a,onClick:function(t){s(l===c?"":c),e.initPopupOpen&&(e.initPopupOpen=!1)}},o.a.createElement("img",{src:"http://maps.google.com/mapfiles/ms/icons/red.png",alt:"marker-img"})),n&&(l===c||i)&&o.a.createElement(qe.b,{coordinates:a,offset:{"bottom-left":[12,-38],bottom:[0,-38],"bottom-right":[-12,-38]},style:{backgroundColor:"#000000 !important"},className:t.popup},o.a.createElement(Je,{artefact:e})))}))}var at=a(195)({accessToken:P}),nt=function(e){var t={},a=e.body.features;if(!a)return t.noResults=!0,t;for(var n=[],r=0;r<a.length;r++){var o=a[r],i={};if(i.mapState={center:o.center},"place"===o.place_type[0]){var c=o.bbox;if(c){var l=[[c[0],c[1]],[c[2],c[3]]];i.mapState.fitBounds=l}}else"address"===o.place_type[0]&&(i.mapState.zoom=[15]);i.placeName=o.place_name,i.locationType=o.place_type[0],n.push(i)}return t.results=n,t},rt=function(e){var t={};return console.log("query error occurred"),t.error=e,t};function ot(e,t){if(!e)return new Promise(function(e,t){e()});var a={query:e,limit:5};return t&&(a.types=t),"object"===typeof e?at.reverseGeocode(a).send().then(function(e){return nt(e)},function(e){return rt(e)}):"string"===typeof e?at.forwardGeocode(a).send().then(function(e){return nt(e)},function(e){return rt(e)}):void 0}function it(e){return ot(e.address).then(function(t){return{artefact:e,response:t}})}function ct(){var e=Object(h.a)(["\n    mutation ArtefactDelete($id: ID!) {\n        artefactDelete(id: $id) {\n            ok\n        }\n    }\n"]);return ct=function(){return e},e}function lt(){var e=Object(h.a)(["\n    mutation FamilyCreate($familyName: String!, $about: String) {\n        familyCreate(input: { familyName: $familyName, about: $about }) {\n            family {\n                familyName\n                joinCode\n            }\n        }\n    }\n"]);return lt=function(){return e},e}function st(){var e=Object(h.a)(["\n    mutation SignupMutation(\n        $email: String!\n        $password: String!\n        $username: String!\n    ) {\n        createUser(email: $email, username: $username, password: $password) {\n            user {\n                id\n                username\n                email\n            }\n        }\n    }\n"]);return st=function(){return e},e}function ut(){var e=Object(h.a)(["\n    query getFamilyArtefacts($id: ID!) {\n        family(id: $id) {\n            hasArtefacts {\n                edges {\n                    node {\n                        id\n                        name\n                        description\n                        address\n                        upload\n                    }\n                }\n            }\n        }\n    }\n"]);return ut=function(){return e},e}function mt(){var e=Object(h.a)(["\n    mutation TokenAuth($username: String!, $password: String!) {\n        tokenAuth(username: $username, password: $password) {\n            token\n        }\n    }\n"]);return mt=function(){return e},e}function dt(){var e=Object(h.a)(["\n    mutation UpdateArtefactMutation(\n        $id: ID!\n        $artefactInput: ArtefactInputType!\n    ) {\n        artefactUpdate(id: $id, input: $artefactInput) {\n            artefact {\n                id\n            }\n        }\n    }\n"]);return dt=function(){return e},e}function pt(){var e=Object(h.a)(["\n    query DetailView($id: ID!) {\n        artefact(id: $id) {\n            id\n            name\n            description\n            admin {\n                id\n                username\n            }\n            state\n            isPublic\n            upload\n            belongsToFamilies {\n                id\n            }\n            addedAt\n            address\n            date\n        }\n    }\n"]);return pt=function(){return e},e}function ft(){var e=Object(h.a)(["\n    query artefactsQuery {\n        me {\n            id\n        }\n    }\n"]);return ft=function(){return e},e}function gt(){var e=Object(h.a)(["\n    query artefactsQuery {\n        me {\n            isMemberOf {\n                familyName\n                id\n            }\n        }\n    }\n"]);return gt=function(){return e},e}function bt(){var e=Object(h.a)(["\n    query ArtefactStatesQuery($name: String!) {\n        __type(name: $name) {\n            enumValues {\n                name\n                description\n            }\n        }\n    }\n"]);return bt=function(){return e},e}function ht(){var e=Object(h.a)(["\n    mutation CreateArtefactMutation(\n        $name: String!\n        $state: String!\n        $isPublic: Boolean\n        $description: String!\n        $belongsToFamilies: [ID]\n        $address: String\n        $date: String\n    ) {\n        artefactCreate(\n            input: {\n                name: $name\n                state: $state\n                description: $description\n                isPublic: $isPublic\n                belongsToFamilies: $belongsToFamilies\n                address: $address\n                date: $date\n            }\n        ) {\n            artefact {\n                id\n            }\n        }\n    }\n"]);return ht=function(){return e},e}v()(ht());var yt="\nmutation CreateArtefactMutation(\n        $name: String!\n        $state: String!\n        $isPublic: Boolean\n        $description: String!\n        $belongsToFamilies: [ID]\n        $address: String\n        $date: String\n    ) {\n        artefactCreate(\n            input: {\n                name: $name\n                state: $state\n                description: $description\n                isPublic: $isPublic\n                belongsToFamilies: $belongsToFamilies\n                address: $address\n                date: $date\n            }\n        ) {\n            artefact {\n                id\n            }\n        }\n    }\n",vt=v()(bt()),Ot=v()(gt()),Et=(v()(ft()),v()(pt())),jt=v()(dt()),wt=v()(mt()),St=v()(ut()),kt=v()(st()),xt=v()(lt()),Pt=v()(ct());function Ct(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Ft(e){var t=e.child,a=e.childProps,i=Object(A.a)(e,["child","childProps"]),c=Object(r.useState)([]),l=Object(b.a)(c,2),s=l[0],u=l[1],m=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ct(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ct(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a,{families:s,familiesLoading:Object(O.b)(Ot,{onCompleted:function(e){return u(e.me.isMemberOf)},onError:function(e){return console.log(e)}}).loading});return o.a.createElement(t,Object.assign({},i,m))}function Nt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Tt(e){var t=e.child,a=e.childProps,i=Object(A.a)(e,["child","childProps"]),c=Object(r.useState)({}),l=Object(b.a)(c,2),s=l[0],u=l[1],m=function(){var e=Object(g.a)(f.a.mark(function e(t){var a,n,r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in a={},t.__type.enumValues)r=t.__type.enumValues[o],n=r.description,a[n]=r.name;u(a);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),d=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Nt(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Nt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a,{artefactStates:s,statesLoading:Object(O.b)(vt,{variables:{name:"ArtefactState"},onCompleted:m,onError:function(e){return console.log(e)}}).loading});return o.a.createElement(t,Object.assign({},i,d))}function Dt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function At(e){var t=e.child,a=e.childProps,r=Object(A.a)(e,["child","childProps"]),i=Object(O.b)(Et,{variables:{id:r.match.params.id},onError:function(e){return console.error(e)}}),c=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Dt(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},a,{artefactData:i.data,artefactLoading:i.loading});return o.a.createElement(t,Object.assign({},r,c))}var It=Object(L.a)(function(e){return{root:{marginLeft:e.spacing(1),marginRight:e.spacing(1),margin:e.spacing(1),borderRadius:10},paper:{padding:e.spacing(2),backgroundColor:e.palette.background.paper,alignItems:"center",alignContent:"stretch",justify:"center",borderRadius:10},form:{display:"flex",flexWrap:"wrap"},submit:{margin:e.spacing(3,0,2)}}}),$t=Object(L.a)(function(e){return{root:{width:"100%",height:"100%",backgroundColor:e.palette.background.paper,justifyContent:"center"},formControl:{height:"100%",justifyContent:"center",textAlign:"left"},title:{marginLeft:e.spacing(3),marginRight:e.spacing(3),padding:e.spacing(1),textAlign:"center"},fieldTitle:{textAlign:"left",marginLeft:e.spacing(1)},paper:{padding:e.spacing(1),backgroundColor:e.palette.background.paper},paperWrapper:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,width:"100%",alignItems:"center",borderRadius:10},button:{height:"100%"},editLinkButton:{width:"60px",height:"30px",margin:e.spacing(1)},deleteButton:{width:"60px",height:"30px",margin:e.spacing(1),backgroundColor:e.palette.error.main},map:{height:"200px",type:e.palette.type},form:{marginBottom:e.spacing(10),marginTop:e.spacing(2),display:"flex",flexWrap:"wrap",textAlign:"center"},iconButton:{padding:10},dropzone:{backgroundColor:e.palette.background.paper+"!important",minHeight:"70px !important",borderRadius:10,alignItems:"flex-start !important"},dropzoneText:{fontSize:"large !important"},outerContainer:{spacing:e.spacing(1),alignItems:"stretch",alignContent:"stretch",justifyContent:"center"},switch:{justifyContent:"center",textAlign:"center"}}});function Wt(e){var t=Object(r.useContext)(j),a=It(),n=Object(r.useState)(""),i=Object(b.a)(n,2),c=i[0],l=i[1],s=Object(r.useState)(""),u=Object(b.a)(s,2),m=u[0],d=u[1],p=Object(r.useState)(!1),h=Object(b.a)(p,2),y=h[0],v=h[1],E=Object(r.useState)(!1),w=Object(b.a)(E,2),k=w[0],P=w[1],C=function(){var a=Object(g.a)(f.a.mark(function a(n){var r;return f.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r=n.tokenAuth.token,t.handleAuthentication(r),localStorage.setItem(S,r),e.history.push("/");case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),F=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("_handleError run"),t.graphQLErrors&&(a=t.graphQLErrors[0].message.substring(0,15),x.startsWith(a)?(v(!0),console.log("invalid credentials")):(console.log("unexpect error(s):"),console.log(t),P(!0)));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),N=Object(O.a)(wt,{onCompleted:C,onError:F}),D=Object(b.a)(N,1)[0],A=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:D({variables:{username:c,password:m}}),t.preventDefault();case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return o.a.createElement(X.a,{className:a.paper,elevation:6},o.a.createElement("form",{onSubmit:A,className:a.form},o.a.createElement(U.a,{component:"h1",variant:"h5",className:a.root},"Log In"),o.a.createElement(ee.a,{className:a.root,variant:"outlined",required:!0,fullWidth:!0,id:"username",label:"Username",autoFocus:!0,onChange:function(e){return l(e.target.value)},error:y}),o.a.createElement(ee.a,{className:a.root,variant:"outlined",required:!0,fullWidth:!0,label:"Password",type:"password",id:"password",onChange:function(e){return d(e.target.value)},error:y,helperText:y?"Please enter valid credentials":""}),o.a.createElement(te.a,{container:!0,justify:"center",alignItems:"center",spacing:3},o.a.createElement(te.a,{item:!0,xs:6},o.a.createElement(Q.a,{className:a.root,name:"submit",label:"Submit",type:"submit",variant:"contained",color:"primary",fullWidth:!0},"Log In"),k&&o.a.createElement(ae.a,{error:k,className:a.root},"Unknown Error Occurred")),o.a.createElement(te.a,{item:!0,xs:6},o.a.createElement(ne.a,{component:T.b,to:"/signup",className:a.root,color:"inherit"},"Need an account? Sign up")))))}var Bt=function(e){return o.a.createElement(Re,null,o.a.createElement(te.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(te.a,{item:!0,xs:10,sm:8,md:6,lg:4},o.a.createElement(Wt,e))))},zt=new(a(214));zt.is().min(6).is().max(100).has().uppercase().has().digits().is().not().oneOf(["password","Password123"]);var Lt=function(e){for(var t="",a=0;a<e.length;a++){a>=1&&(t+=" | ");var n=e[a];"min"===n&&(t+="Password must be at least ".concat(6," characters long")),"max"===n&&(t+="Password must be at most ".concat(100," characters long")),"uppercase"===n&&(t+="Password must have an uppercase letter"),"digits"===n&&(t+="Password must have a digit"),"oneOf"===n&&(t+="Password is too common")}return t};function Rt(e){var t=Object(r.useState)(""),n=Object(b.a)(t,2),i=n[0],c=n[1],l=Object(r.useState)(""),s=Object(b.a)(l,2),u=s[0],m=s[1],d=Object(r.useState)(""),p=Object(b.a)(d,2),h=p[0],y=p[1],v=Object(r.useState)(""),E=Object(b.a)(v,2),j=E[0],w=E[1],S=Object(r.useState)(!1),x=Object(b.a)(S,2),P=x[0],C=x[1],F=Object(r.useState)(!1),N=Object(b.a)(F,2),D=N[0],A=(N[1],Object(r.useState)(!1)),I=Object(b.a)(A,2),$=I[0],W=I[1],B=Object(r.useState)([]),z=Object(b.a)(B,2),L=z[0],R=z[1],q=Object(r.useState)(!1),M=Object(b.a)(q,2),_=M[0],H=M[1],V=a(218),J=It(),Z=function(){var t=Object(g.a)(f.a.mark(function t(a){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.history.push("/login");case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),G=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("_handleError run"),t.graphQLErrors&&(a=t.graphQLErrors[0].message.substring(0,10),k.startsWith(a)?C(!0):(console.log("unexpect error(s):"),console.log(t),H(!0)));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),K=Object(O.a)(kt,{onCompleted:Z,onError:G}),Y=Object(b.a)(K,1)[0],re=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("form submitted"),Y({variables:{username:i,email:u,password:h}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:y(t),a=zt.validate(t,{list:!0}),R(a),0!==a.length?W(!1):W(!0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ie=!!h&&!$,ce=!!j&&!(j===h),le=!!h&&(!(j===h)||!$)||!!u&&!V.validate(u),se=!!u&&!V.validate(u),ue=D||se,me="";return se?me="Email is invalid":D&&(me="Email is taken"),o.a.createElement(X.a,{className:J.paper,elevation:6},o.a.createElement("form",{className:J.form,onSubmit:re},o.a.createElement(U.a,{component:"h1",variant:"h5",className:J.root},"Sign up"),o.a.createElement(ee.a,{className:J.root,onChange:function(e){return c(e.target.value)},variant:"outlined",required:!0,fullWidth:!0,autoComplete:"username",label:"Username",type:"username",autoFocus:!0,error:P,helperText:P?"Username is taken":""}),o.a.createElement(ee.a,{className:J.root,variant:"outlined",required:!0,fullWidth:!0,autoComplete:"email",label:"Email",type:"email",onChange:function(e){return m(e.target.value)},error:ue,helperText:me}),o.a.createElement(ee.a,{className:J.root,variant:"outlined",required:!0,fullWidth:!0,autoComplete:"password",label:"Password",type:"password",onChange:function(e){return oe(e.target.value)},error:ie,helperText:ie?Lt(L):""}),o.a.createElement(ee.a,{className:J.root,variant:"outlined",required:!0,fullWidth:!0,label:"Confirm Password",type:"password",onChange:function(e){return w(e.target.value)},error:ce,helperText:ce?"Passwords must match":""}),o.a.createElement(te.a,{container:!0,justify:"center",alignItems:"center",spacing:3},o.a.createElement(te.a,{item:!0,xs:6},o.a.createElement(Q.a,{className:J.root,fullWidth:!0,label:"Submit",type:"submit",variant:"contained",color:"primary",disabled:le},"Sign Up"),_&&o.a.createElement(ae.a,{error:_})),o.a.createElement(te.a,{item:!0,xs:6},o.a.createElement(ne.a,{className:J.root,component:T.b,to:"/login",color:"inherit"},"Already have an account? Log in")))))}var qt=function(e){return o.a.createElement(Re,null,o.a.createElement(te.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(te.a,{item:!0,xs:10,sm:8,md:6,lg:4},o.a.createElement(Rt,e))))};var Mt=function(){return Object(r.useContext)(j).logout(),o.a.createElement(D.a,{to:"/login"})},_t=a(314),Qt=a(311),Ut=a(315),Ht=a(316),Vt=a(89),Jt=a.n(Vt),Zt=function(e){var t=$t(),a=e.children,n=e.onClose;return o.a.createElement(_t.a,{disableTypography:!0,className:t.root},o.a.createElement(U.a,{variant:"h6"},a),n?o.a.createElement(ie.a,{"aria-label":"close",className:t.closeButton,onClick:n},o.a.createElement(Jt.a,null)):null)};function Gt(e){var t=$t(),a=Object(r.useContext)(j).user.username,n=Object(r.useState)(""),i=Object(b.a)(n,2),c=i[0],l=i[1],s=Object(r.useState)(""),u=Object(b.a)(s,2),m=u[0],d=u[1],p=Object(r.useState)(""),h=Object(b.a)(p,2),y=h[0],v=h[1],E=Object(r.useState)(!1),w=Object(b.a)(E,2),S=w[0],k=w[1],x=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),a=t.familyCreate.family.joinCode,v(a),k(!0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),P=Object(O.a)(xt,{onCompleted:x}),C=Object(b.a)(P,2),F=C[0],N=C[1].data,T=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("Family name: "+c),console.log("About: "+m),F({variables:{familyName:c,about:m}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),D=function(e){e.preventDefault(),k(!1)};return o.a.createElement("form",{className:t.form,onSubmit:T},o.a.createElement(te.a,{container:!0,spacing:1,className:t.outerContainer},o.a.createElement(te.a,{item:!0,xs:12,container:!0,justify:"center"},o.a.createElement(U.a,{variant:"h4",className:t.title},"Create Family"),o.a.createElement(U.a,{variant:"subtitle1",className:t.title},"Families are how you manage your artefacts. We recognise there is often complex overlap between families. That's why you can create and be a part of several families, so you can separate which of the artefacts you manage belong to which family.")),o.a.createElement(te.a,{item:!0,xs:12},o.a.createElement(X.a,{className:t.paperWrapper,elevation:3},o.a.createElement(Qt.a,{className:t.formControl,fullWidth:!0},o.a.createElement(ee.a,{variant:"outlined",required:!0,fullWidth:!0,id:"family-name",label:"Family name",autoFocus:!0,onChange:function(e){return l(e.target.value)}})))),o.a.createElement(te.a,{item:!0,xs:12},o.a.createElement(X.a,{className:t.paperWrapper,elevation:3},o.a.createElement(Qt.a,{className:t.formControl,fullWidth:!0},o.a.createElement(ee.a,{variant:"outlined",multiline:!0,rows:6,fullWidth:!0,id:"about",label:"Tell people about your family",onChange:function(e){return d(e.target.value)}})))),o.a.createElement(te.a,{item:!0,xs:12},o.a.createElement(X.a,{className:t.paperWrapper,elevation:3},o.a.createElement(Qt.a,{className:t.formControl,fullWidth:!0},o.a.createElement(ee.a,{variant:"outlined",disabled:!0,defaultValue:a,fullWidth:!0,id:"family-admin",label:"Family Admin",onChange:function(e){return console.log("hello")}})))),o.a.createElement(te.a,{item:!0,xs:5},o.a.createElement(Q.a,{name:"create",label:"Create",type:"submit",fullWidth:!0,variant:"contained",color:"primary"},"Create"))),N&&o.a.createElement(Ut.a,{open:S,onClose:D},o.a.createElement(Zt,{onClose:D},"Begin adding members to '",c,"'!"),o.a.createElement(Ht.a,null,o.a.createElement(U.a,{align:"center"},"Begin getting members to join your family! Simply share the code below to your family members, get them to sign up and then they can join!",o.a.createElement("br",null),y))))}var Kt=function(e){return o.a.createElement(Re,null,o.a.createElement(Y.a,null),o.a.createElement(te.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(te.a,{item:!0,xs:11,md:6},o.a.createElement(Gt,e))))},Yt=a(33),Xt=a(148),ea=function(e){var t=e.noErrors,a=Object(A.a)(e,["noErrors"]);return o.a.createElement(r.Fragment,null,o.a.createElement(Q.a,a,"Save"),!t&&o.a.createElement(ae.a,{error:!t},"Unknown Error Occurred"))},ta=function(e){var t=e.mode,a=e.classes,n=e.isAdmin,i=e.goToEdit,c=e.openDelete,l=e.noErrors,s=t.create,u=t.edit,m=t.view,d=m&&n,p=u&&n;return o.a.createElement(r.Fragment,null,(d||p||s)&&o.a.createElement("div",{className:a.editLinkButton,style:{marginRight:"auto",height:"20px",visibility:"hidden"}}),o.a.createElement(U.a,{variant:"h4",className:a.title},s&&"Create"," ",u&&"Edit"," ",m&&"View"," Artefact"),d&&o.a.createElement(Q.a,{color:"secondary",variant:"contained",onClick:i,className:a.editLinkButton,style:{marginLeft:"auto"}},"Edit"),p&&o.a.createElement(Q.a,{color:"default",variant:"contained",onClick:c,className:a.editLinkButton,style:{marginLeft:"auto"}},"Delete"),s&&o.a.createElement(ea,{noErrors:l,color:"secondary",variant:"contained",type:"submit",className:a.editLinkButton,style:{marginLeft:"auto"}}),s&&o.a.createElement(te.a,{item:!0,xs:12},o.a.createElement(U.a,{variant:"subtitle1",className:a.title},"Artefacts are belongings of the family, enter as much or as little detail as you like")))},aa=function(e){var t=e.mode,a=e.states,n=e.setters,r=e.disabled,i=e.name,c=t.view,l=a.state,s=n.handleSetField;return o.a.createElement(ee.a,{id:"artefact-name",label:"Artefact name",variant:"outlined",autoFocus:!c,required:!0,fullWidth:!0,value:l.name||"",inputProps:{readOnly:c},onChange:function(e){return s(i,e.target.value)},disabled:r})},na=function(e){var t=e.mode,a=e.states,n=e.setters,r=e.artefactStates,i=e.disabled,c=e.name,l=t.view,s=a.state,u=n.handleSetField;return o.a.createElement(ee.a,{id:"state",label:"Artefact State",variant:"outlined",required:!0,fullWidth:!0,value:s.state||"",inputProps:{readOnly:l},onChange:function(e){return u(c,e.target.value)},select:!0,disabled:i},Object.keys(r).map(function(e){return o.a.createElement(he.a,{value:r[e],key:e},e)}))},ra=function(e){var t=e.mode,a=e.states,n=e.setters,r=e.disabled,i=e.name,c=e.numFams,l=t.view,s=a.state,u=n.handleSetField;return o.a.createElement(ee.a,{id:"description",label:"Description",variant:"outlined",required:!0,fullWidth:!0,multiline:!0,rows:2*c>5?2*c:8,value:s.description||"",inputProps:{readOnly:l},onChange:function(e){return u(i,e.target.value)},disabled:r})},oa=function(e){var t=e.mode,a=e.states,n=e.username,r=t.view,i=a.state;return o.a.createElement(ee.a,{id:"artefact-admin",label:"Artefact Admin",variant:"outlined",required:!0,fullWidth:!0,value:i.admin&&0!==Object.keys(i.admin).length?i.admin.username:n,inputProps:{readOnly:r},onChange:function(e){return console.log("admin field was changed")},disabled:!0})},ia=a(325),ca=function(e){var t=e.mode,a=e.states,n=e.setters,r=e.disabled,i=e.name,c=t.view,l=a.state,s=n.handleSetField;return o.a.createElement(ia.a,{disabled:c||r,clearable:!0,minDate:"1500-01-01",inputVariant:"outlined",format:"dd/MM/yyyy",openTo:"year",label:"Date",value:l.date,onChange:function(e){return s(i,e)},KeyboardButtonProps:{"aria-label":"change date"}})},la=a(318),sa=a(319),ua=function(e){var t=e.mode,a=e.states,n=e.setters,i=e.disabled,c=e.name,l=e.classes,s=t.create,u=t.edit,m=a.state,d=n.handleSetField;return s||u?o.a.createElement(r.Fragment,null,o.a.createElement(U.a,{variant:"h6",className:l.fieldTitle},"Privacy"),o.a.createElement(la.a,{control:o.a.createElement(sa.a,{checked:m.isPublic||!1,onChange:function(e){return d(c,e.target.checked)},disabled:i}),style:{marginLeft:3},label:"Public"}),o.a.createElement(ae.a,{className:l.fieldTitle},m.isPublic?"Viewable by anyone":"Viewable by family members only")):null},ma=a(328);function da(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var pa=function(e){var t=e.mode,a=e.states,i=e.setters,c=e.families,l=e.disabled,s=e.name,u=e.classes,m=t.view,d=a.state,p=i.handleSetField;return m&&d.belongsToFamiliesBools&&0===Object.values(d.belongsToFamiliesBools).filter(function(e){return e}).length?o.a.createElement(U.a,{variant:"h6",className:u.fieldTitle},"This artefact doesn't belong to any of your families"):o.a.createElement(r.Fragment,null,o.a.createElement(U.a,{variant:"h6",className:u.fieldTitle},m?"Belongs to your families":"Families the artefact belongs to"),o.a.createElement(de.a,{disablePadding:!0},c.map(function(e){return!d.belongsToFamiliesBools||m&&!d.belongsToFamiliesBools[e.id]?null:o.a.createElement(pe.a,{key:e.id,dense:!0,disabled:l},!m&&o.a.createElement(fe.a,null,o.a.createElement(ma.a,{edge:"start",checked:d.belongsToFamiliesBools[e.id]||!1,onClick:function(t){return p(s,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?da(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):da(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},d.belongsToFamiliesBools,Object(n.a)({},e.id,t.target.checked)))},tabIndex:-1})),o.a.createElement(ge.a,{primary:e.familyName}))})))},fa=a(154),ga=a(141),ba=a.n(ga),ha=function(e){var t=e.mode,a=e.classes,n=e.states,i=e.setters,c=e.name,l=Object(Ce.a)(),s=t.edit,u=t.create,m=t.view,d=n.state,p=i.handleSetField;return o.a.createElement(r.Fragment,null,o.a.createElement(U.a,{variant:"h6",className:a.fieldTitle},"Images"),s&&o.a.createElement(U.a,{variant:"caption",className:a.fieldTitle},"Editing coming soon..."),u&&o.a.createElement(fa.a,{initialFiles:d.files||[],acceptedFiles:["image/*"],dropzoneText:"",filesLimit:1,onChange:function(e){return p(c,e)},dropzoneClass:a.dropzone,classes:{dropzoneTextStyle:a.fieldTitle,dropzoneParagraph:a.fieldTitle}}),(m||s)&&"False"!==d.upload&&o.a.createElement(ba.a,{src:C.mediaRoot+d.upload,loading:o.a.createElement(q,null),color:l.palette.background.paper,imageStyle:{borderRadius:10}}))},ya=a(293),va=a(142),Oa=a.n(va);function Ea(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}var ja=function(e){var t,a=e.mode,i=e.states,c=e.setters,l=e.classes,s=e.name,u=e.handleGeocodeQuery,m=e.disabled,d=a.view,p=c.handleSetField,f=c.setAddressIsSearchResult,g=c.setLocationState,b=c.handleSetLocationResult,h=i.locationState,y=i.state,v=Object(Ce.a)();return t=v&&"dark"===v.palette.type?"mapbox://styles/mapbox/dark-v10?optimize=true":"mapbox://styles/mapbox/streets-v9?optimize=true",o.a.createElement(r.Fragment,null,o.a.createElement(ee.a,{id:"address",label:"Address",variant:"outlined",fullWidth:!0,disabled:m,value:y.address||"",inputProps:{readOnly:d},onChange:function(e){p(s,e.target.value),e.target.value?f(!1):f(!0)},error:!!h.error,InputProps:{endAdornment:!d&&o.a.createElement(ie.a,{className:l.iconButton,"aria-label":"search",id:"search",onClick:function(e){return u({query:y.address,initial:!1})}},o.a.createElement(Oa.a,null)),style:{marginBottom:3}},onKeyDown:function(e){13!==e.keyCode||d||(e.preventDefault(),document.getElementById("search").click())},helperText:h.error}),o.a.createElement(ya.a,{id:h.queryResults.length?"results":void 0,open:!!h.queryResults.length,anchorEl:document.getElementById("address"),onClose:function(e){return g(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ea(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ea(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},h,{queryResults:[]}))},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},o.a.createElement(de.a,{component:"div",disablePadding:!0},h.queryResults.map(function(e){return o.a.createElement(pe.a,{key:e.placeName,button:!0,className:l.nested,onClick:function(t){return b(e)}},o.a.createElement(ge.a,{primary:e.placeName}))}))),o.a.createElement(te.a,{container:!0,style:{marginTop:1}},o.a.createElement(tt,{interactive:!1,className:l.map,mapState:h.mapState,mapStyle:t,containerStyle:{height:"60vh",width:"100vw",borderRadius:20,marginTop:5},artefacts:[{center:h.mapState.center,id:-1}]})))},wa=function(e){var t=e.save,a=e.cancel,n=e.updateErrors,r=e.classes;function i(e){return o.a.createElement(Q.a,{variant:"contained",color:e.color,className:r.button,onClick:e.onClick,fullWidth:!0,padding:1},e.name)}return o.a.createElement(te.a,{container:!0,justify:"space-evenly",alignItems:"center",spacing:1,style:{marginTop:1}},o.a.createElement(te.a,{item:!0,xs:6},o.a.createElement(i,{onClick:t,name:"Save",color:"primary"})),o.a.createElement(te.a,{item:!0,xs:6},o.a.createElement(i,{onClick:a,name:"Cancel",color:"secondary"})),n&&o.a.createElement(te.a,{item:!0,xs:12},o.a.createElement(ae.a,{error:!0},"Error Updating Artefact")))},Sa=function(e){var t=e.child,a=e.childProps,n=e.name,r=e.classes,i=e.editButtonProps,c=Object(A.a)(e,["child","childProps","name","classes","editButtonProps"]),l=a.beingEdited,s=l===n,u=a.mode.edit&&!!l;return o.a.createElement(X.a,{className:r.paperWrapper,elevation:3},o.a.createElement(Qt.a,{className:r.formControl,fullWidth:!0},o.a.createElement(t,Object.assign({},a,{disabled:u&&!s,name:n,classes:r},c)),s&&o.a.createElement(wa,i)))},ka=a(247),xa=a(320),Pa=function(e){var t=e.open,a=e.setOpen,n=e.viewArtefact,r=e.classes,i=e.id;return o.a.createElement(ka.a,{onClickAway:function(){return a(!1)}},o.a.createElement(xa.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:t,autoHideDuration:2e3,onClose:function(){return a(!1)},ContentProps:{"aria-describedby":"message-id"},message:o.a.createElement("span",{id:"message-id"},"Edit successful"),action:[o.a.createElement(Q.a,{key:"view",color:"secondary",size:"small",onClick:function(e){return n(i)}},"VIEW"),o.a.createElement(ie.a,{key:"close","aria-label":"close",color:"inherit",onClick:function(){return a(!1)},className:r.close},o.a.createElement(Jt.a,null))]}))},Ca=a(321),Fa=a(317),Na=function(e){var t=e.open,a=e.setOpen,n=e.deleteArtefact,r=e.artefact;return o.a.createElement(Ut.a,{fullWidth:!0,maxWidth:"sm",open:t,onClose:function(){return a(!1)},"aria-labelledby":"help-title"},o.a.createElement(_t.a,null,"Delete Artefact"),o.a.createElement(Ht.a,null,o.a.createElement(Ca.a,null,"This cannot be undone")),o.a.createElement(Fa.a,null,o.a.createElement(Q.a,{onClick:function(){return a(!1)},color:"secondary"},"Cancel"),o.a.createElement(Q.a,{onClick:function(){return n({variables:{id:r.id}})},color:"primary"},"Delete")))},Ta=a(143),Da=a.n(Ta);function Aa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Ia(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Aa(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Aa(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function $a(e){var t=e.create,a=e.edit,i=e.view,c={create:t,edit:a,view:i},l=e.statesLoading,s=e.familiesLoading,u=e.artefactLoading,m=e.artefactStates,d=e.families,p=Object(r.useContext)(j),h=p.user.username;if(!t)var y=u?{}:e.artefactData.artefact,v=!u&&y.admin.username===h;!v&&a&&(a=!1,i=!0);var E=$t(),w=Object(r.useState)(""),k=Object(b.a)(w,2),x=k[0],P=k[1],F=Object(r.useState)({}),N=Object(b.a)(F,2),T=N[0],D=N[1],A=Object(r.useState)(!1),I=Object(b.a)(A,2),$=I[0],W=I[1],B=Object(r.useState)(!1),z=Object(b.a)(B,2),L=z[0],R=z[1],M=Object(r.useState)({mapState:{},prevMapState:{},error:"",queryResults:[]}),_=Object(b.a)(M,2),Q=_[0],U=_[1],H=Object(r.useState)(!0),V=Object(b.a)(H,2),J=V[0],Z=V[1],G=function(e){var t=e.query,a=e.initial;if(t)return console.log("Query run with argument: ",t),ot(t).then(function(e){var t={};e.noErrors?t.error="No results":e.error&&(t.error="Unknown error occurred, check console for details",console.log(e.error)),a?(t.mapState=e.results[0].mapState,Z(!0)):t.queryResults=e.results,U(Ia({},Q,{},t))})},K=Object(r.useState)({}),Y=Object(b.a)(K,2),X=Y[0],ee=Y[1];if((a||i)&&!u&&0===Object.keys(X).length&&d){var ae={};d.map(function(e){return ae[e.id]=!1}),y.belongsToFamilies.map(function(e){return ae[e.id]=!0}),console.log(y),ee(Ia({},y,{belongsToFamiliesBools:ae})),G({query:y.address,initial:!0})}if(t&&d&&!X.belongsToFamiliesBools){var ne={};d.map(function(e){return ne[e.id]=!1}),ee({belongsToFamiliesBools:ne,date:null})}var re=function(e,t){a&&x!==e&&(P(e),D(X[e])),ee(Ia({},X,Object(n.a)({},e,t)))},oe=function(){U(Ia({},Q,{error:"Select a search result or clear search field before saving"}))},ie=function(t){var a=e.history;a&&a.push("/artefacts/".concat(t))},ce=function(){var t=e.history;t&&t.push("/")},le=function(e){console.log("here's the data"),console.log(e);var t=e.data.artefactCreate.artefact.id;ie(t)},se=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:P(""),W(!0);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ce();case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Creation errors occurred:",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Update errors occured: ",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.error("Deletion errors occured: ",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=Object(g.a)(f.a.mark(function e(t,a,n){var r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("here's input from call"),console.log(t),r=new FormData,X.files&&X.files.length&&r.append("itemImage",X.files[0]),r.append("query",yt),r.append("variables",JSON.stringify(t)),o=C.uri,Da.a.post(o,r,{headers:{Authorization:"JWT "+localStorage.getItem(S),"Content-Type":"application/x-www-form-urlencoded","Content-Transfer-Encoding":"multipart/form-data"}}).then(function(e){a(e.data)}).catch(function(e){n(e)});case 8:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),ge=Object(O.a)(jt,{onCompleted:se,onError:de}),be=Object(b.a)(ge,2),he=be[0],ye=be[1].error,ve=Object(O.a)(Pt,{onCompleted:ue,onError:pe}),Oe=Object(b.a)(ve,2),Ee=Oe[0],je=(Oe[1].error,function(e){return e?e.toISOString().slice(0,-1):null}),we=function(){var e=Object(g.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(J){e.next=3;break}return oe(),e.abrupt("return");case 3:a=[],X.belongsToFamiliesBools&&(a=Object.keys(X.belongsToFamiliesBools).filter(function(e){return X.belongsToFamiliesBools[e]})),n={name:X.name,description:X.description,state:X.state,isPublic:!!X.isPublic&&X.isPublic,belongsToFamilies:a,address:X.address?X.address:""},X.date&&(n.date=je(X.date)),fe(n,le,me);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Se=function(){var e=Object(g.a)(f.a.mark(function e(t){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=10;break}if(n={},J){e.next=7;break}return oe(),e.abrupt("return");case 7:"belongsToFamiliesBools"===x?n.belongsToFamilies=Object.keys(X.belongsToFamiliesBools).filter(function(e){return X.belongsToFamiliesBools[e]}):n[x]="date"===x?je(X[x]):X[x];case 8:console.log("Input to GQL update mutation: input",n),he({variables:{id:y.id,artefactInput:n}});case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();if((a||i)&&(s||l))return o.a.createElement(q,null);var ke={save:Se,cancel:function(){re(x,T),P(""),"address"===x&&U(Ia({},Q,{mapState:Q.prevMapState,queryResults:[],prevMapState:{}}))},updateErrors:ye,classes:E},xe={beingEdited:x,mode:c,artefactStates:m,username:p.user.username,families:d,states:{state:X,locationState:Q},setters:{handleSetField:re}},Pe=X.families?X.families.length:0,Ce=Ia({},xe,{handleGeocodeQuery:G,setters:Ia({},xe.setters,{setLocationState:U,setAddressIsSearchResult:Z,handleSetLocationResult:function(e){var t={mapState:e.mapState,error:"",queryResults:[]};"address"!==x||Q.prevMapState||(t.prevMapState=Q.mapState),re("address",e.placeName),U(Ia({},Q,{},t)),Z(!0)}})}),Fe=[{comp:aa,name:"name"},{comp:na,name:"state"},{comp:oa,name:"admin"},{comp:ca,name:"date"},{comp:pa,name:"belongsToFamiliesBools"},{comp:ra,name:"description"},{comp:i?null:ua,name:"isPublic"},{comp:ha,name:"files",widthProps:{xs:7}}];return o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t?we(e):Se(e)},className:E.form},o.a.createElement(te.a,{container:!0,className:E.outerContainer,spacing:1},o.a.createElement(te.a,{item:!0,xs:12,container:!0,justify:"center",alignItems:"center",spacing:1},o.a.createElement(ta,{mode:c,classes:E,isAdmin:v,goToEdit:function(){return function(t){var a=e.history;a&&a.push("/artefacts/edit/".concat(t))}(y.id)},openDelete:function(){return R(!0)},noErrors:!0})),Fe.map(function(e){var t=e.comp,a=e.name,n=e.widthProps;return null===t?null:(n||(n={xs:12,md:6}),o.a.createElement(te.a,Object.assign({container:!0,item:!0},n,{key:a}),o.a.createElement(Sa,{key:t,child:t,name:a,childProps:xe,editButtonProps:ke,classes:E,numFams:Pe})))}),o.a.createElement(te.a,{item:!0,xs:12},o.a.createElement(Sa,{child:ja,name:"address",childProps:Ce,editButtonProps:ke,classes:E})),o.a.createElement(Pa,{open:$,setOpen:W,viewArtefact:ie,classes:E,id:y?y.id:"-1"}),o.a.createElement(Na,{open:L,setOpen:R,deleteArtefact:Ee,artefact:y})))}var Wa=Object(D.g)(function(e){return o.a.createElement(Re,null,o.a.createElement(Yt.a,{utils:Xt.a},o.a.createElement(te.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"80vh"}},o.a.createElement(te.a,{item:!0,xs:11,md:8},o.a.createElement(Y.a,null),o.a.createElement($a,e)))))});function Ba(e){var t={child:At,childProps:{child:Wa},create:!0};return o.a.createElement(Tt,Object.assign({},e,t,{child:Ft}))}function za(e){var t={child:At,childProps:{child:Wa},view:!0};return o.a.createElement(Tt,Object.assign({},e,{child:Ft,childProps:t}))}function La(){var e=Object(h.a)(["\n    query artefactsQuery($first: Int!) {\n        me {\n            artefactAdministratorOf(first: $first) {\n                edges {\n                    node {\n                        id\n                        name\n                        description\n                        upload\n                    }\n                }\n            }\n        }\n    }\n"]);return La=function(){return e},e}var Ra=Object(L.a)(function(e){return{textField:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center",marginTop:e.spacing(1)},container:{padding:e.spacing(1),margin:e.spacing(1)},button:{margin:e.spacing(1)}}}),qa=v()(La());var Ma=function(e){var t=Ra(),a=Object(r.useState)([]),n=Object(b.a)(a,2),i=n[0],c=n[1],l=Object(O.b)(qa,{variables:{first:10},onCompleted:function(e){return c(e.me.artefactAdministratorOf.edges)}}),s=l.data,u=l.loading;return console.log("The data is: ",s),u?o.a.createElement("p",null,"Loading..."):o.a.createElement(Re,null,o.a.createElement(Y.a,null),o.a.createElement(te.a,{container:!0,spacing:2,className:t.container},o.a.createElement(te.a,{item:!0,xs:12},o.a.createElement(te.a,{container:!0,justify:"center",spacing:2},i.map(function(e){return o.a.createElement(te.a,{item:!0,key:e.node.id},o.a.createElement(Je,{artefact:e.node}))})))))};function _a(e){var t={child:At,childProps:{child:Wa},edit:!0};return o.a.createElement(Tt,Object.assign({},e,{child:Ft,childProps:t}))}function Qa(e){return o.a.createElement("div",{style:{padding:"50px"}},o.a.createElement("h1",{style:{color:"red"}},"404 Page Not Found"),o.a.createElement("h3",null,"If you're seeing this page..."),o.a.createElement("img",{src:"https://media0.giphy.com/media/KVZXay4Uduy8XHpZRc/giphy.gif",alt:""}),o.a.createElement("p",null,o.a.createElement("a",{href:"/"},"Return home")))}var Ua=a(322),Ha=a(323),Va=a(330),Ja=a(326);function Za(){var e=Object(h.a)(["\n    mutation SelectFamilyMutation($profileId: Int!, $toFamily: String!) {\n        updateProfile(input: { id: $profileId, selectedFamily: $toFamily }) {\n            id\n            selectedFamily\n        }\n    }\n"]);return Za=function(){return e},e}function Ga(){var e=Object(h.a)(["\n    mutation JoinFamily($joinCode: String!) {\n        familyJoin(joinCode: $joinCode) {\n            family {\n                familyName\n                familyAdmin {\n                    username\n                }\n            }\n        }\n    }\n"]);return Ga=function(){return e},e}function Ka(){var e=Object(h.a)(["\n    query {\n        me {\n            isMemberOf {\n                id\n                familyName\n                joinCode\n                hasArtefacts {\n                    edges {\n                        node {\n                            id\n                            name\n                            admin {\n                                username\n                            }\n                        }\n                    }\n                }\n            }\n            profile {\n                id\n                selectedFamily {\n                    id\n                    familyName\n                    joinCode\n                    hasArtefacts {\n                        edges {\n                            node {\n                                id\n                                name\n                                description\n                                upload\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n"]);return Ka=function(){return e},e}var Ya=Object(L.a)(function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},icon:{color:"rgba(255, 255, 255, 0.54)"}}}),Xa=v()(Ka()),en=v()(Ga()),tn=v()(Za());var an=function(e){var t=Ya(),a=Object(r.useContext)(j).user.username,n=Object(r.useState)(""),i=Object(b.a)(n,2),c=i[0],l=i[1],s=Object(O.a)(en,{refetchQueries:function(e){return[{query:Xa}]}}),u=Object(b.a)(s,2),m=u[0],d=(u[1].data,Object(O.b)(Xa,{onCompleted:function(e){!function(e){e.me.profile.selectedFamily||console.error("User has not selected a family")}(e)}})),p=d.data,f=d.loading,g=(d.called,Object(O.a)(tn,{refetchQueries:function(e){return[{query:Xa}]}})),h=Object(b.a)(g,2),y=h[0],v=(h[1].data,o.a.useRef(null));if(f)return o.a.createElement("p",null,"Loading...");var E=p.me.profile.selectedFamily,w=p.me.isMemberOf,S=p.me.profile.id,k=[];return E&&(k=p.me.profile.selectedFamily.hasArtefacts.edges),o.a.createElement(Re,null,o.a.createElement(Y.a,null),o.a.createElement(te.a,{container:!0,spacing:3},o.a.createElement(te.a,{item:!0,xs:9},E&&o.a.createElement("div",null,o.a.createElement(U.a,{variant:"h1"},E.familyName),o.a.createElement(U.a,{variant:"h5"},"Join code: ",E.joinCode)),!E&&o.a.createElement(U.a,{variant:"h2"},"Join and/or Select a Family"),o.a.createElement("h4",null,"Your username is (temp, for testing): ",a),o.a.createElement(Ua.a,{cellHeight:"auto",cols:2},k.map(function(e,t){return o.a.createElement(Ha.a,{key:t},o.a.createElement(Je,{key:t,artefact:e.node}))}))),o.a.createElement(te.a,{item:!0,xs:3},o.a.createElement(Va.a,{ref:v,htmlFor:"outlined-age-simple"},"Select Family"),o.a.createElement(Ja.a,{variant:"outlined",fullWidth:!0,disabled:w.length<=1,value:E?E.id:null,onChange:function(e){e.preventDefault();var t=e.target.value;y({variables:{profileId:S,toFamily:t}})},inputProps:{name:"age",id:"outlined-age-simple"}},w&&w.map(function(e,t){return o.a.createElement(he.a,{key:e.id,value:e.id},e.familyName)})),o.a.createElement(Qt.a,{fullWidth:!0},o.a.createElement(ee.a,{id:"joinCodeField",label:"Join a family",value:c,className:t.textField,margin:"normal",onChange:function(e){return l(e.target.value)},fullWidth:!0}),o.a.createElement(Q.a,{variant:"outlined",onClick:function(){0!==c.length?m({variables:{joinCode:c}}):console.error("Enter a valid joinCode")}},"Join Family")))))},nn=a(246),rn=a(144),on=a.n(rn),cn=a(146),ln=a.n(cn),sn=a(145),un=a.n(sn),mn=a(324);function dn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function pn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?dn(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):dn(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var fn=Object(L.a)(function(e){return{overlay:{position:"absolute",top:"70px",right:"5px",margin:e.spacing(1),minWidth:120},paper:{padding:e.spacing(1),margin:e.spacing(1),borderRadius:10},error:{backgroundColor:e.palette.error.dark},success:{backgroundColor:mn.a[600]},icon:{opacity:.9,marginRight:e.spacing(1),fontSize:20},message:{display:"flex",alignItems:"center"}}}),gn=function(){return o.a.createElement(r.Fragment,null,o.a.createElement(_t.a,{id:"help-title"},"Help"),o.a.createElement(Ht.a,null,o.a.createElement(Ca.a,null,"Select from your families in the corner to view their artefacts"),o.a.createElement(Ca.a,null,"Only artefacts with a location will be shown")),o.a.createElement(_t.a,{id:"help-title"},"Map Controls"),o.a.createElement(Ht.a,null,o.a.createElement(Ca.a,null,"Scroll to zoom"),o.a.createElement(Ca.a,null,"Click and drag to move"),o.a.createElement(Ca.a,null,"Click on an artefact to open a popup")))},bn=[{value:"mapbox://styles/mapbox/streets-v11",name:"Streets"},{value:"mapbox://styles/mapbox/satellite-v9",name:"Satellite"},{value:"mapbox://styles/mapbox/light-v10",name:"Light"},{value:"mapbox://styles/mapbox/dark-v10",name:"Dark"},{value:"mapbox://styles/zduffield/ck1q1hwgo2idy1cl3jt3rh1vk",name:"Ugly"}];function hn(e){var t=Object(Ce.a)(),a=fn(),i="mapbox://styles/mapbox/streets-v9?optimize=true";"dark"===t.palette.type&&(i="mapbox://styles/mapbox/dark-v10?optimize=true");var c=e.families,l=e.familiesLoading,s=Object(r.useState)({family:{id:"-1"},defaultMapStyle:i,mapStyle:i,selectedArtefact:{}}),u=Object(b.a)(s,2),m=u[0],d=u[1];m.defaultMapStyle!==i&&(m.mapStyle!==i?d(pn({},m,{defaultMapStyle:i,mapStyle:i})):d(pn({},m,{defaultMapStyle:i})));var p=Object(r.useState)([]),f=Object(b.a)(p,2),g=f[0],h=f[1],y=Object(r.useState)({zoom:[2]}),v=Object(b.a)(y,2),E=v[0],j=v[1],w=Object(r.useState)(!1),S=Object(b.a)(w,2),k=S[0],x=S[1],P=Object(r.useState)({open:!1,msg:""}),C=Object(b.a)(P,2),F=C[0],N=C[1],T=Object(r.useState)(!1),D=Object(b.a)(T,2),A=D[0],I=D[1];Object(O.b)(St,{variables:{id:m.family.id},onCompleted:function(e){if(e){$=e.family.hasArtefacts.edges.map(function(e){return e.node});for(var t=[],a=0;a<$.length;a++)$[a].address&&t.push(it($[a]).then(function(e){var t=e.response,a=e.artefact;if(!t.error)return pn({},a,{popup:!0,center:t.results[0].mapState.center,initPopupOpen:!1});console.log(t.error),N({open:!0,msg:"Error loading artefacts"})}));Promise.all(t).then(function(e){h(e),x(!0)})}},onError:function(e){m.family.id>0&&(N({open:!0,msg:"Error loading family"}),console.log(e))}});var $=[],W=function(e){e.target.value!==m.family&&("family"===e.target.name&&h([]),"selectedArtefact"===e.target.name&&(j(pn({},E,{center:e.target.value.center})),e.target.value.initPopupOpen=!0),d(pn({},m,Object(n.a)({},e.target.name,e.target.value))))};return o.a.createElement(X.a,{className:a.paper,elevation:10},o.a.createElement(te.a,{container:!0},o.a.createElement(tt,{interactive:!0,mapStyle:m.mapStyle,mapState:E,containerStyle:{height:"87vh",width:"100vw",position:"relative",zIndex:0,borderRadius:10},artefacts:g})),o.a.createElement(te.a,{container:!0,item:!0,xs:4,sm:1,className:a.overlay,justify:"flex-end"},!l&&o.a.createElement(te.a,{item:!0,xs:12},o.a.createElement(X.a,{className:a.paper},o.a.createElement(ee.a,{fullWidth:!0,label:"Family",variant:"outlined",value:m.family||{},select:!0,onChange:W,SelectProps:{name:"family",autoWidth:!0}},c.map(function(e){return o.a.createElement(he.a,{value:e,key:e.id},e.familyName)})))),o.a.createElement(te.a,{item:!0,xs:12},o.a.createElement(X.a,{className:a.paper},o.a.createElement(ee.a,{fullWidth:!0,label:"Map Style",variant:"outlined",value:m.mapStyle,select:!0,onChange:W,SelectProps:{name:"mapStyle",autoWidth:!0}},o.a.createElement(he.a,{value:i},"Default"),bn.map(function(e){return o.a.createElement(he.a,{value:e.value},e.name)})))),o.a.createElement(ie.a,{edge:"start",color:"inherit","aria-label":"menu",onClick:function(){return I(!0)}},o.a.createElement(on.a,null))),o.a.createElement(Ut.a,{fullWidth:!0,maxWidth:"sm",open:A,onClose:function(){return I(!1)},"aria-labelledby":"help-title"},o.a.createElement(gn,null),o.a.createElement(Fa.a,null,o.a.createElement(Q.a,{onClick:function(){return I(!1)},color:"primary"},"Close"))),o.a.createElement(xa.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:k,autoHideDuration:2e3,onClose:function(e){return x(!1)}},o.a.createElement(nn.a,{className:a.success,"aria-describedby":"success-message-id",message:o.a.createElement("span",{id:"success-message-id",className:a.message},o.a.createElement(un.a,{className:a.icon}),g.length," Artefacts Loaded")})),o.a.createElement(xa.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:F.open,autoHideDuration:2e3,onClose:function(e){return N({open:!1,msg:""})}},o.a.createElement(nn.a,{className:a.error,"aria-describedby":"err-message-id",message:o.a.createElement("span",{id:"err-message-id",className:a.message},o.a.createElement(ln.a,{className:a.icon}),F.msg)})))}var yn=function(e){return o.a.createElement(Re,null,o.a.createElement(Ft,Object.assign({},e,{child:hn})))};var vn=function(e){return o.a.createElement(T.a,null,o.a.createElement(Y.a,null),o.a.createElement("div",null,o.a.createElement(D.d,null,o.a.createElement(K,{exact:!0,path:"/",loggedIn:an,landingPage:!0}),o.a.createElement(D.b,{exact:!0,path:"/login/",component:Bt}),o.a.createElement(D.b,{exact:!0,path:"/signup/",component:qt}),o.a.createElement(D.b,{exact:!0,path:"/logout/",component:Mt}),o.a.createElement(K,{exact:!0,path:"/artefacts/create/",loggedIn:Ba,landingPage:!0}),o.a.createElement(K,{exact:!0,path:"/artefacts/manage/",loggedIn:Ma,landingPage:!0}),o.a.createElement(K,{exact:!0,path:"/artefacts/:id/",loggedIn:za,landingPage:!0}),o.a.createElement(K,{exact:!0,path:"/artefacts/edit/:id/",loggedIn:_a,landingPage:!0}),o.a.createElement(K,{exact:!0,path:"/family/create/",loggedIn:Kt,landingPage:!0}),o.a.createElement(K,{exact:!0,path:"/map/",loggedIn:yn,landingPage:!0}),o.a.createElement(D.b,{component:Qa}))))};function On(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function En(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?On(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):On(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var jn=Object(s.a)({uri:C.uri}),wn=Object(u.a)(function(e,t){var a=t.headers,n=localStorage.getItem(S);return{headers:En({},a,{authorization:n?"JWT ".concat(n):""})}}),Sn=new l.a({link:wn.concat(jn),cache:new m.a});c.a.render(o.a.createElement(d.a,{client:Sn},o.a.createElement(function(e){var t=this,a=Object(r.useState)(!1),n=Object(b.a)(a,2),i=n[0],c=n[1],l=Object(r.useState)({}),s=Object(b.a)(l,2),u=s[0],m=s[1],d=Object(r.useState)(""),p=Object(b.a)(d,2),h=p[0],y=p[1],v=Object(O.a)(N),E=Object(b.a)(v,2),j=E[0],k=E[1],x=k.error,P=k.loading,C=function(){var e=Object(g.a)(f.a.mark(function e(t,a){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(t=localStorage.getItem(S)),e.next=3,j({variables:{token:t}}).then(function(e){F(e),a&&a()}).catch(function(e){localStorage[S]="",a&&a()});case 3:if(!x){e.next=6;break}return console.log("[Error] handleAuthentication()"),e.abrupt("return");case 6:P&&console.log("Thing is loading");case 7:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),F=function(e){if(x)console.log("Invalid data, please sign in again");else{var t=e.data.verifyToken.payload.username;console.log("Here's the user id: ",e.data.verifyToken.payload.id);var a={username:t};c(!0),y(e.verifyToken),m(a)}},T={authenticated:i,authToken:h,user:u,initiateLogin:function(){t.history.pushState(null,"login")},handleAuthentication:C,logout:function(){console.log("Logout called"),c(!1),m({}),y(""),localStorage[S]=""}};return o.a.createElement(w,{value:T},e.children)},null,o.a.createElement(vn,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[174,1,2]]]);
//# sourceMappingURL=main.7fd86971.chunk.js.map