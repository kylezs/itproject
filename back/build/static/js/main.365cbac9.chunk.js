(window["webpackJsonpartefacts-app"]=window["webpackJsonpartefacts-app"]||[]).push([[0],{142:function(e,t,a){e.exports=a(188)},147:function(e,t,a){},188:function(e,t,a){"use strict";a.r(t);var n=a(13),r=a(0),o=a.n(r),c=a(14),i=a.n(c);a(147),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(50),s=a(124),u=a(121),m=a(123),d=a(27),p=a(10),f=a.n(p),g=a(16),b=a(9),h=a(18),E=a(19),v=a.n(E),y=a(15),O=Object(r.createContext)({authenticated:!1,user:{},authToken:"",initiateLogin:function(){},handleAuthentication:function(){},logout:function(){}}),j=O,k=O.Provider,w=(O.Consumer,"auth-token"),x="duplicate key",C="Please, enter valid credentials",S="pk.eyJ1IjoiemR1ZmZpZWxkIiwiYSI6ImNrMWdkODhpOTBiM28zZG03eDdjZ2dmN24ifQ.vAzlFYY5S9O82SKnwX69kQ",N={uri:"/graphql/"};function P(){var e=Object(h.a)(["\nmutation VerifyToken($token: String!) {\n    verifyToken(token: $token) {\n        payload\n    }\n}\n"]);return P=function(){return e},e}var T=v()(P());var F=a(17),A=a(49),I=a(3),W=a(72),$=a(47),B=a(108),D=a(109),L=a(127),q=a(110),R=a(235);var U=function(){var e=Object(q.a)(function(e){return{progress:{margin:e.spacing(2)}}})();return o.a.createElement(R.a,{className:e.progress})},z=a(244),_=a(240),M=a(241),Q=a(237),V=a(56),J=a(114),G=a.n(J),Z=a(115),H=a.n(Z),X=a(116),Y=a.n(X),K=a(236),ee=a(125),te=a(239),ae=a(113),ne=a.n(ae),re=function(e){var t=o.a.useState(null),a=Object(b.a)(t,2),n=a[0],c=a[1],i=Object(r.useContext)(j),l=Boolean(n);function s(){c(null)}return o.a.createElement("div",null,o.a.createElement(K.a,{component:F.b,to:"/family/create",color:"inherit"},"Create Family"),o.a.createElement(K.a,{component:F.b,to:"/artefacts/manage",color:"inherit"},"Manage Artefacts"),o.a.createElement(K.a,{component:F.b,to:"/artefacts/create",color:"inherit"},"Create Artefact"),o.a.createElement(Q.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){c(e.currentTarget)},color:"inherit"},o.a.createElement(ne.a,null)),o.a.createElement(ee.a,{id:"menu-appbar",anchorEl:n,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:s},o.a.createElement(te.a,{onClick:s},"Profile"),o.a.createElement(te.a,{onClick:s},"Settings"),o.a.createElement(te.a,{onClick:function(){i.logout()}},"Logout")))},oe=o.a.forwardRef(function(e,t){return o.a.createElement(F.b,Object.assign({innerRef:t,to:"/login"},e))}),ce=o.a.forwardRef(function(e,t){return o.a.createElement(F.b,Object.assign({innerRef:t,to:"/signup"},e))}),ie=function(e){return o.a.createElement("div",null,o.a.createElement(K.a,{color:"inherit",underline:"none",component:ce},"Sign up"),o.a.createElement(K.a,{color:"inherit",underline:"none",component:oe},"Login"))},le=a(242),se=a(128),ue=Object(q.a)(function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}});function me(e){var t=ue(),a=Object(r.useContext)(j).authenticated,n=Object(se.a)(),c=n&&"dark"===n.palette.type;return o.a.createElement("div",{className:t.root},o.a.createElement(_.a,{position:"static"},o.a.createElement(M.a,null,o.a.createElement(Q.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu"},o.a.createElement(G.a,null)),o.a.createElement(V.a,{variant:"h6",className:t.title},o.a.createElement(le.a,{component:F.b,to:"/",color:"inherit",variant:"inherit",underline:"none"},"Family AR")),o.a.createElement(Q.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",onClick:e.onToggleDarkTheme},c?o.a.createElement(Y.a,null):o.a.createElement(H.a,null)),a&&o.a.createElement(re,{username:null}),!a&&o.a.createElement(ie,null))))}var de=a(122),pe=a(243);function fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function ge(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fe(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fe(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var be=function(e){localStorage.getItem("theme-type")||(localStorage.setItem("theme-type","light"),console.log("here"));var t=Object(r.useState)({palette:{primary:{light:"#757ce8",main:"#3f50b5",dark:"#002884",contrastText:"#fff"},secondary:{light:"#ff7961",main:"#f44336",dark:"#ba000d",contrastText:"#000"},type:localStorage.getItem("theme-type")||"light"}}),a=Object(b.a)(t,2),n=a[0],c=a[1],i=Object(de.a)(n);return o.a.createElement("div",null,o.a.createElement(pe.a,{theme:i},o.a.createElement(me,{onToggleDarkTheme:function(){var e="light"===n.palette.type?"dark":"light";localStorage.setItem("theme-type",e),c({palette:ge({},n.palette,{type:e})})}}),o.a.createElement(z.a,null,e.children)))};var he=function(e){return o.a.createElement(be,null,"This is some cool landing page yo. Welcome!",o.a.createElement("br",null),"Also, in the future, this page should not have a navigation bar, it'll have cooler design stuff. It only has the nav bar for easier linking to signup / login for now")},Ee=function(e){function t(){var e,a;Object(W.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(B.a)(this,(e=Object(D.a)(t)).call.apply(e,[this].concat(r)))).state={checkAuthenticated:!1},a}return Object(L.a)(t,e),Object($.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.context.authenticated&&this.setState({checkAuthenticated:!0});var t=localStorage.getItem(w);!this.context.authenticated&&t?this.context.handleAuthentication(t,function(){console.log("Setting state"),e.setState({checkAuthenticated:!0})}):this.setState({checkAuthenticated:!0})}},{key:"render",value:function(){return this.props.children(this.state.checkAuthenticated)}}]),t}(r.Component);Ee.contextType=j;var ve=function(e){var t=e.loggedIn,a=e.loggedOut,n=(e.path,e.landingPage),c=Object(I.a)(e,["loggedIn","loggedOut","path","landingPage"]),i=Object(r.useContext)(j).authenticated;return a||(a="/login"),console.log("Authenticated: ",i),o.a.createElement(Ee,null,function(e){return!1===e?o.a.createElement(U,null):o.a.createElement(A.b,Object.assign({},c,{render:function(e){return i?o.a.createElement(t,e):!i&&n?o.a.createElement(he,null):o.a.createElement(A.a,{to:a})}}))})},ye=a(251),Oe=a(91),je=a(245),ke=a(267),we=a(248);function xe(){var e=Object(h.a)(["\n    mutation TokenAuth($username: String!, $password: String!) {\n        tokenAuth(username: $username, password: $password) {\n            token\n        }\n    }\n"]);return xe=function(){return e},e}function Ce(){var e=Object(h.a)(["\n    mutation UpdateArtefactMutation(\n        $id: ID!\n        $artefactInput: ArtefactInputType!\n    ) {\n        artefactUpdate(id: $id, input: $artefactInput) {\n            artefact {\n                id\n            }\n        }\n    }\n"]);return Ce=function(){return e},e}function Se(){var e=Object(h.a)(["\n    query DetailView($id: ID!) {\n        artefact(id: $id) {\n            id\n            name\n            description\n            admin {\n                id\n                username\n            }\n            state\n            isPublic\n            upload\n            belongsToFamilies {\n                id\n            }\n            addedAt\n            address\n        }\n    }\n"]);return Se=function(){return e},e}function Ne(){var e=Object(h.a)(["\n    query artefactsQuery {\n        me {\n            isMemberOf {\n                familyName\n                id\n            }\n        }\n    }\n"]);return Ne=function(){return e},e}function Pe(){var e=Object(h.a)(["\n    query ArtefactStatesQuery($name: String!) {\n        __type(name: $name) {\n            enumValues {\n                name\n                description\n            }\n        }\n    }\n"]);return Pe=function(){return e},e}function Te(){var e=Object(h.a)(["\n    mutation CreateArtefactMutation(\n        $name: String!\n        $state: String!\n        $isPublic: Boolean\n        $description: String!\n        $belongsToFamilies: [ID]\n        $address: String\n    ) {\n        artefactCreate(\n            input: {\n                name: $name\n                state: $state\n                description: $description\n                isPublic: $isPublic\n                belongsToFamilies: $belongsToFamilies\n                address: $address\n            }\n        ) {\n            artefact {\n                id\n            }\n        }\n    }\n"]);return Te=function(){return e},e}var Fe=v()(Te()),Ae=v()(Pe()),Ie=v()(Ne()),We=v()(Se()),$e=v()(Ce()),Be=v()(xe()),De=Object(q.a)(function(e){return{"@global":{body:{backgroundColor:e.palette.background.paper}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:e.palette.background.paper},form:{width:"50%",marginTop:e.spacing(3),backgroundColor:e.palette.background.paper},submit:{margin:e.spacing(3,0,2)}}});var Le=function(e){var t=Object(r.useContext)(j),a=De(),n=Object(r.useState)(""),c=Object(b.a)(n,2),i=c[0],l=c[1],s=Object(r.useState)(""),u=Object(b.a)(s,2),m=u[0],d=u[1],p=Object(r.useState)(!1),h=Object(b.a)(p,2),E=h[0],v=h[1],O=Object(r.useState)(!1),k=Object(b.a)(O,2),x=k[0],S=k[1],N=function(){var a=Object(g.a)(f.a.mark(function a(n){var r;return f.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r=n.tokenAuth.token,console.log("getting token first in confirm mutation"),t.handleAuthentication(r),localStorage.setItem(w,r),e.history.push("/");case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),P=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("_handleError run"),t.graphQLErrors&&(a=t.graphQLErrors[0].message.substring(0,15),C.startsWith(a)?(v(!0),console.log("invalid credentials")):(console.log("unexpect error(s):"),console.log(t),S(!0)));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),T=Object(y.a)(Be,{onCompleted:N,onError:P}),A=Object(b.a)(T,1)[0],I=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:A({variables:{username:i,password:m}}),t.preventDefault();case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return o.a.createElement("form",{className:a.form,onSubmit:I},o.a.createElement(z.a,{justifyContent:"center"},o.a.createElement(Oe.a,{className:a.paper},o.a.createElement(je.a,{container:!0,spacing:2},o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(V.a,{component:"h1",variant:"h5"},"Log In")),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(ke.a,{variant:"outlined",required:!0,fullWidth:!0,id:"username",label:"Username",autoFocus:!0,onChange:function(e){return l(e.target.value)},error:E})),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(ke.a,{variant:"outlined",required:!0,fullWidth:!0,label:"Password",type:"password",id:"password",onChange:function(e){return d(e.target.value)},error:E}),E&&o.a.createElement(we.a,{id:"password",error:E},"Please enter valid credentials")),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(K.a,{name:"submit",label:"Submit",type:"submit",fullWidth:!0,variant:"contained",color:"primary"},"Log In"),x&&o.a.createElement(we.a,{id:"password",error:x},"Unknown Error Occurred")),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(je.a,{item:!0},o.a.createElement(le.a,{component:F.b,to:"/signup"},"Need an account? Sign up")))))))},qe=new(a(156));qe.is().min(6).is().max(100).has().uppercase().has().digits().is().not().oneOf(["password","Password123"]);var Re=function(e){for(var t="",a=0;a<e.length;a++){a>=1&&(t+=" | ");var n=e[a];"min"===n&&(t+="Password must be at least ".concat(6," characters long")),"max"===n&&(t+="Password must be at most ".concat(100," characters long")),"uppercase"===n&&(t+="Password must have an uppercase letter"),"digits"===n&&(t+="Password must have a digit"),"oneOf"===n&&(t+="Password is too common")}return t};function Ue(){var e=Object(h.a)(["\n    mutation SignupMutation(\n        $email: String!\n        $password: String!\n        $username: String!\n    ) {\n        createUser(email: $email, username: $username, password: $password) {\n            user {\n                id\n                username\n                email\n            }\n        }\n    }\n"]);return Ue=function(){return e},e}var ze=v()(Ue()),_e=Object(q.a)(function(e){return{"@global":{body:{backgroundColor:e.palette.background.paper}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:e.palette.background.paper},form:{width:"50%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}});var Me=function(e){var t=Object(r.useState)(""),n=Object(b.a)(t,2),c=n[0],i=n[1],l=Object(r.useState)(""),s=Object(b.a)(l,2),u=s[0],m=s[1],d=Object(r.useState)(""),p=Object(b.a)(d,2),h=p[0],E=p[1],v=Object(r.useState)(""),O=Object(b.a)(v,2),j=O[0],k=O[1],w=Object(r.useState)(!1),C=Object(b.a)(w,2),S=C[0],N=C[1],P=Object(r.useState)(!1),T=Object(b.a)(P,2),A=T[0],I=(T[1],Object(r.useState)(!1)),W=Object(b.a)(I,2),$=W[0],B=W[1],D=Object(r.useState)([]),L=Object(b.a)(D,2),q=L[0],R=L[1],U=Object(r.useState)(!1),z=Object(b.a)(U,2),_=z[0],M=z[1],Q=a(160),J=_e(),G=function(){var t=Object(g.a)(f.a.mark(function t(a){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.history.push("/login");case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),Z=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("_handleError run"),t.graphQLErrors&&(a=t.graphQLErrors[0].message.substring(0,10),x.startsWith(a)?N(!0):(console.log("unexpect error(s):"),console.log(t),M(!0)));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),H=Object(y.a)(ze,{onCompleted:G,onError:Z}),X=Object(b.a)(H,1)[0],Y=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("form submitted"),X({variables:{username:c,email:u,password:h}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:E(t),a=qe.validate(t,{list:!0}),R(a),0!==a.length?B(!1):B(!0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),te=!!h&&!$,ae=!!j&&!(j===h),ne=!!h&&(!(j===h)||!$)||!!u&&!Q.validate(u);return o.a.createElement(Oe.a,{className:J.paper},o.a.createElement("form",{className:J.form,onSubmit:Y},o.a.createElement(je.a,{container:!0,spacing:2},o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(V.a,{component:"h1",variant:"h5"},"Sign up")),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(ke.a,{autoComplete:"username",name:"username",variant:"outlined",required:!0,fullWidth:!0,id:"username",label:"Username",autoFocus:!0,error:S,onChange:function(e){return i(e.target.value)}}),S&&o.a.createElement(we.a,{id:"username",error:S},"Username is taken")),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(ke.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",type:"email",error:A||!!u&&!Q.validate(u),onChange:function(e){return m(e.target.value)}}),!!u&&!Q.validate(u)&&o.a.createElement(we.a,{id:"email",error:!Q.validate(u)},"Email is invalid"),A&&o.a.createElement(we.a,{id:"email",error:A},"Email is taken")),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(ke.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(e){return ee(e.target.value)},error:te}),te&&o.a.createElement(we.a,{id:"password",error:te},Re(q))),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(ke.a,{variant:"outlined",required:!0,fullWidth:!0,name:"confirmPassword",label:"Confirm Password",type:"password",id:"confirmPassword",autoComplete:"current-password",onChange:function(e){return k(e.target.value)},error:ae}),ae&&o.a.createElement(we.a,{id:"confirmPassword",error:ae},"Passwords must match")),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(K.a,{name:"submit",label:"Submit",type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:ne},"Sign Up"),_&&o.a.createElement(we.a,{error:_},"Unknown Error Occurred")),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(je.a,{item:!0},o.a.createElement(le.a,{component:F.b,to:"/login"},"Already have an account? Log in"))))))};var Qe=function(){return Object(r.useContext)(j).logout(),o.a.createElement(A.a,{to:"/login"})},Ve=a(6),Je=a(268),Ge=a(249),Ze=a(250),He=a(81),Xe=a.n(He);function Ye(){var e=Object(h.a)(["\n    mutation FamilyCreate($familyName: String!, $about: String) {\n        familyCreate(input: { familyName: $familyName, about: $about }) {\n            family {\n                familyName\n                joinCode\n            }\n        }\n    }\n"]);return Ye=function(){return e},e}var Ke=Object(q.a)(function(e){return{textField:{padding:e.spacing(1),textAlign:"center",marginTop:e.spacing(1)},paper:{marginTop:e.spacing(1),padding:e.spacing(1),textAlign:"center"},button:{margin:e.spacing(1)}}}),et=v()(Ye()),tt=Object(Ve.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose;return o.a.createElement(Ge.a,{disableTypography:!0,className:a.root},o.a.createElement(V.a,{variant:"h6"},t),n?o.a.createElement(Q.a,{"aria-label":"close",className:a.closeButton,onClick:n},o.a.createElement(Xe.a,null)):null)}),at=Object(Ve.a)(function(e){return{root:{padding:e.spacing(2)}}})(Ze.a);function nt(e){var t=Ke(),a=Object(r.useContext)(j).user.username,n=Object(r.useState)(""),c=Object(b.a)(n,2),i=c[0],l=c[1],s=Object(r.useState)(""),u=Object(b.a)(s,2),m=u[0],d=u[1],p=Object(r.useState)(""),h=Object(b.a)(p,2),E=h[0],v=h[1],O=Object(r.useState)(!1),k=Object(b.a)(O,2),w=k[0],x=k[1],C=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),a=t.familyCreate.family.joinCode,v(a),x(!0);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),S=Object(y.a)(et,{onCompleted:C}),N=Object(b.a)(S,2),P=N[0],T=N[1].data,F=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("Family name: "+i),console.log("About: "+m),P({variables:{familyName:i,about:m}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),A=function(e){e.preventDefault(),x(!1)};return o.a.createElement(be,null,o.a.createElement(ye.a,null),o.a.createElement("form",{className:t.form,onSubmit:F},o.a.createElement(je.a,{container:!0,spacing:2,direction:"row",alignItems:"stretch",alignContent:"stretch",justify:"space-evenly"},o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:t.paper},o.a.createElement(V.a,{variant:"h4"},"Create Family"),o.a.createElement(V.a,{variant:"subtitle1"},"Families are how you manage your artefacts. We recognise there is often complex overlap between families. That's why you can create and be a part of several families, so you can separate which of the artefacts you manage belong to which family."))),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:t.paper},o.a.createElement(ke.a,{className:t.textField,variant:"outlined",required:!0,fullWidth:!0,id:"family-name",label:"Family name",autoFocus:!0,onChange:function(e){return l(e.target.value)}}))),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:t.paper},o.a.createElement(ke.a,{className:t.textField,variant:"outlined",multiline:!0,rows:6,fullWidth:!0,id:"about",label:"Tell people about your family",onChange:function(e){return d(e.target.value)}}))),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:t.paper},o.a.createElement(ke.a,{className:t.textField,variant:"outlined",disabled:!0,defaultValue:a,fullWidth:!0,id:"family-admin",label:"Family Admin",onChange:function(e){return console.log("hello")}}))),o.a.createElement(je.a,{item:!0,xs:6},o.a.createElement(K.a,{name:"create",label:"Create",type:"submit",fullWidth:!0,variant:"contained",color:"primary"},"Create")))),T&&o.a.createElement(Je.a,{open:w,onClose:A},o.a.createElement(tt,{onClose:A},"Begin adding members to '",i,"'!"),o.a.createElement(at,null,o.a.createElement(V.a,{align:"center"},"Begin getting members to join your family! Simply share the code below to your family members, get them to sign up and then they can join!",o.a.createElement("br",null),E))))}var rt=a(247),ot=a(252),ct=a(238),it=a(253),lt=a(191),st=a(254),ut=a(266),mt=a(255),dt=a(256),pt=a(193),ft=a(90),gt=a(169)({accessToken:S}),bt=function(e){var t={};console.log("GEOCODING RESPONSE: ",e.body);var a=e.body.features;if(!a)return t.noResults=!0,t;for(var n=[],r=0;r<a.length;r++){var o=a[r],c={};if(c.mapState={center:o.center},"place"===o.place_type[0]){var i=o.bbox,l=[[i[0],i[1]],[i[2],i[3]]];c.mapState.fitBounds=l}else"address"===o.place_type[0]&&(c.mapState.zoom=[15]);c.placeName=o.place_name,c.locationType=o.place_type[0],n.push(c)}return t.results=n,t},ht=function(e){var t={};return console.log("query error occurred"),t.error=e,t},Et=function(e,t){if(!e)return new Promise(function(e,t){e()});var a={query:e,limit:5};return t&&(a.types=t),"object"===typeof e?gt.reverseGeocode(a).send().then(function(e){return bt(e)},function(e){return ht(e)}):"string"===typeof e?gt.forwardGeocode(a).send().then(function(e){return bt(e)},function(e){return ht(e)}):void 0},vt=Object(ft.b)({accessToken:S,interactive:!0,attributionControl:!1,maxZoom:18});function yt(e){return o.a.createElement(vt,Object.assign({style:e.mapStyle?e.mapStyle:"mapbox://styles/mapbox/streets-v9?optimize=true",containerStyle:{height:"60vh",width:"100vw"}},e.mapState),e.mapState&&e.mapState.center&&o.a.createElement(ft.a,{coordinates:e.mapState.center},o.a.createElement("img",{src:"http://maps.google.com/mapfiles/ms/icons/red.png",alt:"marker-img"})))}var Ot=a(126),jt=a(120),kt=a.n(jt);function wt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function xt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?wt(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wt(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Ct=Object(q.a)(function(e){return{root:{width:"100%",height:"100%",backgroundColor:e.palette.background.paper,justifyContent:"center"},formControl:{height:"100%",justifyContent:"center"},title:{marginLeft:e.spacing(3),marginRight:e.spacing(3),padding:e.spacing(1),textAlign:"center"},paper:{padding:e.spacing(1),backgroundColor:e.palette.background.paper},paperTextWrapper:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,height:"100%",alignItems:"center"},button:{height:"100%"},map:{height:"200px",type:e.palette.type},form:{marginBottom:e.spacing(10),marginTop:e.spacing(2),display:"flex",flexWrap:"wrap"},iconButton:{padding:10},dropzone:{backgroundColor:e.palette.background.paper,minHeight:"80px"}}});var St=Object(A.g)(function(e){var t=!0,a=!1;"edit"===e.mode?(t=!1,a=!0):"create"!==e.mode&&console.log("unknown mode provided, defaulted to create");var c=Object(se.a)(),i=Ct(),l=Object(r.useContext)(j),s=Object(r.useState)(""),u=Object(b.a)(s,2),m=u[0],d=u[1],p=Object(r.useState)({}),h=Object(b.a)(p,2),E=h[0],v=h[1],O=Object(r.useState)({}),k=Object(b.a)(O,2),w=k[0],x=k[1],C=Object(r.useState)(!1),S=Object(b.a)(C,2),N=S[0],P=S[1],T=Object(r.useState)({mapState:{},locationError:""}),F=Object(b.a)(T,2),A=F[0],I=F[1],W=Object(r.useState)(!0),$=Object(b.a)(W,2),B=$[0],D=$[1],L=Object(r.useState)([]),q=Object(b.a)(L,2),R=q[0],z=q[1],_=Object(r.useState)({}),M=Object(b.a)(_,2),J=M[0],G=M[1],Z=Object.keys(J).length;if(a&&0!==Object.keys(e.artefact).length&&0===Z){var H={};e.artefact.belongsToFamilies.map(function(e){return H[e.id]=!0});var X="";console.log("Query run with argument: ",e.artefact.address),Et(e.artefact.address).then(function(t){if(e.artefact.address){var a="";console.log("response: ",t),t.error&&(a="Unknown error occurred, check console for details",console.log(t.error)),t.noResults&&e.artefact.address&&(a="No results"),a?I(xt({},A,{locationError:a})):(I({mapState:t.results[0].mapState,locationError:""}),X=t.results[0].placeName)}}).then(function(t){console.log(X),G(xt({},e.artefact,{belongsToFamiliesBools:H,address:X})),D(!0)})}var Y=function(t){var a=e.history;a&&a.push("/artefacts/".concat(t))},ee=function(){var e=Object(g.a)(f.a.mark(function e(t){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.artefactCreate.artefact.id,Y(a);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Creation errors occurred:",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("update error occured: ",t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),re=Object(y.a)(Fe,{onCompleted:ee,onError:ae}),oe=Object(b.a)(re,2),ce=oe[0],ie=oe[1],le=ie.error,ue=ie.loading,me=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d(""),P(!0);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),de=Object(y.a)($e,{onCompleted:me,onError:ne}),pe=Object(b.a)(de,2),fe=pe[0],ge=pe[1].error,be=function(e,t){var r=J[e];G(xt({},J,Object(n.a)({},e,t))),a&&m!==e&&v(r)},he=function(e,t,r){"belongsToFamiliesBools"===e&&(t=xt({},J.belongsToFamiliesBools,Object(n.a)({},r,t))),be(e,t),x(t),a&&m!==e&&d(e)},Ee=function(e){if(e)return console.log("Query run with argument: ",e),Et(e,["place","address"]).then(function(e){var t="";return e.error&&(t="Unknown error occurred, check console for details",console.log(e.error)),e.noErrors&&(t="No results"),t?I(xt({},A,{locationError:t})):z(e.results),e})},ve=function(){be(m,E),d(""),"address"===m&&Ee(E)},xe=function(){I(xt({},A,{locationError:"Select a search result or clear search field"}))},Ce=function(){var e=Object(g.a)(f.a.mark(function e(t){var a,n,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=3;break}return xe(),e.abrupt("return");case 3:(a=new FileReader).onabort=function(){return console.log("file reading was aborted")},a.onerror=function(){return console.log("file reading has failed")},a.onload=function(){var e=a.result;console.log(e)},J.files&&J.files.forEach(function(e){return a.readAsArrayBuffer(e)}),n=J.belongsToFamiliesBools?Object.keys(J.belongsToFamiliesBools).filter(function(e){return J.belongsToFamiliesBools[e]}):[],r={name:J.name,description:J.description,state:J.state,isPublic:!!J.isPublic&&J.isPublic,belongsToFamilies:n,address:J.address?J.address:""},console.log("Input to GQL creation mutation:",r),ce({variables:r});case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Se=function(){var t=Object(g.a)(f.a.mark(function t(n){var r;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=8;break}if(r={},B){t.next=5;break}return xe(),t.abrupt("return");case 5:r[m]="belongsToFamiliesBools"===m?Object.keys(J.belongsToFamiliesBools).filter(function(e){return J.belongsToFamiliesBools[e]}):w,console.log("Input to GQL update mutation: input",r),fe({variables:{id:e.artefact.id,artefactInput:r}});case 8:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();function Ne(){return o.a.createElement(K.a,{variant:"contained",color:"primary",type:"submit",className:i.button,onClick:Se,fullWidth:!0,padding:1},"Save")}function Pe(){return o.a.createElement(K.a,{variant:"contained",color:"default",className:i.button,onClick:ve,fullWidth:!0,padding:1},"Cancel")}function Te(){return o.a.createElement(je.a,{container:!0,justify:"space-evenly",alignItems:"center",spacing:1,style:{marginTop:1}},o.a.createElement(je.a,{item:!0,xs:6},o.a.createElement(Ne,null)),o.a.createElement(je.a,{item:!0,xs:6},o.a.createElement(Pe,null)),ge&&o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(we.a,{error:!0},"Error Updating Artefact")))}function Ae(e,t){"clickaway"!==t&&P(!1)}var Ie,We=!le,Be=e.familyLoading||e.statesLoading;return Ie=c&&"dark"===c.palette.type?"mapbox://styles/mapbox/dark-v10?optimize=true":"mapbox://styles/mapbox/light-v10?optimize=true",a&&Be?o.a.createElement(U,null):o.a.createElement(r.Fragment,null,o.a.createElement(ye.a,null),o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t?Ce(e):Se(e)},className:i.form},o.a.createElement(je.a,{container:!0,spacing:1,alignItems:"stretch",alignContent:"stretch",justify:"space-evenly"},o.a.createElement(je.a,{item:!0,xs:12,container:!0,justify:"center"},o.a.createElement(je.a,{item:!0,xs:12,sm:8},o.a.createElement(V.a,{variant:"h4",className:i.title},t?"Create":"Edit"," Artefact"),o.a.createElement(V.a,{variant:"subtitle1",className:i.title},t?"Artefacts are belongings of the family, enter as much or as little detail as you like":"Click to start editing"))),o.a.createElement(je.a,{item:!0,xs:12,sm:6,container:!0,spacing:1},o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:i.paperTextWrapper},o.a.createElement(rt.a,{className:i.formControl,fullWidth:!0},o.a.createElement(ke.a,{id:"artefact-name",label:"Artefact name",variant:"outlined",required:!0,fullWidth:!0,value:J.name||"",onChange:function(e){return he("name",e.target.value)},disabled:a&&!!m&&"name"!==m}),a&&"name"===m&&o.a.createElement(Te,null)))),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:i.paperTextWrapper},o.a.createElement(rt.a,{className:i.formControl,fullWidth:!0},o.a.createElement(ke.a,{id:"state",label:"Artefact State",variant:"outlined",required:!0,fullWidth:!0,value:J.state||"",onChange:function(e){return he("state",e.target.value)},select:!0,disabled:a&&!!m&&"state"!==m},Object.keys(e.artefactStates).map(function(t){return o.a.createElement(te.a,{value:e.artefactStates[t],key:t},t)})),a&&"state"===m&&o.a.createElement(Te,null)))),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:i.paperTextWrapper},o.a.createElement(rt.a,{className:i.formControl,fullWidth:!0},o.a.createElement(ke.a,{id:"description",label:"Description",variant:"outlined",required:!0,fullWidth:!0,multiline:!0,rows:6,value:J.description||"",onChange:function(e){return he("description",e.target.value)},disabled:a&&!!m&&"description"!==m}),a&&"description"===m&&o.a.createElement(Te,null)))),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:i.paperTextWrapper},o.a.createElement(rt.a,{className:i.formControl,fullWidth:!0},o.a.createElement(ke.a,{id:"artefact-admin",label:"Artefact Admin",variant:"outlined",required:!0,fullWidth:!0,value:J.admin&&0!==Object.keys(J.admin).length?J.admin.username:l.user.username,onChange:function(e){return console.log("admin field was changed")},disabled:!0}))))),o.a.createElement(je.a,{item:!0,xs:12,sm:6,container:!0,spacing:1,alignContent:"stretch"},o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:i.paper},o.a.createElement(rt.a,{className:i.formControl,fullWidth:!0},o.a.createElement(ct.a,{subheader:o.a.createElement(it.a,{component:"div"},"Privacy"),dense:!0},o.a.createElement(lt.a,{disabled:a&&!!m&&"isPublic"!==m},o.a.createElement(st.a,null,o.a.createElement(ut.a,{edge:"start",checked:J.isPublic||!1,tabIndex:-1,onClick:function(e){return he("isPublic",e.target.checked)}})),o.a.createElement(mt.a,{primary:"Public"}))),a&&"isPublic"===m&&o.a.createElement(Te,null)))),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:i.paper},o.a.createElement(rt.a,{className:i.formControl,fullWidth:!0},o.a.createElement(ct.a,{subheader:o.a.createElement(it.a,{component:"div"},"Select which of your families the artefact belongs to")},e.families.map(function(e){return J.belongsToFamiliesBools&&!J.belongsToFamiliesBools[e.id]&&(J.belongsToFamiliesBools[e.id]=!1),o.a.createElement(lt.a,{key:e.id,dense:!0,disabled:a&&!!m&&"belongsToFamiliesBools"!==m},o.a.createElement(st.a,null,o.a.createElement(ut.a,{edge:"start",checked:J.belongsToFamiliesBools&&J.belongsToFamiliesBools[e.id]||!1,onClick:function(t){return he("belongsToFamiliesBools",t.target.checked,e.id)},tabIndex:-1})),o.a.createElement(mt.a,{primary:e.familyName}))})),a&&"belongsToFamiliesBools"===m&&o.a.createElement(Te,null)))),o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:i.paper},o.a.createElement(Ot.a,{initialFiles:J.files||[],onChange:function(e){return he("files",e)},disabled:a&&!!m&&"files"!==m,dropzoneClass:i.dropzone})))),o.a.createElement(je.a,{container:!0,item:!0,xs:12,spacing:1},o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(Oe.a,{className:i.paperTextWrapper},o.a.createElement(rt.a,{className:i.formControl,fullWidth:!0},o.a.createElement(ke.a,{id:"address",label:"Address",variant:"outlined",fullWidth:!0,value:J.address||"",onChange:function(e){G(xt({},J,{address:e.target.value})),e.target.value?D(!1):D(!0)},error:!!A.locationError,InputProps:{endAdornment:o.a.createElement(Q.a,{className:i.iconButton,"aria-label":"search",id:"search",onClick:function(){return Ee(J.address)}},o.a.createElement(kt.a,null)),style:{marginBottom:3}},onKeyDown:function(e){13===e.keyCode&&(e.preventDefault(),document.getElementById("search").click())},helperText:A.locationError}),o.a.createElement(dt.a,{in:!!R,timeout:"auto",unmountOnExit:!0},o.a.createElement(ct.a,{component:"div",disablePadding:!0},R.map(function(e){return o.a.createElement(lt.a,{key:e.placeName,button:!0,className:i.nested,onClick:function(t){return function(e){he("address",e.placeName),z([]),I({mapState:e.mapState,locationError:""}),D(!0)}(e)}},o.a.createElement(mt.a,{primary:e.placeName}))}))),a&&"address"===m&&o.a.createElement(Te,null),o.a.createElement(je.a,{container:!0,style:{marginTop:1}},o.a.createElement(yt,{className:i.map,mapStyle:Ie,mapState:A.mapState})))))),t&&o.a.createElement(je.a,{item:!0,xs:6},o.a.createElement(K.a,{name:"create",label:"Create",type:"submit",fullWidth:!0,variant:"contained",color:"primary",disabled:ue},"Create"),!We&&o.a.createElement(we.a,{error:!We},"Unknown Error Occurred"))),o.a.createElement(pt.a,{onClickAway:Ae},o.a.createElement(ot.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:N,autoHideDuration:2e3,onClose:Ae,ContentProps:{"aria-describedby":"message-id"},message:o.a.createElement("span",{id:"message-id"},"Edit successful"),action:[o.a.createElement(K.a,{key:"view",color:"secondary",size:"small",onClick:function(t){Y(e.artefact.id)&&Ae()}},"VIEW"),o.a.createElement(Q.a,{key:"close","aria-label":"close",color:"inherit",onClick:Ae,className:i.close},o.a.createElement(Xe.a,null))]}))))});function Nt(e){var t=Object(r.useState)({}),a=Object(b.a)(t,2),n=a[0],c=a[1],i=function(){var e=Object(g.a)(f.a.mark(function e(t){var a,n,r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in a={},t.__type.enumValues)r=t.__type.enumValues[o],n=r.description,a[n]=r.name;c(a);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),l=Object(y.b)(Ae,{variables:{name:"ArtefactState"},onCompleted:i,onError:function(e){return console.log(e)}}).loading,s=Object(r.useState)([]),u=Object(b.a)(s,2),m=u[0],d=u[1],p=Object(y.b)(Ie,{onCompleted:function(e){return d(e.me.isMemberOf)},onError:function(e){return console.log(e)}}).loading;return o.a.createElement(be,null,o.a.createElement(St,{mode:"create",families:m,familyLoading:p,artefactStates:n,statesLoading:l}))}function Pt(){var e=Object(h.a)(["\n    query DetailView($id: ID!) {\n        artefact(id: $id) {\n            id\n            name\n            description\n            addedAt\n        }\n    }\n"]);return Pt=function(){return e},e}var Tt=v()(Pt());function Ft(e){var t=Object(y.b)(Tt,{variables:{id:e.match.params.id}}),a=t.data,n=t.loading,r=t.errors;return n?o.a.createElement("p",null,"Loading..."):r?o.a.createElement("p",null,"ERROR!"):o.a.createElement("div",null,o.a.createElement("h1",null,a.artefact.name," - #",a.artefact.id),o.a.createElement("p",null,a.artefact.addedAt),o.a.createElement("p",null,a.artefact.description))}var At=a(257),It=a(258),Wt=a(261),$t=a(260),Bt=a(259),Dt=Object(q.a)(function(e){return{textField:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center",marginTop:e.spacing(1)},paper:{marginTop:e.spacing(1),padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center"},button:{margin:e.spacing(1)},card:{backgroundColor:e.palette.background.paper,maxWidth:345},media:{backgroundColor:e.palette.background.paper,height:140}}});var Lt=function(e){e.mediaURI;var t=e.title,a=e.description,n=e.id,r=Dt();return o.a.createElement(At.a,{className:r.card},o.a.createElement(It.a,null,o.a.createElement(Bt.a,{className:r.media,image:"https://img1.cgtrader.com/items/995815/731bda0123/antique-old-clock-3d-model-low-poly-animated-obj-3ds-fbx-blend-dae-mtl.jpg",title:t}),o.a.createElement($t.a,null,o.a.createElement(je.a,{item:!0,xs:!0,zeroMinWidth:!0},o.a.createElement(V.a,{gutterBottom:!0,variant:"h5",component:"h2",noWrap:!0},t)),o.a.createElement(je.a,{item:!0,xs:!0,zeroMinWidth:!0},o.a.createElement(V.a,{variant:"body2",color:"textSecondary",component:"p",noWrap:!0},a)))),o.a.createElement(Wt.a,null,o.a.createElement(K.a,{size:"small",color:"primary",component:F.b,to:"/artefacts/".concat(n)},"View"),o.a.createElement(K.a,{size:"small",color:"primary",component:F.b,to:"/artefacts/edit/".concat(n)},"Edit")))};function qt(){var e=Object(h.a)(["\n    query artefactsQuery($first: Int!) {\n        me {\n            artefactAdministratorOf(first: $first) {\n                edges {\n                    node {\n                        id\n                        name\n                        description\n                        upload\n                    }\n                }\n            }\n        }\n    }\n"]);return qt=function(){return e},e}var Rt=Object(q.a)(function(e){return{textField:{padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center",marginTop:e.spacing(1)},paper:{marginTop:e.spacing(1),padding:e.spacing(1),backgroundColor:e.palette.background.paper,textAlign:"center"},button:{margin:e.spacing(1)}}}),Ut=v()(qt());var zt=function(e){Rt();var t=Object(r.useState)([]),a=Object(b.a)(t,2),n=a[0],c=a[1],i=Object(y.b)(Ut,{variables:{first:10},onCompleted:function(e){return c(e.me.artefactAdministratorOf.edges)}}),l=i.data,s=i.loading;return console.log("The data is: ",l),s?o.a.createElement("p",null,"Loading..."):o.a.createElement(be,null,o.a.createElement(ye.a,null),o.a.createElement(je.a,{container:!0,spacing:2},o.a.createElement(je.a,{item:!0,xs:12},o.a.createElement(je.a,{container:!0,justify:"center",spacing:2},n.map(function(e){return o.a.createElement(je.a,{item:!0,key:e.node.id},o.a.createElement(Lt,{mediaURI:"https://assets.pernod-ricard.com/nz/media_images/test.jpg?hUV74FvXQrWUBk1P2.fBvzoBUmjZ1wct",title:e.node.name,description:e.node.description,id:e.node.id}))})))))};function _t(e){var t=Object(r.useState)({}),a=Object(b.a)(t,2),n=a[0],c=a[1],i=function(){var e=Object(g.a)(f.a.mark(function e(t){var a,n,r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in a={},t.__type.enumValues)r=t.__type.enumValues[o],n=r.description,a[n]=r.name;c(a);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),l=Object(y.b)(Ae,{variables:{name:"ArtefactState"},onCompleted:i,onError:function(e){return console.log(e)}}).loading,s=Object(r.useState)([]),u=Object(b.a)(s,2),m=u[0],d=u[1],p=Object(y.b)(Ie,{onCompleted:function(e){return d(e.me.isMemberOf)},onError:function(e){return console.log(e)}}).loading,h=Object(r.useState)({}),E=Object(b.a)(h,2),v=E[0],O=E[1],j=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(g.a)(f.a.mark(function e(t){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:O(t.artefact),console.log("Artefact:",t.artefact);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),w=Object(y.b)(We,{variables:{id:e.match.params.id},onCompleted:k,onError:j}).loading;return o.a.createElement(be,null,w||0===Object.keys(v)?o.a.createElement(U,null):o.a.createElement(St,{artefact:v,mode:"edit",families:m,familyLoading:p,artefactStates:n,statesLoading:l}))}function Mt(e){return o.a.createElement("div",{style:{padding:"50px"}},o.a.createElement("h1",{style:{color:"red"}},"404 Page Not Found"),o.a.createElement("h3",null,"If you're seeing this page..."),o.a.createElement("img",{src:"https://media0.giphy.com/media/KVZXay4Uduy8XHpZRc/giphy.gif",alt:""}),o.a.createElement("p",null,o.a.createElement("a",{href:"/"},"Return home")))}var Qt=a(262),Vt=a(263),Jt=a(269),Gt=a(265);function Zt(){var e=Object(h.a)(["\nmutation SelectFamilyMutation($profileId: Int!, $toFamily: String!) {\n    updateProfile(input: {\n        id: $profileId,\n        selectedFamily: $toFamily\n    }) {\n        id\n        selectedFamily\n    }\n}"]);return Zt=function(){return e},e}function Ht(){var e=Object(h.a)(["\nmutation JoinFamily($joinCode: String!) {\n  familyJoin(joinCode: $joinCode) {\n    family {\n      familyName\n      familyAdmin {\n          username\n      }\n    }\n  }\n}"]);return Ht=function(){return e},e}function Xt(){var e=Object(h.a)(["\n        query {\n            me {\n            isMemberOf {\n            id\n            familyName\n            joinCode\n            hasArtefacts {\n                edges {\n                node {\n                    id\n                    name\n                    admin {\n                    username\n                    }\n                }\n                }\n            }\n            }\n            profile {\n                id\n                selectedFamily {\n                    id\n                    familyName\n                    joinCode\n                        hasArtefacts {\n                            edges {\n                                node {\n                                    id\n                                    name\n                                    description\n                                    upload\n                                }\n                            }\n                        }\n                    }\n                }\n        }\n    }"]);return Xt=function(){return e},e}var Yt=Object(q.a)(function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper},gridList:{width:"80%",backgroundColor:e.palette.background.paper},icon:{color:"rgba(255, 255, 255, 0.54)"}}}),Kt=v()(Xt()),ea=v()(Ht()),ta=v()(Zt());var aa=function(e){var t=Yt(),a=Object(r.useContext)(j).user.username,n=Object(r.useState)(""),c=Object(b.a)(n,2),i=c[0],l=c[1],s=Object(y.a)(ea,{refetchQueries:function(e){return[{query:Kt}]}}),u=Object(b.a)(s,2),m=u[0],d=(u[1].data,Object(y.b)(Kt,{onCompleted:function(e){!function(e){e.me.profile.selectedFamily||console.error("User has not selected a family")}(e)}})),p=d.data,f=d.loading,g=(d.called,Object(y.a)(ta,{refetchQueries:function(e){return[{query:Kt}]}})),h=Object(b.a)(g,2),E=h[0],v=(h[1].data,o.a.useRef(null));if(f)return o.a.createElement("p",null,"Loading...");var O=p.me.profile.selectedFamily,k=p.me.isMemberOf,w=p.me.profile.id,x=p.me.profile.selectedFamily.hasArtefacts.edges;return o.a.createElement(be,null,o.a.createElement(ye.a,null),o.a.createElement(je.a,{container:!0,spacing:3},o.a.createElement(je.a,{item:!0,xs:9},O&&o.a.createElement("div",null,o.a.createElement(V.a,{variant:"h1"},O.familyName),o.a.createElement(V.a,{variant:"h5"},"Join code: ",O.joinCode)),!O&&o.a.createElement(V.a,{variant:"h2"},"Join and/or Select a Family"),o.a.createElement("h4",null,"Your username is (temp, for testing): ",a),o.a.createElement(Qt.a,{cellHeight:"auto",className:t.gridList,cols:2},x.map(function(e,t){return o.a.createElement(Vt.a,{key:t},o.a.createElement(Lt,{key:t,mediaURI:e.node.upload,title:e.node.name,description:e.node.description,id:e.node.id}))}))),o.a.createElement(je.a,{item:!0,xs:3},o.a.createElement(Jt.a,{ref:v,htmlFor:"outlined-age-simple"},"Select Family"),o.a.createElement(Gt.a,{variant:"outlined",fullWidth:!0,value:O?O.id:null,onChange:function(e){e.preventDefault();var t=e.target.value;E({variables:{profileId:w,toFamily:t}})},inputProps:{name:"age",id:"outlined-age-simple",styles:{padding:"4px"}},padding:"5px"},k&&k.map(function(e,t){return o.a.createElement(te.a,{key:e.id,value:e.id},e.familyName)})),o.a.createElement(rt.a,{fullWidth:!0},o.a.createElement(ke.a,{id:"joinCodeField",label:"Join a family",value:i,className:t.textField,margin:"normal",onChange:function(e){return l(e.target.value)},fullWidth:!0}),o.a.createElement(K.a,{variant:"outlined",onClick:function(){0!==i.length?m({variables:{joinCode:i}}):console.error("Enter a valid joinCode")}},"Join Family")))))};var na=function(e){return o.a.createElement(F.a,null,o.a.createElement(ye.a,null),o.a.createElement("div",null,o.a.createElement(A.d,null,o.a.createElement(ve,{exact:!0,path:"/",loggedIn:aa,landingPage:!0}),o.a.createElement(A.b,{exact:!0,path:"/login/",render:function(e){return o.a.createElement(be,null,o.a.createElement(Le,e))}}),o.a.createElement(A.b,{exact:!0,path:"/signup/",render:function(e){return o.a.createElement(be,null,o.a.createElement(Me,e))}}),o.a.createElement(A.b,{exact:!0,path:"/logout/",component:Qe}),o.a.createElement(ve,{exact:!0,path:"/artefacts/create/",loggedIn:Nt,landingPage:!0}),o.a.createElement(ve,{exact:!0,path:"/artefacts/manage/",loggedIn:zt,landingPage:!0}),o.a.createElement(ve,{exact:!0,path:"/artefacts/:id/",loggedIn:Ft,landingPage:!0}),o.a.createElement(ve,{exact:!0,path:"/artefacts/edit/:id/",loggedIn:_t,landingPage:!0}),o.a.createElement(ve,{exact:!0,path:"/family/create",loggedIn:nt,landingPage:!0}),o.a.createElement(A.b,{component:Mt}))))};function ra(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function oa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ra(a,!0).forEach(function(t){Object(n.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ra(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var ca=Object(s.a)({uri:N.uri}),ia=Object(u.a)(function(e,t){var a=t.headers,n=localStorage.getItem(w);return{headers:oa({},a,{authorization:n?"JWT ".concat(n):""})}}),la=new l.a({link:ia.concat(ca),cache:new m.a});i.a.render(o.a.createElement(d.a,{client:la},o.a.createElement(function(e){var t=this,a=Object(r.useState)(!1),n=Object(b.a)(a,2),c=n[0],i=n[1],l=Object(r.useState)({}),s=Object(b.a)(l,2),u=s[0],m=s[1],d=Object(r.useState)(""),p=Object(b.a)(d,2),h=p[0],E=p[1],v=Object(y.a)(T),O=Object(b.a)(v,2),j=O[0],x=O[1],C=x.error,S=x.loading,N=function(){var e=Object(g.a)(f.a.mark(function e(t,a){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(t=localStorage.getItem(w)),e.next=3,j({variables:{token:t}}).then(function(e){P(e),a&&a()}).catch(function(e){localStorage[w]="",a&&a()});case 3:if(!C){e.next=6;break}return console.log("[Error] handleAuthentication()"),e.abrupt("return");case 6:S&&console.log("Thing is loading");case 7:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),P=function(e){if(C)console.log("Invalid data, please sign in again");else{var t=e.data.verifyToken.payload.username;console.log("Here's the user id: ",e.data.verifyToken.payload.id);var a={username:t};i(!0),E(e.verifyToken),m(a)}},F={authenticated:c,authToken:h,user:u,initiateLogin:function(){t.history.pushState(null,"login")},handleAuthentication:N,logout:function(){console.log("Logout called"),i(!1),m({}),E(""),localStorage[w]=""}};return o.a.createElement(k,{value:F},e.children)},null,o.a.createElement(na,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[142,1,2]]]);
//# sourceMappingURL=main.365cbac9.chunk.js.map